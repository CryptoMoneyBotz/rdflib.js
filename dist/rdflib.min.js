"undefined"!=typeof window&&(window.solid||(window.solid={}),window.solid.auth||(window.solid.auth={fetch:(e,t)=>window.fetch(e,t)})),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("window"),require("null"),require("solid-auth-client")):"function"==typeof define&&define.amd?define(["window","null"],t):"object"==typeof exports?exports.$rdf=t(require("window"),require("null"),require("solid-auth-client")):e.$rdf=t(e.window,e.null,e.solid.auth)}(window,function(e,t,r){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=66)}([function(e,t,r){"use strict";t.a={debug:function(e){},warn:function(e){},info:function(e){},error:function(e){},success:function(e){},msg:function(e){}}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,r){"use strict";r.r(t),r.d(t,"docpart",function(){return o}),r.d(t,"document",function(){return a}),r.d(t,"hostpart",function(){return s}),r.d(t,"join",function(){return u}),r.d(t,"protocol",function(){return c}),r.d(t,"refTo",function(){return l});var n=r(5),i=i||console.log;function o(e){var t;return(t=e.indexOf("#"))<0?e:e.slice(0,t)}function a(e){return new n.a(o(e.uri))}function s(e){var t=/[^\/]*\/\/([^\/]*)\//.exec(e);return t?t[1]:""}function u(e,t){var r,n,o,a,s,u=t.indexOf("#");if(u>0&&(t=t.slice(0,u)),0===e.length)return t;if(0===e.indexOf("#"))return t+e;if(e.indexOf(":")>=0)return e;if(r=t.indexOf(":"),0===t.length)return e;if(r<0)return i("Invalid base: "+t+" in join with given: "+e),e;if(n=t.slice(0,+r+1||9e9),0===e.indexOf("//"))return n+e;if(t.indexOf("//",r)===r+1){if((o=t.indexOf("/",r+3))<0)return t.length-r-3>0?t+"/"+e:n+e}else if((o=t.indexOf("/",r+1))<0)return t.length-r-1>0?t+"/"+e:n+e;if(0===e.indexOf("/"))return t.slice(0,o)+e;if((a=(s=t.slice(o)).lastIndexOf("/"))<0)return n+e;for(a>=0&&a<s.length-1&&(s=s.slice(0,+a+1||9e9)),s+=e;s.match(/[^\/]*\/\.\.\//);)s=s.replace(/[^\/]*\/\.\.\//,"");return s=(s=s.replace(/\.\//g,"")).replace(/\/\.$/,"/"),t.slice(0,o)+s}function c(e){var t;return(t=e.indexOf(":"))<0?null:e.slice(0,t)}function l(e,t){var r,n,i,o,a,s,u,c,l,h,f,d,p=new RegExp("^[-_a-zA-Z0-9.]+:(//[^/]*)?/[^/]*$");if(!e)return t;if(e===t)return"";for(r=u=0,o=t.length;u<o&&t[r]===e[r];r=++u);if(e.slice(0,r).match(p)&&((n=t.indexOf("//"))<0&&(n=-2),i=t.indexOf("/",n+2),"/"!==t[i+1]&&"/"!==e[i+1]&&t.slice(0,i)===e.slice(0,i)))return t.slice(i);if("#"===t[r]&&e.length===r)return t.slice(r);for(;r>0&&"/"!==t[r-1];)r--;if(r<3)return t;if(e.indexOf("//",r-2)>0||t.indexOf("//",r-2)>0)return t;if(e.indexOf(":",r)>0)return t;for(s=0,c=0,a=(h=e.slice(r)).length;c<a;c++)"/"===h[c]&&s++;if(0===s&&r<t.length&&"#"===t[r])return"./"+t.slice(r);if(0===s&&r===t.length)return"./";if(d="",s>0)for(l=1,f=s;f>=1?l<=f:l>=f;f>=1?++l:--l)d+="../";return d+t.slice(r)}},function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"string",function(){return s}),r.d(t,"mediaTypeClass",function(){return u}),r.d(t,"linkRelationProperty",function(){return c}),r.d(t,"AJAR_handleNewTerm",function(){return l}),r.d(t,"ArrayIndexOf",function(){return h}),r.d(t,"callbackify",function(){return f}),r.d(t,"DOMParserFactory",function(){return d}),r.d(t,"domToString",function(){return p}),r.d(t,"dumpNode",function(){return g}),r.d(t,"dtstamp",function(){return y}),r.d(t,"heavyCompare",function(){return v}),r.d(t,"heavyCompareSPO",function(){return m}),r.d(t,"output",function(){return b}),r.d(t,"parseXML",function(){return w}),r.d(t,"RDFArrayRemove",function(){return x}),r.d(t,"string_startswith",function(){return _}),r.d(t,"stackString",function(){return T});var n=r(2),i=r(0);r.d(t,"log",function(){return i.a}),r.d(t,"uri",function(){return n});var o=r(5),a=r(29),s={template:function(e,t){for(var r=e.split("%s"),n="",i=0;i<t.length;i++)t[i]+="",n+=r[i]+t[i];return n+r.slice(t.length).join()}};function u(e){return e=e.split(";")[0].trim(),new o.a("http://www.w3.org/ns/iana/media-types/"+e+"#Resource")}function c(e){return new o.a("http://www.w3.org/ns/iana/link-relations/relation#"+e.trim())}function l(e,t,r){var o=null;if(void 0!==e.fetcher&&(o=e.fetcher,"NamedNode"===t.termType)){var a,s=Object(n.docpart)(t.uri);if(t.uri.indexOf("#")<0){if(_(t.uri,"http://dbpedia.org/resource/Category:"))return;_(t.uri,"http://purl.org/dc/elements/1.1/")||_(t.uri,"http://purl.org/dc/terms/")?a="http://dublincore.org/2005/06/13/dcq":_(t.uri,"http://xmlns.com/wot/0.1/")?a="http://xmlns.com/wot/0.1/index.rdf":_(t.uri,"http://web.resource.org/cc/")&&(a="http://web.resource.org/cc/schema.rdf")}if(a&&(s=a),!o||"unrequested"===o.getState(s))return a&&i.a.warn("Assuming server still broken, faking redirect of <"+t.uri+"> to <"+s+">"),o.fetch(s,{referringTerm:r})}}function h(e,t,r){r||(r=0);var n=e.length;for(r<0&&(r=n+r);r<n;r++)if(e[r]===t)return r;return-1}function f(e,t){e.callbacks={};for(var r=t.length-1;r>=0;r--)e.callbacks[t[r]]=[];e.addHook=function(t){e.callbacks[t]||(e.callbacks[t]=[])},e.addCallback=function(t,r){e.callbacks[t].push(r)},e.removeCallback=function(t,r){for(var n=0;n<e.callbacks[t].length;n++)if(e.callbacks[t][n].name===r)return e.callbacks[t].splice(n,1),!0;return!1},e.insertCallback=function(t,r){e.callbacks[t].unshift(r)},e.fireCallbacks=function(t,r){var n,i,o=[],a=[],s=e.callbacks[t].length;for(n=s-1;n>=0;n--)(i=e.callbacks[t][n])&&i.apply(e,r)&&o.push(i);for(n=o.length-1;n>=0;n--)a.push(o[n]);for(n=s;n<e.callbacks[t].length;n++)a.push(e.callbacks[t][n]);e.callbacks[t]=a}}function d(){return window.DOMParser?new a.DOMParser:!!window.ActiveXObject&&new ActiveXObject("Microsoft.XMLDOM")}function p(e,t){var r=[];"selfClosing"in(t=t||{})&&t.selfClosing.split(" ").forEach(function(e){r[e]=!0});var n=[];return"skipAttributes"in t&&t.skipAttributes.split(" ").forEach(function(e){n[e]=!0}),g(e,t,r,n)}function g(e,t,r,n){var i,o="",a=[!1];if(void 0===e.nodeType)return o;if(1===e.nodeType){if(e.hasAttribute("class")&&"classWithChildText"in t&&e.matches(t.classWithChildText.class))o+=e.querySelector(t.classWithChildText.element).textContent;else if(!("skipNodeWithClass"in t&&e.matches("."+t.skipNodeWithClass))){var s=e.nodeName.toLowerCase();o+="<"+s;var u=[];for(i=e.attributes.length-1;i>=0;i--){var c=e.attributes[i];if(!(n.length>0&&n[c.name])&&!/^\d+$/.test(c.name)){if("class"===c.name&&"replaceClassItemWith"in t&&c.value.split(" ").indexOf(t.replaceClassItemWith.source)>-1){var l=new RegExp(t.replaceClassItemWith.source,"g");c.value=c.value.replace(l,t.replaceClassItemWith.target).trim()}"class"===c.name&&"skipClassWithValue"in t&&t.skipClassWithValue===c.value||u.push(c.name+"='"+c.value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&quot;")+"'")}}if(u.length>0&&("sortAttributes"in t&&t.sortAttributes&&u.sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}),o+=" "+u.join(" ")),r[s])o+=" />";else{for(o+=">",o+="html"===s?"\n  ":"",a.push("style"===s||"script"===s),i=0;i<e.childNodes.length;i++)o+=g(e.childNodes[i]);a.pop(),o+="body"===s?"</"+s+">\n":"</"+s+">"}}}else if(8===e.nodeType)o+="\x3c!--"+e.nodeValue+"--\x3e";else if(3===e.nodeType||4===e.nodeType){var h=e.nodeValue.replace(/\n+$/,"");o+=a[a.length-1]?h:h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}else console.log("Warning; Cannot handle serialising nodes of type: "+e.nodeType),console.log(e);return o}function y(){var e=new Date,t=e.getYear()+1900,r=e.getMonth()+1,n=e.getDate(),i=e.getUTCHours(),o=e.getUTCMinutes(),a=e.getSeconds();return r<10&&(r="0"+r),n<10&&(n="0"+n),i<10&&(i="0"+i),o<10&&(o="0"+o),a<10&&(a="0"+a),t+"-"+r+"-"+n+"T"+i+":"+o+":"+a+"Z"}function v(e,t,r,n){var i=function(e){return"BlankNode"===e.termType?null:e},o=function(e){var t=r.statementsMatching(e).map(function(e){return i(e.subject)+" "+i(e.predicate)+" "+i(e.object)}).concat(r.statementsMatching(void 0,void 0,e).map(function(e){return i(e.subject)+" "+i(e.predicate)+" "+i(e.object)}));return t.sort(),t.join("\n")};return"BlankNode"===e.termType&&"BlankNode"===t.termType?0===e.compareTerm(t)?0:o(e)>o(t)?1:o(e)<o(t)?-1:e.compareTerm(t):n&&e.uri&&t.uri?(n[e.uri]||e.uri).localeCompare(n[t.uri]||t.uri):e.compareTerm(t)}function m(e,t,r,n){return v(e.subject,t.subject,r,n)||v(e.predicate,t.predicate,r,n)||v(e.object,t.object,r,n)}function b(e){var t=document.createElement("div");t.textContent=e,document.body.appendChild(t)}function w(t,r){return r=r||{},e&&e.exports?(new a.DOMParser).parseFromString(t,r.contentType||"application/xhtml+xml"):("undefined"!=typeof window&&window.DOMParser?new window.DOMParser:new a.DOMParser).parseFromString(t,"application/xml")}function x(e,t){for(var r=0;r<e.length;r++)if(e[r].subject.sameTerm(t.subject)&&e[r].predicate.sameTerm(t.predicate)&&e[r].object.sameTerm(t.object)&&e[r].why.sameTerm(t.why))return void e.splice(r,1);throw new Error("RDFArrayRemove: Array did not contain "+t+" "+t.why)}function _(e,t){return e.slice(0,t.length)===t}function T(e){var t=e+"\n";if(!e.stack)return t+"No stack available.\n";for(var r=e.stack.toString().split("\n"),n=[],i=0;i<r.length;i++){var o=r[i];if(o.indexOf("ecmaunit.js")>-1)break;"("==o.charAt(0)&&(o="function"+o);var a=o.split("@");n.push(a)}for(i=0;i<n.length;i++)t+="  "+n[i][1]+"\n    "+n[i][0];return t}}.call(this,r(69)(e))},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t,r){"use strict";r.d(t,"a",function(){return p});var n=r(1),i=r.n(n),o=r(4),a=r.n(o),s=r(6),u=r.n(s),c=r(7),l=r.n(c),h=r(8),f=r.n(h),d=r(12),p=function(e){function t(e){var r;if(i()(this,t),(r=u()(this,l()(t).call(this))).termType=t.termType,e&&e.termType===t.termType&&(e=e.value),!e)throw new Error("Missing IRI for NamedNode");if(!e.includes(":"))throw new Error('NamedNode IRI "'+e+'" must be absolute.');if(e.includes(" "))throw new Error('Error: NamedNode IRI "'+e+'" must not contain unencoded spaces.');return r.value=e,r}return f()(t,e),a()(t,[{key:"dir",value:function(){var e=this.uri.split("#")[0],r=e.slice(0,-1).lastIndexOf("/"),n=e.indexOf("//");return n>=0&&r<n+2||r<0?null:new t(e.slice(0,r+1))}},{key:"site",value:function(){var e=this.uri.split("#")[0],r=e.indexOf("//");if(r<0)throw new Error("This URI does not have a web site part (origin)");var n=e.indexOf("/",r+2);return new t(n<0?e.slice(0)+"/":e.slice(0,n+1))}},{key:"doc",value:function(){return this.uri.indexOf("#")<0?this:new t(this.uri.split("#")[0])}},{key:"toString",value:function(){return"<"+this.uri+">"}},{key:"id",value:function(){return this.uri.split("#")[1]}},{key:"uri",get:function(){return this.value},set:function(e){this.value=e}}],[{key:"fromValue",value:function(e){return null==e?e:e&&e.termType?e:new t(e)}}]),t}(r(9).a);p.termType="NamedNode",p.prototype.classOrder=d.a.NamedNode,p.prototype.isVar=0},function(e,t,r){var n=r(14),i=r(67);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?i(e):t}},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}e.exports=r},function(e,t,r){var n=r(68);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t,r){"use strict";r.d(t,"a",function(){return s});var n=r(1),i=r.n(n),o=r(4),a=r.n(o),s=function(){function e(){i()(this,e)}return a()(e,[{key:"substitute",value:function(e){return console.log("@@@ node substitute"+this),this}},{key:"compareTerm",value:function(e){return this.classOrder<e.classOrder?-1:this.classOrder>e.classOrder?1:this.value<e.value?-1:this.value>e.value?1:0}},{key:"equals",value:function(e){return!!e&&(this.termType===e.termType&&this.value===e.value)}},{key:"hashString",value:function(){return this.toCanonical()}},{key:"sameTerm",value:function(e){return this.equals(e)}},{key:"toCanonical",value:function(){return this.toNT()}},{key:"toNT",value:function(){return this.toString()}},{key:"toString",value:function(){throw new Error("Node.toString() is abstract - see the subclasses instead")}}]),e}()},function(e,t,r){"use strict";(function(t,n){const i=r(16),o=r(13),a=r(33).IdentifierIssuer,s=r(17),u=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,c=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,l=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,h={accept:"application/ld+json, application/json"},f={};e.exports=f,f.IdentifierIssuer=a;const d="function"==typeof t&&t,p=d?e=>d(e):e=>setTimeout(e,0);function g(e,t,r){f.nextTick(()=>e(t,r))}"object"==typeof n&&"function"==typeof n.nextTick?f.nextTick=n.nextTick:f.nextTick=p,f.setImmediate=d?p:f.nextTick,f.clone=function(e){if(e&&"object"==typeof e){let t;if(o.isArray(e)){t=[];for(let r=0;r<e.length;++r)t[r]=f.clone(e[r])}else if(e instanceof Map){t=new Map;for(const[r,n]of e)t.set(r,f.clone(n))}else if(e instanceof Set){t=new Set;for(const r of e)t.add(f.clone(r))}else if(o.isObject(e)){t={};for(const r in e)t[r]=f.clone(e[r])}else t=e.toString();return t}return e},f.asArray=function(e){return Array.isArray(e)?e:[e]},f.buildHeaders=(e={})=>{if(Object.keys(e).some(e=>"accept"===e.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+h.accept+'" is supported.');return Object.assign({Accept:h.accept},e)},f.parseLinkHeader=e=>{const t={},r=e.match(u);for(let e=0;e<r.length;++e){let n=r[e].match(c);if(!n)continue;const i={target:n[1]},o=n[2];for(;n=l.exec(o);)i[n[1]]=void 0===n[2]?n[3]:n[2];const a=i.rel||"";Array.isArray(t[a])?t[a].push(i):t.hasOwnProperty(a)?t[a]=[t[a],i]:t[a]=i}return t},f.validateTypeValue=e=>{if(o.isString(e)||o.isEmptyObject(e))return;let t=!1;if(o.isArray(e)){t=!0;for(let r=0;r<e.length;++r)if(!o.isString(e[r])){t=!1;break}}if(!t)throw new s('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})},f.hasProperty=(e,t)=>{if(e.hasOwnProperty(t)){const r=e[t];return!o.isArray(r)||r.length>0}return!1},f.hasValue=(e,t,r)=>{if(f.hasProperty(e,t)){let n=e[t];const a=i.isList(n);if(o.isArray(n)||a){a&&(n=n["@list"]);for(let e=0;e<n.length;++e)if(f.compareValues(r,n[e]))return!0}else if(!o.isArray(r))return f.compareValues(r,n)}return!1},f.addValue=(e,t,r,n)=>{if("propertyIsArray"in(n=n||{})||(n.propertyIsArray=!1),"allowDuplicate"in n||(n.allowDuplicate=!0),o.isArray(r)){0===r.length&&n.propertyIsArray&&!e.hasOwnProperty(t)&&(e[t]=[]);for(let i=0;i<r.length;++i)f.addValue(e,t,r[i],n)}else if(e.hasOwnProperty(t)){const i=!n.allowDuplicate&&f.hasValue(e,t,r);o.isArray(e[t])||i&&!n.propertyIsArray||(e[t]=[e[t]]),i||e[t].push(r)}else e[t]=n.propertyIsArray?[r]:r},f.getValues=(e,t)=>[].concat(e[t]||[]),f.removeProperty=(e,t)=>{delete e[t]},f.removeValue=(e,t,r,n)=>{"propertyIsArray"in(n=n||{})||(n.propertyIsArray=!1);const i=f.getValues(e,t).filter(e=>!f.compareValues(e,r));0===i.length?f.removeProperty(e,t):1!==i.length||n.propertyIsArray?e[t]=i:e[t]=i[0]},f.relabelBlankNodes=(e,t)=>{return function e(t,r){if(o.isArray(r))for(let n=0;n<r.length;++n)r[n]=e(t,r[n]);else if(i.isList(r))r["@list"]=e(t,r["@list"]);else if(o.isObject(r)){i.isBlankNode(r)&&(r["@id"]=t.getId(r["@id"]));const n=Object.keys(r).sort();for(let i=0;i<n.length;++i){const o=n[i];"@id"!==o&&(r[o]=e(t,r[o]))}}return r}((t=t||{}).issuer||new a("_:b"),e)},f.compareValues=(e,t)=>e===t||(!(!i.isValue(e)||!i.isValue(t)||e["@value"]!==t["@value"]||e["@type"]!==t["@type"]||e["@language"]!==t["@language"]||e["@index"]!==t["@index"])||!!(o.isObject(e)&&"@id"in e&&o.isObject(t)&&"@id"in t)&&e["@id"]===t["@id"]),f.compareShortestLeast=(e,t)=>e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1,f.normalizeDocumentLoader=e=>e.length<2?f.callbackify(e):async function(t){const r=arguments[1];return new Promise((n,i)=>{try{e(t,(e,t)=>{if("function"==typeof r)return g(r,e,t);e?i(e):n(t)})}catch(e){if("function"==typeof r)return g(r,e);i(e)}})},f.callbackify=e=>(async function(...t){const r=t[t.length-1];let n;"function"==typeof r&&t.pop();try{n=await e.apply(null,t)}catch(e){if("function"==typeof r)return g(r,e);throw e}return"function"==typeof r?g(r,null,n):n})}).call(this,r(23).setImmediate,r(15))},function(e,t,r){var n;n=function(){};t=e.exports={Lexer:n("./lib/N3Lexer"),Parser:n("./lib/N3Parser"),Writer:n("./lib/N3Writer"),Store:n("./lib/N3Store"),StreamParser:n("./lib/N3StreamParser"),StreamWriter:n("./lib/N3StreamWriter"),Util:n("./lib/N3Util")};Object.keys(t).forEach(function(e){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:function(){return delete t[e],t[e]=r(94)("./N3"+e)}})})},function(e,t,r){"use strict";t.a={Literal:1,Collection:3,Graph:4,NamedNode:5,BlankNode:6,Variable:7}},function(e,t,r){"use strict";const n={};e.exports=n,n.isArray=Array.isArray,n.isBoolean=e=>"boolean"==typeof e||"[object Boolean]"===Object.prototype.toString.call(e),n.isDouble=e=>n.isNumber(e)&&-1!==String(e).indexOf("."),n.isEmptyObject=e=>n.isObject(e)&&0===Object.keys(e).length,n.isNumber=e=>"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e),n.isNumeric=e=>!isNaN(parseFloat(e))&&isFinite(e),n.isObject=e=>"[object Object]"===Object.prototype.toString.call(e),n.isString=e=>"string"==typeof e||"[object String]"===Object.prototype.toString.call(e),n.isUndefined=e=>void 0===e},function(e,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(t){return"function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?e.exports=n=function(e){return r(e)}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)},n(t)}e.exports=n},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var u,c=[],l=!1,h=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&d())}function d(){if(!l){var e=s(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++h<t;)u&&u[h].run();h=-1,t=c.length}u=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new p(e,t)),1!==c.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";const n=r(13),i={};e.exports=i,i.isSubject=e=>{if(n.isObject(e)&&!("@value"in e||"@set"in e||"@list"in e)){return Object.keys(e).length>1||!("@id"in e)}return!1},i.isSubjectReference=e=>n.isObject(e)&&1===Object.keys(e).length&&"@id"in e,i.isValue=e=>n.isObject(e)&&"@value"in e,i.isList=e=>n.isObject(e)&&"@list"in e,i.isGraph=e=>n.isObject(e)&&"@graph"in e&&1===Object.keys(e).filter(e=>"@id"!==e&&"@index"!==e).length,i.isSimpleGraph=e=>i.isGraph(e)&&!("@id"in e),i.isBlankNode=e=>!!n.isObject(e)&&("@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e))},function(e,t,r){"use strict";e.exports=class extends Error{constructor(e="An unspecified JSON-LD error occurred.",t="jsonld.Error",r={}){super(e),this.name=t,this.message=e,this.details=r}}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";(function(t,r){const n={};e.exports=n;const i="function"==typeof t&&t,o=i?e=>i(e):e=>setTimeout(e,0);function a(e,t,n){try{return e(t,n)}catch(e){r.nextTick(()=>{throw e})}}"object"==typeof r&&"function"==typeof r.nextTick?n.nextTick=r.nextTick:n.nextTick=o,n.setImmediate=i?o:n.nextTick,n.clone=function(e){if(e&&"object"==typeof e){let t;if(Array.isArray(e)){t=[];for(let r=0;r<e.length;++r)t[r]=n.clone(e[r])}else if(n.isObject(e)){t={};for(const r in e)t[r]=n.clone(e[r])}else t=e.toString();return t}return e},n.isObject=e=>"[object Object]"===Object.prototype.toString.call(e),n.isUndefined=e=>void 0===e,n.callbackify=e=>(async function(...t){const r=t[t.length-1];let n;"function"==typeof r&&t.pop();try{n=await e.apply(null,t)}catch(e){if("function"==typeof r)return a(r,e);throw e}return"function"==typeof r?a(r,null,n):n})}).call(this,r(23).setImmediate,r(15))},function(e,t,r){"use strict";const n=r(10),i=r(83),o=r(17),{isArray:a,isObject:s,isString:u,isUndefined:c}=r(13),{isAbsolute:l,isRelative:h,prependBase:f,parse:d}=r(27),{asArray:p,compareShortestLeast:g}=r(10),y=10,v=new Map,m={};function b(e,t,r,n,i,o){if(null===t||!u(t)||m.isKeyword(t))return t;if(n&&n.hasOwnProperty(t)&&!0!==i.get(t)&&m.createTermDefinition(e,n,t,i,o),e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext),(r=r||{}).vocab){const r=e.mappings.get(t);if(null===r)return null;if(r)return r["@id"]}const a=t.indexOf(":");if(-1!==a){const r=t.substr(0,a),s=t.substr(a+1);if("_"===r||0===s.indexOf("//"))return t;if(n&&n.hasOwnProperty(r)&&m.createTermDefinition(e,n,r,i,o),e.mappings.has(r)){return e.mappings.get(r)["@id"]+s}return t}return r.vocab&&"@vocab"in e?e["@vocab"]+t:r.base?f(e["@base"],t):t}function w(e,t,r,n){if(a(e))for(const i of e)w(i,t,r,n);else if(s(e))for(const i in e){if("@context"!==i){w(e[i],t,r,n);continue}const o=e[i];if(a(o)){let e=o.length;for(let i=0;i<e;++i){const c=o[i];if(u(c)){const s=f(n,c),u=t.get(s);r?a(u)?(Array.prototype.splice.apply(o,[i,1].concat(u)),i+=u.length-1,e=o.length):!1!==u&&(o[i]=u):void 0===u&&t.set(s,!1)}else for(const e in c)s(c[e])&&w(c[e],t,r,n)}}else if(u(o)){const a=f(n,o),s=t.get(a);r?!1!==s&&(e[i]=s):void 0===s&&t.set(a,!1)}else for(const e in o)s(o[e])&&w(o[e],t,r,n)}}e.exports=m,m.cache=new i,m.process=({activeCtx:e,localCtx:t,options:r,isPropertyTermScopedContext:i=!1,isTypeScopedContext:c=!1})=>{s(t)&&"@context"in t&&a(t["@context"])&&(t=t["@context"]);const g=p(t);if(0===g.length)return e;const y=e.previousContext||e;if(i&&e.previousContext)return(e=e.clone()).isPropertyTermScoped=!0,e.previousContext=m.process({activeCtx:e.previousContext,localCtx:g,options:r,isPropertyTermScopedContext:i}),e;let v=e;for(let a=0;a<g.length;++a){let p=g[a];if(e=v,null===p){if(!i&&0!==Object.keys(e.protected).length){const i=r&&r.protectedMode||"error";if("error"===i)throw new o("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===i){console.warn("WARNING: invalid context nullification");const t=e;v=e=m.getInitialContext(r).clone();for(const[r,i]of Object.entries(t.protected))i&&(e.mappings[r]=n.clone(t.mappings[r]));e.protected=n.clone(t.protected),m.cache&&m.cache.set(t,p,v);continue}throw new o("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:t,protectedMode:i})}v=e=m.getInitialContext(r).clone(),c&&(v.previousContext=y.clone());continue}if(m.cache){const t=m.cache.get(e,p);if(t){v=e=t;continue}}if(s(p)&&"@context"in p&&(p=p["@context"]),!s(p))throw new o("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:p});v=v.clone();const b=new Map;if("@version"in p){if(1.1!==p["@version"])throw new o("Unsupported JSON-LD version: "+p["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:p});if(e.processingMode&&"json-ld-1.0"===e.processingMode)throw new o("@version: "+p["@version"]+" not compatible with "+e.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:p});v.processingMode="json-ld-1.1",v["@version"]=p["@version"],b.set("@version",!0)}if(v.processingMode=v.processingMode||e.processingMode||"json-ld-1.0","@base"in p){let t=p["@base"];if(null===t);else if(l(t))t=d(t);else{if(!h(t))throw new o('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:p});t=d(f(e["@base"].href,t))}v["@base"]=t,b.set("@base",!0)}if("@vocab"in p){const e=p["@vocab"];if(null===e)delete v["@vocab"];else{if(!u(e))throw new o('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:p});if(!l(e))throw new o('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:p});v["@vocab"]=e}b.set("@vocab",!0)}if("@language"in p){const e=p["@language"];if(null===e)delete v["@language"];else{if(!u(e))throw new o('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:p});v["@language"]=e.toLowerCase()}b.set("@language",!0)}b.set("@protected",p["@protected"]||!1);for(const e in p)m.createTermDefinition(v,p,e,b,r,i);c&&!v.previousContext&&(v.previousContext=y.clone()),m.cache&&m.cache.set(e,p,v)}return v},m.createTermDefinition=(e,t,r,n,i,c=!1)=>{if(n.has(r)){if(n.get(r))return;throw new o("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:r})}if(n.set(r,!1),m.isKeyword(r))throw new o("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:r});if(""===r)throw new o("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t});const h=e.mappings.get(r);let f;if(e.mappings.has(r)&&e.mappings.delete(r),t.hasOwnProperty(r)&&(f=t[r]),null===f||s(f)&&null===f["@id"])return e.mappings.set(r,null),void n.set(r,!0);let d=!1;if(u(f)&&(d=!0,f={"@id":f}),!s(f))throw new o("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});const p={};e.mappings.set(r,p),p.reverse=!1;const g=["@container","@id","@language","@reverse","@type"];m.processingMode(e,1.1)&&g.push("@context","@nest","@prefix","@protected");for(const e in f)if(!g.includes(e))throw new o("Invalid JSON-LD syntax; a term definition must not contain "+e,"jsonld.SyntaxError",{code:"invalid term definition",context:t});const y=r.indexOf(":");if(p._termHasColon=-1!==y,"@reverse"in f){if("@id"in f)throw new o("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});if("@nest"in f)throw new o("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});const r=f["@reverse"];if(!u(r))throw new o("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});const a=b(e,r,{vocab:!0,base:!1},t,n,i);if(!l(a))throw new o("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});p["@id"]=a,p.reverse=!0}else if("@id"in f){let a=f["@id"];if(!u(a))throw new o("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(a!==r){if(a=b(e,a,{vocab:!0,base:!1},t,n,i),!l(a)&&!m.isKeyword(a))throw new o("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});p["@id"]=a,p._prefix=!p._termHasColon&&a.match(/[:\/\?#\[\]@]$/)&&(d||m.processingMode(e,1))}}if(!("@id"in p))if(p._termHasColon){const o=r.substr(0,y);if(t.hasOwnProperty(o)&&m.createTermDefinition(e,t,o,n,i),e.mappings.has(o)){const t=r.substr(y+1);p["@id"]=e.mappings.get(o)["@id"]+t}else p["@id"]=r}else{if(!("@vocab"in e))throw new o("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:r});p["@id"]=e["@vocab"]+r}if((!0===f["@protected"]||!0===n.get("@protected")&&!1!==f["@protected"])&&(e.protected[r]=!0,p.protected=!0),n.set(r,!0),"@type"in f){let r=f["@type"];if(!u(r))throw new o("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@id"!==r&&"@vocab"!==r){if(r=b(e,r,{vocab:!0,base:!1},t,n,i),!l(r))throw new o("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===r.indexOf("_:"))throw new o("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}p["@type"]=r}if("@container"in f){const r=u(f["@container"])?[f["@container"]]:f["@container"]||[],n=["@list","@set","@index","@language"];let i=!0;const s=r.includes("@set");if(m.processingMode(e,1.1))if(n.push("@graph","@id","@type"),r.includes("@list")){if(1!==r.length)throw new o("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else if(r.includes("@graph")){if(r.some(e=>"@graph"!==e&&"@id"!==e&&"@index"!==e&&"@set"!==e))throw new o("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else i&=r.length<=(s?2:1);else i&=!a(f["@container"]),i&=r.length<=1;if(i&=r.every(e=>n.includes(e)),!(i&=!(s&&r.includes("@list"))))throw new o("Invalid JSON-LD syntax; @context @container value must be one of the following: "+n.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(p.reverse&&!r.every(e=>["@index","@set"].includes(e)))throw new o("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});p["@container"]=r}if("@context"in f&&(p["@context"]=f["@context"]),"@language"in f&&!("@type"in f)){let e=f["@language"];if(null!==e&&!u(e))throw new o("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==e&&(e=e.toLowerCase()),p["@language"]=e}if("@prefix"in f){if(p._termHasColon)throw new o("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:t});if("boolean"!=typeof f["@prefix"])throw new o("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:t});p._prefix=!0===f["@prefix"]}if("@nest"in f){const e=f["@nest"];if(!u(e)||"@nest"!==e&&0===e.indexOf("@"))throw new o("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:t});p["@nest"]=e}
// disallow aliasing @context and @preserve
const v=p["@id"];if("@context"===v||"@preserve"===v)throw new o("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t});if(h&&h.protected&&!c&&(e.protected[r]=!0,p.protected=!0,!function e(t,r){if(!t||"object"!=typeof t||!r||"object"!=typeof r)return t===r;const n=Array.isArray(t);if(n!==Array.isArray(r))return!1;if(n){if(t.length!==r.length)return!1;for(let n=0;n<t.length;++n)if(!e(t[n],r[n]))return!1;return!0}const i=Object.keys(t);const o=Object.keys(r);if(i.length!==o.length)return!1;for(const n in t){let i=t[n],o=r[n];if("@container"===n&&Array.isArray(i)&&Array.isArray(o)&&(i=i.slice().sort(),o=o.slice().sort()),!e(i,o))return!1}return!0}(h,p))){const e=i&&i.protectedMode||"error";if("error"===e)throw new o("Invalid JSON-LD syntax; tried to redefine a protected term.","jsonld.SyntaxError",{code:"protected term redefinition",context:t,term:r});if("warn"===e)return void console.warn("WARNING: protected term redefinition",{term:r});throw new o("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:t,term:r,protectedMode:e})}},m.expandIri=(e,t,r,n)=>b(e,t,r,void 0,void 0,n),m.getInitialContext=e=>{const t=d(e.base||""),r=JSON.stringify({base:t,processingMode:e.processingMode}),i=v.get(r);if(i)return i;const o={"@base":t,processingMode:e.processingMode,mappings:new Map,inverse:null,getInverse:function(){const e=this;if(e.inverse)return e.inverse;const t=e.inverse={},r=e.fastCurieMap={},n={},i=e["@language"]||"@none",o=e.mappings,u=[...o.keys()].sort(g);for(const e of u){const a=o.get(e);if(null===a)continue;let u=a["@container"]||"@none";u=[].concat(u).sort().join("");const c=p(a["@id"]);for(const o of c){let c=t[o];const l=m.isKeyword(o);if(c)l||a._termHasColon||n[o].push(e);else if(t[o]=c={},!l&&!a._termHasColon){n[o]=[e];const t={iri:o,terms:n[o]};o[0]in r?r[o[0]].push(t):r[o[0]]=[t]}if(c[u]||(c[u]={"@language":{},"@type":{},"@any":{}}),c=c[u],s(e,c["@any"],"@none"),a.reverse)s(e,c["@type"],"@reverse");else if("@type"in a)s(e,c["@type"],a["@type"]);else if("@language"in a){const t=a["@language"]||"@null";s(e,c["@language"],t)}else s(e,c["@language"],i),s(e,c["@type"],"@none"),s(e,c["@language"],"@none")}}for(const e in r)a(r,e,1);return t},clone:function(){const e={};e["@base"]=this["@base"],e.mappings=n.clone(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,e.protected=n.clone(this.protected),this.previousContext&&(e.isPropertyTermScoped=this.previousContext.isPropertyTermScoped,e.previousContext=this.previousContext.clone());e.revertTypeScopedContext=this.revertTypeScopedContext,"@language"in this&&(e["@language"]=this["@language"]);"@vocab"in this&&(e["@vocab"]=this["@vocab"]);return e},revertTypeScopedContext:function(){if(!this.previousContext)return this;return this.previousContext.clone()},protected:{}};return 1e4===v.size&&v.clear(),v.set(r,o),o;function a(e,t,r){const n=e[t],i=e[t]={};let o,s;for(const e of n)(s=r>=(o=e.iri).length?"":o[r])in i?i[s].push(e):i[s]=[e];for(const e in i)""!==e&&a(i,e,r+1)}function s(e,t,r){t.hasOwnProperty(r)||(t[r]=e)}},m.getContextValue=(e,t,r)=>{if(null===t){if("@context"===r)return;return null}if(e.mappings.has(t)){const n=e.mappings.get(t);if(c(r))return n;if(n.hasOwnProperty(r))return n[r]}return"@language"===r&&e.hasOwnProperty(r)?e[r]:"@context"!==r?null:void 0},m.getAllContexts=async(e,t)=>(async function(e,t){const r=n.normalizeDocumentLoader(t.documentLoader);return await async function e(r,n,i){if(n.size>y)throw new o("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:y});const c=new Map;w(r,c,!1,t.base);if(0===c.size)return;const l=[...c.keys()].filter(e=>!1===c.get(e));return Promise.all(l.map(async l=>{if(n.has(l))throw new o("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:l});const h=new Set(n);let f,d;h.add(l);try{f=await i(l),d=f.document||null,u(d)&&(d=JSON.parse(d))}catch(e){throw new o("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:l,cause:e})}if(!s(d))throw new o("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:l});d="@context"in d?{"@context":d["@context"]}:{"@context":{}},f.contextUrl&&(a(d["@context"])||(d["@context"]=[d["@context"]]),d["@context"].push(f.contextUrl)),await e(d,h,i),c.set(l,d["@context"]),w(r,c,!0,t.base)}))}(e,new Set,r),e})(e,t),m.processingMode=(e,t)=>t.toString()>="1.1"?e.processingMode&&e.processingMode>="json-ld-"+t.toString():!e.processingMode||"json-ld-1.0"===e.processingMode,m.isKeyword=e=>{if(!u(e))return!1;switch(e){case"@base":case"@container":case"@context":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},function(e,t,r){"use strict";var n=r(31),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=h;var o=r(28);o.inherits=r(22);var a=r(56),s=r(44);o.inherits(h,a);for(var u=i(s.prototype),c=0;c<u.length;c++){var l=u[c];h.prototype[l]||(h.prototype[l]=s.prototype[l])}function h(e){if(!(this instanceof h))return new h(e);a.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||n.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},function(e,t,r){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r(70),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(18))},function(e,t){e.exports={options:{usePureJavaScript:!1}}},function(e,t,r){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=r(73),i=r(74),o=r(50);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,r)}function c(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(t,r),i=(e=s(e,n)).write(t,r);i!==n&&(e=e.slice(0,i));return e}(e,t,r):function(e,t){if(u.isBuffer(t)){var r=0|d(t.length);return 0===(e=s(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?s(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(l(t),e=s(e,t<0?0:0|d(t)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function f(e,t){var r=t.length<0?0:0|d(t.length);e=s(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function d(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return z(e).length;default:if(n)return q(e).length;t=(""+t).toLowerCase(),n=!0}}function g(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return j(this,t,r);case"latin1":case"binary":return E(this,t,r);case"base64":return S(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:m(e,t,r,n,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,r,n,i){var o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(e,o+f)!==c(t,f)){h=!1;break}if(h)return o}return-1}function b(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function w(e,t,r,n){return H(q(t,e.length-r),e,r,n)}function x(e,t,r,n){return H(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function _(e,t,r,n){return x(e,t,r,n)}function T(e,t,r,n){return H(z(t),e,r,n)}function k(e,t,r,n){return H(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function S(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function I(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,u,c=e[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=r)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=h}return function(e){var t=e.length;if(t<=N)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=N));return r}(n)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,r){return c(null,e,t,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,r){return function(e,t,r,n){return l(t),t<=0?s(e,t):void 0!==r?"string"==typeof n?s(e,t).fill(r,n):s(e,t).fill(r):s(e,t)}(null,e,t,r)},u.allocUnsafe=function(e){return h(null,e)},u.allocUnsafeSlow=function(e){return h(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=u.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i),i+=a.length}return n},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?I(this,0,e):g.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,r,n,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),c=this.slice(n,i),l=e.slice(t,r),h=0;h<s;++h)if(c[h]!==l[h]){o=c[h],a=l[h];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return b(this,e,t,r);case"utf8":case"utf-8":return w(this,e,t,r);case"ascii":return x(this,e,t,r);case"latin1":case"binary":return _(this,e,t,r);case"base64":return T(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var N=4096;function j(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function E(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function O(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=F(e[o]);return i}function C(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function R(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,r,n,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function L(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function D(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function M(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(e,t,r,n,o){return o||M(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function P(e,t,r,n,o){return o||M(e,0,r,8),i.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;r=new u(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},u.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},u.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},u.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||A(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},u.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||A(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},u.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);A(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);A(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,r){return U(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return U(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return P(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return P(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=u.isBuffer(e)?e:q(new u(e,n).toString()),s=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function q(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function z(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}}).call(this,r(18))},function(e,t,r){"use strict";const n="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2001/XMLSchema#";e.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",RDF:n,RDF_LIST:n+"List",RDF_FIRST:n+"first",RDF_REST:n+"rest",RDF_NIL:n+"nil",RDF_TYPE:n+"type",RDF_PLAIN_LITERAL:n+"PlainLiteral",RDF_XML_LITERAL:n+"XMLLiteral",RDF_OBJECT:n+"object",RDF_LANGSTRING:n+"langString",XSD:i,XSD_BOOLEAN:i+"boolean",XSD_DOUBLE:i+"double",XSD_INTEGER:i+"integer",XSD_STRING:i+"string"}},function(e,t,r){"use strict";const n=r(13),i={};e.exports=i,i.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},i.parse=(e,t)=>{const r={},n=i.parsers[t||"full"],o=n.regex.exec(e);let a=n.keys.length;for(;a--;)r[n.keys[a]]=void 0===o[a]?null:o[a];return("https"===r.scheme&&"443"===r.port||"http"===r.scheme&&"80"===r.port)&&(r.href=r.href.replace(":"+r.port,""),r.authority=r.authority.replace(":"+r.port,""),r.port=null),r.normalizedPath=i.removeDotSegments(r.path),r},i.prependBase=(e,t)=>{if(null===e)return t;if(-1!==t.indexOf(":"))return t;n.isString(e)&&(e=i.parse(e||""));const r=i.parse(t),o={protocol:e.protocol||""};if(null!==r.authority)o.authority=r.authority,o.path=r.path,o.query=r.query;else if(o.authority=e.authority,""===r.path)o.path=e.path,null!==r.query?o.query=r.query:o.query=e.query;else{if(0===r.path.indexOf("/"))o.path=r.path;else{let t=e.path;(t=t.substr(0,t.lastIndexOf("/")+1)).length>0&&"/"!==t.substr(-1)&&(t+="/"),t+=r.path,o.path=t}o.query=r.query}""!==r.path&&(o.path=i.removeDotSegments(o.path));let a=o.protocol;return null!==o.authority&&(a+="//"+o.authority),a+=o.path,null!==o.query&&(a+="?"+o.query),null!==r.fragment&&(a+="#"+r.fragment),""===a&&(a="./"),a},i.removeBase=(e,t)=>{if(null===e)return t;n.isString(e)&&(e=i.parse(e||""));let r="";if(""!==e.href?r+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(r+="//"),0!==t.indexOf(r))return t;const o=i.parse(t.substr(r.length)),a=e.normalizedPath.split("/"),s=o.normalizedPath.split("/"),u=o.fragment||o.query?0:1;for(;a.length>0&&s.length>u&&a[0]===s[0];)a.shift(),s.shift();let c="";if(a.length>0){a.pop();for(let e=0;e<a.length;++e)c+="../"}return c+=s.join("/"),null!==o.query&&(c+="?"+o.query),null!==o.fragment&&(c+="#"+o.fragment),""===c&&(c="./"),c},i.removeDotSegments=e=>{if(0===e.length)return"";const t=e.split("/"),r=[];for(;t.length>0;){const e=t.shift(),n=0===t.length;"."!==e?".."!==e?r.push(e):(r.pop(),n&&r.push("")):n&&r.push("")}return r.length>0&&""!==r[0]&&r.unshift(""),1===r.length&&""===r[0]?"/":r.join("/")};const o=/^([A-Za-z][A-Za-z0-9+-.]*|_):/;i.isAbsolute=e=>n.isString(e)&&o.test(e),i.isRelative=e=>n.isString(e)},function(e,t,r){(function(e){function r(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===r(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===r(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===r(e)},t.isError=function(e){return"[object Error]"===r(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,r(25).Buffer)},function(t,r){t.exports=e},function(e,t,r){"use strict";const{isKeyword:n}=r(20),i=r(16),o=r(13),a=r(10),s=r(17),u={};e.exports=u,u.createMergedNodeMap=(e,t)=>{const r=(t=t||{}).issuer||new a.IdentifierIssuer("_:b"),n={"@default":{}};return u.createNodeMap(e,n,"@default",r),u.mergeNodeMaps(n)},u.createNodeMap=(e,t,r,c,l,h)=>{if(o.isArray(e)){for(let n=0;n<e.length;++n)u.createNodeMap(e[n],t,r,c,void 0,h);return}if(!o.isObject(e))return void(h&&h.push(e));if(i.isValue(e)){if("@type"in e){let t=e["@type"];0===t.indexOf("_:")&&(e["@type"]=t=c.getId(t))}return void(h&&h.push(e))}if("@type"in e){const t=e["@type"];for(let e=0;e<t.length;++e){const r=t[e];0===r.indexOf("_:")&&c.getId(r)}}o.isUndefined(l)&&(l=i.isBlankNode(e)?c.getId(e["@id"]):e["@id"]),h&&h.push({"@id":l});const f=t[r],d=f[l]=f[l]||{};d["@id"]=l;const p=Object.keys(e).sort();for(let o=0;o<p.length;++o){let h=p[o];if("@id"===h)continue;if("@reverse"===h){const n={"@id":l},o=e["@reverse"];for(const e in o){const s=o[e];for(let o=0;o<s.length;++o){const l=s[o];let h=l["@id"];i.isBlankNode(l)&&(h=c.getId(h)),u.createNodeMap(l,t,r,c,h),a.addValue(f[h],e,n,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===h){l in t||(t[l]={}),u.createNodeMap(e[h],t,l,c);continue}if("@type"!==h&&n(h)){if("@index"===h&&h in d&&(e[h]!==d[h]||e[h]["@id"]!==d[h]["@id"]))throw new s("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:d});d[h]=e[h];continue}const g=e[h];if(0===h.indexOf("_:")&&(h=c.getId(h)),0!==g.length)for(let e=0;e<g.length;++e){let n=g[e];if("@type"===h&&(n=0===n.indexOf("_:")?c.getId(n):n),i.isSubject(n)||i.isSubjectReference(n)){const e=i.isBlankNode(n)?c.getId(n["@id"]):n["@id"];a.addValue(d,h,{"@id":e},{propertyIsArray:!0,allowDuplicate:!1}),u.createNodeMap(n,t,r,c,e)}else if(i.isList(n)){const e=[];u.createNodeMap(n["@list"],t,r,c,l,e),n={"@list":e},a.addValue(d,h,n,{propertyIsArray:!0,allowDuplicate:!1})}else u.createNodeMap(n,t,r,c,l),a.addValue(d,h,n,{propertyIsArray:!0,allowDuplicate:!1})}else a.addValue(d,h,[],{propertyIsArray:!0})}},u.mergeNodeMapGraphs=e=>{const t={};for(const r of Object.keys(e).sort())for(const i of Object.keys(e[r]).sort()){const o=e[r][i];i in t||(t[i]={"@id":i});const s=t[i];for(const e of Object.keys(o).sort())if(n(e))s[e]=a.clone(o[e]);else for(const t of o[e])a.addValue(s,e,a.clone(t),{propertyIsArray:!0,allowDuplicate:!1})}return t},u.mergeNodeMaps=e=>{const t=e["@default"],r=Object.keys(e).sort();for(let n=0;n<r.length;++n){const o=r[n];if("@default"===o)continue;const a=e[o];let s=t[o];s?"@graph"in s||(s["@graph"]=[]):t[o]=s={"@id":o,"@graph":[]};const u=s["@graph"],c=Object.keys(a).sort();for(let e=0;e<c.length;++e){const t=a[c[e]];i.isSubjectReference(t)||u.push(t)}}return t}},function(e,t,r){"use strict";(function(t){void 0===t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,r,n,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function(){e.call(null,r)});case 3:return t.nextTick(function(){e.call(null,r,n)});case 4:return t.nextTick(function(){e.call(null,r,n,i)});default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return t.nextTick(function(){e.apply(null,o)})}}}:e.exports=t}).call(this,r(15))},function(e,t,r){(function(t,n){
/**
 * A JavaScript implementation of the JSON-LD API.
 *
 * @author Dave Longley
 *
 * @license BSD 3-Clause License
 * Copyright (c) 2011-2017 Digital Bazaar, Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright
 * notice, this list of conditions and the following disclaimer in the
 * documentation and/or other materials provided with the distribution.
 *
 * Neither the name of the Digital Bazaar, Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
 * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
 * PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
 * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
const i=r(33),o=r(10),a=o.IdentifierIssuer,s=r(17),u=r(80),c=r(81),{expand:l}=r(82),{flatten:h}=r(84),{fromRDF:f}=r(85),{toRDF:d}=r(86),{frameMergedOrDefault:p}=r(87),{isArray:g,isObject:y,isString:v}=r(13),{isSubjectReference:m}=r(16),{getInitialContext:b,process:w,getAllContexts:x}=r(20),{compact:_,compactIri:T,removePreserve:k}=r(88),{createNodeMap:S,createMergedNodeMap:I,mergeNodeMaps:N}=r(30),j=void 0!==t&&t.versions&&t.versions.node,E=!j&&("undefined"!=typeof window||"undefined"!=typeof self),O=function(e){e.compact=o.callbackify(async function(t,r,n){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===r)throw new s("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===t)return null;let i;(n=O(n,{base:v(t)?t:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new a("_:b")})).link&&(n.skipExpansion=!0),n.compactToRelative||delete n.base,i=n.skipExpansion?t:await e.expand(t,n);const u=await e.processContext(b(n),r,n);let c=_({activeCtx:u,element:i,options:n,compactionMap:n.compactionMap});n.compactArrays&&!n.graph&&g(c)?1===c.length?c=c[0]:0===c.length&&(c={}):n.graph&&y(c)&&(c=[c]),y(r)&&"@context"in r&&(r=r["@context"]),r=o.clone(r),g(r)||(r=[r]);const l=r;r=[];for(let e=0;e<l.length;++e)(!y(l[e])||Object.keys(l[e]).length>0)&&r.push(l[e]);const h=r.length>0;if(1===r.length&&(r=r[0]),g(c)){const e=T({activeCtx:u,iri:"@graph",relativeTo:{vocab:!0}}),t=c;c={},h&&(c["@context"]=r),c[e]=t}else if(y(c)&&h){const e=c;c={"@context":r};for(const t in e)c[t]=e[t]}if(n.framing){const e=T({activeCtx:u,iri:"@graph",relativeTo:{vocab:!0}});
// remove @preserve from results
n.link={},c[e]=k(u,c[e],n)}return c}),e.expand=o.callbackify(async function(t,r){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(r=O(r,{keepFreeFloatingNodes:!1})).expansionMap&&(r.expansionMap=void 0);const n={},i=[];if("expandContext"in r){const e=o.clone(r.expandContext);y(e)&&"@context"in e?n.expandContext=e:n.expandContext={"@context":e},i.push(n.expandContext)}let a;if(v(t)){const o=await e.get(t,r);a=o.documentUrl,n.input=o.document,o.contextUrl&&(n.remoteContext={"@context":o.contextUrl},i.push(n.remoteContext))}else n.input=o.clone(t);"base"in r||(r.base=a||""),await x(n,r);let s=b(r);i.forEach(e=>{s=w({activeCtx:s,localCtx:e,options:r})});let u=l({activeCtx:s,element:n.input,options:r,expansionMap:r.expansionMap});return y(u)&&"@graph"in u&&1===Object.keys(u).length?u=u["@graph"]:null===u&&(u=[]),g(u)||(u=[u]),u}),e.flatten=o.callbackify(async function(t,r,n){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");r="function"==typeof r?null:r||null,n=O(n,{base:v(t)?t:""});const i=await e.expand(t,n),o=h(i);if(null===r)return o;n.graph=!0,n.skipExpansion=!0;const a=await e.compact(o,r,n);return a}),e.frame=o.callbackify(async function(t,r,n){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(n=O(n,{base:v(t)?t:"",embed:"@last",explicit:!1,requireAll:!0,omitDefault:!1,pruneBlankNodeIdentifiers:!0,bnodesToClear:[]}),v(r)){const t=await e.get(r,n);if(r=t.document,t.contextUrl){let e=r["@context"];e?g(e)?e.push(t.contextUrl):e=[e,t.contextUrl]:e=t.contextUrl,r["@context"]=e}}const i=r&&r["@context"]||{},a=await e.expand(t,n),s=o.clone(n);s.isFrame=!0,s.keepFreeFloatingNodes=!0;const u=await e.expand(r,s);let c;s.merged=!("@graph"in r),c=p(a,u,s),s.graph=!0,s.skipExpansion=!0,s.link={},s.framing=!0;const l=await e.compact(c,i,s);return l}),e.link=o.callbackify(async function(t,r,n){const i={};return r&&(i["@context"]=r),i["@embed"]="@link",e.frame(t,i,n)}),e.normalize=e.canonize=o.callbackify(async function(t,r){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(r=O(r,{base:v(t)?t:"",algorithm:"URDNA2015",skipExpansion:!1}))){if("application/n-quads"!==r.inputFormat&&"application/nquads"!==r.inputFormat)throw new s("Unknown canonicalization input format.","jsonld.CanonizeError");const e=u.parse(t);return i.canonize(e,r)}const n=o.clone(r);delete n.format,n.produceGeneralizedRdf=!1;const a=await e.toRDF(t,n);return i.canonize(a,r)}),e.fromRDF=o.callbackify(async function(e,r){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");r=O(r,{format:v(e)?"application/n-quads":void 0});let n,{format:i,rdfParser:o}=r;if(i){if(!(o=o||t[i]))throw new s("Unknown input format.","jsonld.UnknownFormat",{format:i})}else o=()=>e;return n=o.length>1?new Promise((t,r)=>{o(e,(e,n)=>{e?r(e):t(n)})}):Promise.resolve(o(e)),n=await n,Array.isArray(n)||(n=u.legacyDatasetToQuads(n)),f(n,r)}),e.toRDF=o.callbackify(async function(t,r){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let n;n=(r=O(r,{base:v(t)?t:"",skipExpansion:!1})).skipExpansion?t:await e.expand(t,r);const i=d(n,r);if(r.format){if("application/n-quads"===r.format||"application/nquads"===r.format)return await u.serialize(i);throw new s("Unknown output format.","jsonld.UnknownFormat",{format:r.format})}return i}),e.createNodeMap=o.callbackify(async function(t,r){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");r=O(r,{base:v(t)?t:""});const n=await e.expand(t,r);return I(n,r)}),e.merge=o.callbackify(async function(t,r,n){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!g(t))throw new TypeError('Could not merge, "docs" must be an array.');r="function"==typeof r?null:r||null,n=O(n,{});const i=await Promise.all(t.map(t=>{const r=Object.assign({},n);return e.expand(t,r)}));let s=!0;"mergeNodes"in n&&(s=n.mergeNodes);const u=n.issuer||new a("_:b"),c={"@default":{}};for(let e=0;e<i.length;++e){const t=o.relabelBlankNodes(i[e],{issuer:new a("_:b"+e+"-")}),r=s||0===e?c:{"@default":{}};if(S(t,r,"@default",u),r!==c)for(const e in r){const t=r[e];if(!(e in c)){c[e]=t;continue}const n=c[e];for(const e in t)e in n||(n[e]=t[e])}}const l=N(c),h=[],f=Object.keys(l).sort();for(let e=0;e<f.length;++e){const t=l[f[e]];m(t)||h.push(t)}if(null===r)return h;n.graph=!0,n.skipExpansion=!0;const d=await e.compact(h,r,n);return d}),Object.defineProperty(e,"documentLoader",{get:()=>e._documentLoader,set:t=>e._documentLoader=o.normalizeDocumentLoader(t)}),e.documentLoader=async e=>{throw new s("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:e})},e.loadDocument=o.callbackify(async function(){return e.documentLoader.apply(null,arguments)}),e.get=o.callbackify(async function(t,r){let n;n="function"==typeof r.documentLoader?o.normalizeDocumentLoader(r.documentLoader):e.documentLoader;const i=await n(t);try{if(!i.document)throw new s("No remote document found at the given URL.","jsonld.NullRemoteDocument");v(i.document)&&(i.document=JSON.parse(i.document))}catch(e){throw new s("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:i})}return i}),e.processContext=o.callbackify(async function(e,t,r){if(r=O(r,{base:""}),null===t)return b(r);t=o.clone(t),y(t)&&"@context"in t||(t={"@context":t});const n=await x(t,r);return w({activeCtx:e,localCtx:n,options:r})}),e.getContextValue=r(20).getContextValue,e.documentLoaders={},e.documentLoaders.node=r(89),e.documentLoaders.xhr=r(92),e.useDocumentLoader=function(t){if(!(t in e.documentLoaders))throw new s('Unknown document loader type: "'+t+'"',"jsonld.UnknownDocumentLoader",{type:t});e.documentLoader=e.documentLoaders[t].apply(e,Array.prototype.slice.call(arguments,1))};const t={};function O(t,{documentLoader:r=e.documentLoader,...n}){return Object.assign({},{documentLoader:r},n,t)}return e.registerRDFParser=function(e,r){t[e]=r},e.unregisterRDFParser=function(e){delete t[e]},e.registerRDFParser("application/n-quads",u.parse),e.registerRDFParser("application/nquads",u.parse),e.registerRDFParser("rdfa-api",c.parse),e.url=r(27),e.util=o,Object.assign(e,o),e.promises=e,e.RequestQueue=r(37),e.JsonLdProcessor=r(93)(e),E&&void 0===n.JsonLdProcessor&&Object.defineProperty(n,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:e.JsonLdProcessor}),j?e.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&e.useDocumentLoader("xhr"),e},C=function(){return O(function(){return C()})};O(C),e.exports=C}).call(this,r(15),r(18))},function(e,t,r){"use strict";const n=r(19),i=r(47),o=r(77),a=r(52),s=r(78);let u;try{u=r(79)}catch(e){}const c={};e.exports=c,c.NQuads=r(36),c.IdentifierIssuer=r(34),c._rdfCanonizeNative=function(e){return e&&(u=e),u},c.canonize=n.callbackify(async function(e,t){let r;const n=new Promise((e,t)=>{r=(r,n)=>{if(r)return t(r);e(n)}});if(Array.isArray(e)||(e=c.NQuads.legacyDatasetToQuads(e)),t.useNative){if(!u)throw new Error("rdf-canonize-native not available");u.canonize(e,t,r)}else if("URDNA2015"===t.algorithm)new i(t).main(e,r);else{if("URGNA2012"!==t.algorithm)throw"algorithm"in t?new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.");new o(t).main(e,r)}return n}),c.canonizeSync=function(e,t){if(Array.isArray(e)||(e=c.NQuads.legacyDatasetToQuads(e)),t.useNative){if(u)return u.canonizeSync(e,t);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===t.algorithm)return new a(t).main(e);if("URGNA2012"===t.algorithm)return new s(t).main(e);if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)}},function(e,t,r){"use strict";const n=r(19);e.exports=class e{constructor(e){this.prefix=e,this.counter=0,this.existing={}}clone(){const t=new e(this.prefix);return t.counter=this.counter,t.existing=n.clone(this.existing),t}getId(e){if(e&&e in this.existing)return this.existing[e];const t=this.prefix+this.counter;return this.counter+=1,e&&(this.existing[e]=t),t}hasId(e){return e in this.existing}}},function(e,t,r){var n=r(24);e.exports=n.md=n.md||{},n.md.algorithms=n.md.algorithms||{}},function(e,t,r){"use strict";const n="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",i="http://www.w3.org/2001/XMLSchema#string",o={};function a(e,t){for(const r in e)if(e[r].termType!==t[r].termType||e[r].value!==t[r].value)return!1;return"Literal"!==e.object.termType||e.object.datatype.termType===t.object.datatype.termType&&e.object.datatype.value===t.object.datatype.value&&e.object.language===t.object.language}o.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,o.empty=new RegExp("^[ \\t]*$"),o.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9])(?:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀.])*(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9])(?:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀.])*(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9])(?:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀.])*(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀]))?))[ \\t]*\\.))[ \\t]*$'),e.exports=class e{static parse(e){const t=[],r={},s=e.split(o.eoln);let c=0;for(const e of s){if(c++,o.empty.test(e))continue;const s=e.match(o.quad);if(null===s)throw new Error("N-Quads parse error on line "+c+".");const l={};if(void 0!==s[1]?l.subject={termType:"NamedNode",value:s[1]}:l.subject={termType:"BlankNode",value:s[2]},l.predicate={termType:"NamedNode",value:s[3]},void 0!==s[4]?l.object={termType:"NamedNode",value:s[4]}:void 0!==s[5]?l.object={termType:"BlankNode",value:s[5]}:(l.object={termType:"Literal",value:void 0,datatype:{termType:"NamedNode"}},void 0!==s[7]?l.object.datatype.value=s[7]:void 0!==s[8]?(l.object.datatype.value=n,l.object.language=s[8]):l.object.datatype.value=i,l.object.value=s[6].replace(u,function(e,t,r,n){if(t)switch(t){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(r)return String.fromCharCode(parseInt(r,16));if(n)throw new Error("Unsupported U escape")})),void 0!==s[9]?l.graph={termType:"NamedNode",value:s[9]}:void 0!==s[10]?l.graph={termType:"BlankNode",value:s[10]}:l.graph={termType:"DefaultGraph",value:""},l.graph.value in r){let e=!0;const n=r[l.graph.value];for(const t of n)if(a(t,l)){e=!1;break}e&&(n.push(l),t.push(l))}else r[l.graph.value]=[l],t.push(l)}return t}static serialize(t){Array.isArray(t)||(t=e.legacyDatasetToQuads(t));const r=[];for(const n of t)r.push(e.serializeQuad(n));return r.sort().join("")}static serializeQuad(e){const t=e.subject,r=e.predicate,o=e.object,a=e.graph;let u="";return[t,r].forEach(e=>{"NamedNode"===e.termType?u+="<"+e.value+">":u+=e.value,u+=" "}),"NamedNode"===o.termType?u+="<"+o.value+">":"BlankNode"===o.termType?u+=o.value:(u+='"'+function(e){return e.replace(s,function(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}(o.value)+'"',o.datatype.value===n?o.language&&(u+="@"+o.language):o.datatype.value!==i&&(u+="^^<"+o.datatype.value+">")),"NamedNode"===a.termType?u+=" <"+a.value+">":"BlankNode"===a.termType&&(u+=" "+a.value),u+=" .\n"}static legacyDatasetToQuads(e){const t=[],r={"blank node":"BlankNode",IRI:"NamedNode",literal:"Literal"};for(const o in e){e[o].forEach(e=>{const a={};for(const t in e){const o=e[t],s={termType:r[o.type],value:o.value};"Literal"===s.termType&&(s.datatype={termType:"NamedNode"},"datatype"in o&&(s.datatype.value=o.datatype),"language"in o?("datatype"in o||(s.datatype.value=n),s.language=o.language):"datatype"in o||(s.datatype.value=i)),a[t]=s}a.graph="@default"===o?{termType:"DefaultGraph",value:""}:{termType:o.startsWith("_:")?"BlankNode":"NamedNode",value:o},t.push(a)})}return t}};const s=/["\\\n\r]/g;const u=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},function(e,t,r){"use strict";const{callbackify:n,normalizeDocumentLoader:i}=r(10);e.exports=class{constructor(){this._requests={},this.add=n(this.add.bind(this))}wrapLoader(e){const t=this;return t._loader=i(e),function(){return t.add.apply(t,arguments)}}async add(e){const t=this;let r=t._requests[e];if(r)return Promise.resolve(r);r=t._requests[e]=t._loader(e);try{return await r}finally{delete t._requests[e]}}}},function(e,t,r){(function(t){var r=String.fromCharCode,n="function"==typeof t?t:function(e){setTimeout(e,0)},i=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,o={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},a=/[\x00-\x20<>\\"\{\}\|\^\`]/;function s(e){if(!(this instanceof s))return new s(e);if(e&&e.lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var t=this;this._tokenize=this.tokenize,this.tokenize=function(e,r){this._tokenize(e,function(e,n){!e&&/^(?:IRI|prefixed|literal|langcode|type|\.|eof)$/.test(n.type)?r&&r(e,n):r&&r(e||t._syntaxError(n.type,r=null))})}}}s.prototype={_iri:/^<((?:[^>\\]|\\[uU])+)>/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>/,_unescapedString:/^"[^"\\]+"(?=[^"\\])/,_singleQuotedString:/^"[^"\\]*(?:\\.[^"\\]*)*"(?=[^"\\])|^'[^'\\]*(?:\\.[^'\\]*)*'(?=[^'\\])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?=\.?[,;\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=[.,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;:\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<:])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(e,t){for(var r=this._input;;){for(var n;n=this._newline.exec(r);)r=r.substr(n[0].length,r.length),this._line++;if((n=this._whitespace.exec(r))&&(r=r.substr(n[0].length,r.length)),this._endOfFile.test(r))return t&&e(r=null,{line:this._line,type:"eof",value:"",prefix:""}),this._input=r;var i,o=this._line,s="",u="",c="",l=r[0],h=null,f=0,d=!1;switch(l){case"^":if(1===r.length)break;if("^"!==r[1])return p(this);if(this._prevTokenType="^","<"!==(r=r.substr(2))[0]){d=!0;break}case"<":if(h=this._unescapedIri.exec(r))s="IRI",u=h[1];else if(h=this._iri.exec(r)){if(null===(i=this._unescape(h[1]))||a.test(i))return p(this);s="IRI",u=i}break;case"_":((h=this._blank.exec(r))||t&&(h=this._blank.exec(r+" ")))&&(s="prefixed",c="_",u=h[1]);break;case'"':case"'":if(h=this._unescapedString.exec(r))s="literal",u=h[0];else if(h=this._singleQuotedString.exec(r)){if(null===(i=this._unescape(h[0])))return p(this);s="literal",u=i.replace(/^'|'$/g,'"')}else if(h=this._tripleQuotedString.exec(r)){if(i=h[1]||h[2],this._line+=i.split(/\r\n|\r|\n/).length-1,null===(i=this._unescape(i)))return p(this);s="literal",u=i.replace(/^'|'$/g,'"')}break;case"@":"literal"===this._prevTokenType&&(h=this._langcode.exec(r))?(s="langcode",u=h[1]):(h=this._keyword.exec(r))&&(s=h[0]);break;case".":if(1===r.length?t:r[1]<"0"||r[1]>"9"){s=".",f=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(h=this._number.exec(r))&&(s="literal",u='"'+h[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(h[1]?"double":/^[+\-]?\d+$/.test(h[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(h=this._sparqlKeyword.exec(r))?s=h[0].toUpperCase():d=!0;break;case"f":case"t":(h=this._boolean.exec(r))?(s="literal",u='"'+h[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):d=!0;break;case"a":(h=this._shortPredicates.exec(r))?(s="abbreviation",u="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):d=!0;break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":f=1,s=l;break;default:d=!0}if(d&&("@prefix"!==this._prevTokenType&&"PREFIX"!==this._prevTokenType||!(h=this._prefix.exec(r))?((h=this._prefixed.exec(r))||t&&(h=this._prefixed.exec(r+" ")))&&(s="prefixed",c=h[1]||"",u=this._unescape(h[2])):(s="prefix",u=h[1]||"")),"^"===this._prevTokenType&&(s="IRI"===s||"prefixed"===s?"type":""),!s)return t||!/^'''|^"""/.test(r)&&/\n|\r/.test(r)?p(this):this._input=r;e(null,{line:o,type:s,value:u,prefix:c}),this._prevTokenType=s,r=r.substr(f||h[0].length,r.length)}function p(t){e(t._syntaxError(/^\S*/.exec(r)[0]))}},_unescape:function(e){try{return e.replace(i,function(e,t,n,i){var a;if(t){if(a=parseInt(t,16),isNaN(a))throw new Error;return r(a)}if(n){if(a=parseInt(n,16),isNaN(a))throw new Error;return a<=65535?r(a):r(55296+(a-=65536)/1024,56320+(1023&a))}var s=o[i];if(!s)throw new Error;return s})}catch(e){return null}},_syntaxError:function(e){return this._input=null,new Error('Syntax error: unexpected "'+e+'" on line '+this._line+".")},tokenize:function(e,t){var r=this;function i(e){null!==r._input&&(r._input+=e,r._tokenizeToEnd(t,!1))}function o(){null!==r._input&&r._tokenizeToEnd(t,!0)}this._line=1,"string"==typeof e?(this._input=e,n(function(){r._tokenizeToEnd(t,!0)})):(this._input="",e&&"function"!=typeof e?("function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",i),e.on("end",o)):(this.addChunk=i,this.end=o,t||(t=e)))}},e.exports=s}).call(this,r(23).setImmediate)},function(e,t,r){var n=r(38),i="http://www.w3.org/1999/02/22-rdf-syntax-ns#",o=i+"nil",a=i+"first",s=/^[a-z][a-z0-9+.-]*:/i,u=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,c=/(?:^|\/)\.\.?(?:$|[\/#?])/,l=0,h=0;function f(e){if(!(this instanceof f))return new f(e);this._tripleStack=[],this._graph=null,e=e||{},this._setBase(e.documentIRI);var t="string"==typeof e.format&&e.format.match(/\w*$/)[0].toLowerCase(),r="turtle"===t,i="trig"===t,o=/triple/.test(t),a=/quad/.test(t),s=o||a;(this._supportsNamedGraphs=!r)||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(r||i||o),s&&(this._base="",this._resolveIRI=function(e){return this._error("Disallowed relative IRI",e),this._callback=d,this._subject=null}),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":"_:"+e.blankNodePrefix.replace(/^_:/,""),this._lexer=e.lexer||new n({lineMode:s})}function d(){}f._resetBlankNodeIds=function(){l=h=0},f.prototype={_setBase:function(e){if(e){if(e.indexOf("#")>=0)throw new Error("Invalid base IRI "+e)}else e=null;(this._base=e)&&(this._basePath=e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(u),this._baseRoot=e[0],this._baseScheme=e[1])},_readInTopContext:function(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"@prefix":return this._sparqlStyle=!1,this._readPrefix;case"PREFIX":return this._sparqlStyle=!0,this._readPrefix;case"@base":return this._sparqlStyle=!1,this._readBaseIRI;case"BASE":return this._sparqlStyle=!0,this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}},_readSubject:function(e){switch(this._predicate=null,e.type){case"IRI":null===this._base||s.test(e.value)?this._subject=e.value:this._subject=this._resolveIRI(e);break;case"prefixed":var t=this._prefixes[e.prefix];if(void 0===t)return this._error('Undefined prefix "'+e.prefix+':"',e);this._subject=t+e.value;break;case"[":return this._subject="_:b"+h++,this._tripleStack.push({subject:this._subject,predicate:null,object:null,type:"blank"}),this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:o,predicate:null,object:null,type:"list"}),this._subject=null,this._readListItem;case"}":return this._readPunctuation(e);default:return this._error("Expected subject but got "+e.type,e)}return this._readPredicateOrNamedGraph},_readPredicate:function(e){var t=e.type;switch(t){case"IRI":case"abbreviation":null===this._base||s.test(e.value)?this._predicate=e.value:this._predicate=this._resolveIRI(e);break;case"prefixed":if("_"===e.prefix)return this._error("Disallowed blank node as predicate",e);var r=this._prefixes[e.prefix];if(void 0===r)return this._error('Undefined prefix "'+e.prefix+':"',e);this._predicate=r+e.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+t,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return this._readPredicate;default:return this._error('Expected predicate to follow "'+this._subject+'"',e)}return this._readObject},_readObject:function(e){switch(e.type){case"IRI":null===this._base||s.test(e.value)?this._object=e.value:this._object=this._resolveIRI(e);break;case"prefixed":var t=this._prefixes[e.prefix];if(void 0===t)return this._error('Undefined prefix "'+e.prefix+':"',e);this._object=t+e.value;break;case"literal":return this._object=e.value,this._readDataTypeOrLang;case"[":var r="_:b"+h++;return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:r,type:"blank"}),this._subject=r,this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:o,type:"list"}),this._subject=null,this._readListItem;default:return this._error('Expected object to follow "'+this._predicate+'"',e)}return this._getTripleEndReader()},_readPredicateOrNamedGraph:function(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)},_readGraph:function(e){return"{"!==e.type?this._error("Expected graph but got "+e.type,e):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))},_readBlankNodeTail:function(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""});var t=this._tripleStack.pop();return this._subject=t.subject,null!==t.object?(this._predicate=t.predicate,this._object=t.object,this._getTripleEndReader()):null!==this._predicate?this._readPredicate:this._readPredicateOrNamedGraph},_readDataTypeOrLang:function(e){switch(e.type){case"type":var t;if(""===e.prefix)t=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e);else{var r=this._prefixes[e.prefix];if(void 0===r)return this._error('Undefined prefix "'+e.prefix+':"',e);t=r+e.value}return this._object+="^^"+t,this._getTripleEndReader();case"langcode":return this._object+="@"+e.value.toLowerCase(),this._getTripleEndReader();default:return this._getTripleEndReader().call(this,e)}},_readListItem:function(e){var t=null,r=null,n=this._subject,i=this._tripleStack,u=i[i.length-1],c=this._readListItem;switch(e.type){case"IRI":t=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e);break;case"prefixed":var l=this._prefixes[e.prefix];if(void 0===l)return this._error('Undefined prefix "'+e.prefix+':"',e);t=l+e.value;break;case"literal":t=e.value,c=this._readDataTypeOrLang;break;case"[":r="_:b"+h++,t="_:b"+h++,i.push({subject:r,predicate:a,object:t,type:"blank"}),this._subject=t,c=this._readBlankNodeHead;break;case"(":r="_:b"+h++,i.push({subject:r,predicate:a,object:o,type:"list"}),this._subject=null,c=this._readListItem;break;case")":if(i.pop(),0!==i.length&&"list"===i[i.length-1].type&&this._callback(null,{subject:u.subject,predicate:u.predicate,object:u.object,graph:this._graph||""}),this._subject=u.subject,null===u.predicate){if(c=this._readPredicate,u.subject===o)return c}else if(this._predicate=u.predicate,this._object=u.object,c=this._getTripleEndReader(),u.object===o)return c;r=o;break;default:return this._error('Expected list item instead of "'+e.type+'"',e)}return null===r&&(this._subject=r="_:b"+h++),null===n?u.object===o?u.object=r:u.subject=r:this._callback(null,{subject:n,predicate:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest",object:r,graph:this._graph||""}),null!==t&&this._callback(null,{subject:r,predicate:a,object:t,graph:this._graph||""}),c},_readPunctuation:function(e){var t,r=this._subject,n=this._graph;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);this._graph=null;case".":this._subject=null,t=this._readInTopContext;break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;case"IRI":if(this._supportsQuads&&null===this._graph){n=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e),r=this._subject,t=this._readQuadPunctuation;break}case"prefixed":if(this._supportsQuads&&null===this._graph){var i=this._prefixes[e.prefix];if(void 0===i)return this._error('Undefined prefix "'+e.prefix+':"',e);n=i+e.value,t=this._readQuadPunctuation;break}default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return null!==r&&this._callback(null,{subject:r,predicate:this._predicate,object:this._object,graph:n||""}),t},_readBlankNodePunctuation:function(e){var t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""}),t},_readQuadPunctuation:function(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext},_readPrefix:function(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)},_readPrefixIRI:function(e){return"IRI"!==e.type?this._error('Expected IRI to follow prefix "'+this._prefix+':"',e):(t=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e),this._prefixes[this._prefix]=t,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation);var t},_readBaseIRI:function(e){if("IRI"!==e.type)return this._error("Expected IRI to follow base declaration",e);try{this._setBase(null===this._base||s.test(e.value)?e.value:this._resolveIRI(e))}catch(t){this._error(t.message,e)}return this._readDeclarationPunctuation},_readNamedGraphLabel:function(e){switch(e.type){case"IRI":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}},_readNamedGraphBlankLabel:function(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject="_:b"+h++,this._readGraph)},_readDeclarationPunctuation:function(e){return this._sparqlStyle?this._readInTopContext(e):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext},_getTripleEndReader:function(){var e=this._tripleStack;if(0===e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem}},_error:function(e,t){this._callback(new Error(e+" at line "+t.line+"."))},_resolveIRI:function(e){var t=e.value;switch(t[0]){case void 0:return this._base;case"#":return this._base+t;case"?":return this._base.replace(/(?:\?.*)?$/,t);case"/":return("/"===t[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(t);default:return this._removeDotSegments(this._basePath+t)}},_removeDotSegments:function(e){if(!c.test(e))return e;for(var t="",r=e.length,n=-1,i=-1,o=0,a="/";n<r;){switch(a){case":":if(i<0&&"/"===e[++n]&&"/"===e[++n])for(;(i=n+1)<r&&"/"!==e[i];)n=i;break;case"?":case"#":n=r;break;case"/":if("."===e[n+1])switch(a=e[++n+1]){case"/":t+=e.substring(o,n-1),o=n+1;break;case void 0:case"?":case"#":return t+e.substring(o,n)+e.substr(n+1);case".":if(void 0===(a=e[++n+1])||"/"===a||"?"===a||"#"===a){if((o=(t+=e.substring(o,n-2)).lastIndexOf("/"))>=i&&(t=t.substr(0,o)),"/"!==a)return t+"/"+e.substr(n+1);o=n+1}}}a=e[++n]}return t+e.substring(o)},parse:function(e,t,r){this._readCallback=this._readInTopContext,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+l+++"_","function"==typeof e&&(r=t,t=e,e=null),this._callback=t||d,this._prefixCallback=r||d;var n=this;this._lexer.tokenize(e,function(e,t){null!==e?(n._callback(e),n._callback=d):void 0!==n._readCallback&&(n._readCallback=n._readCallback(t))}),e||(this.addChunk=this._lexer.addChunk,this.end=this._lexer.end)}},e.exports=f},function(e,t){var r={isIRI:function(e){if(!e)return e;var t=e[0];return'"'!==t&&"_"!==t},isLiteral:function(e){return e&&'"'===e[0]},isBlank:function(e){return e&&"_:"===e.substr(0,2)},getLiteralValue:function(e){var t=/^"([^]*)"/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]},getLiteralType:function(e){var t=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]||(t[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")},getLiteralLanguage:function(e){var t=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]?t[1].toLowerCase():""},isPrefixedName:function(e){return e&&/^[^:\/"']*:[^:\/"']+$/.test(e)},expandPrefixedName:function(e,t){var r,n,i,o=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(e);return o&&(n=t[r=o[1]],i=o.index),void 0===n?e:0===i?n+e.substr(r.length+1):e.substr(0,i+3)+n+e.substr(i+r.length+4)},createIRI:function(e){return e&&'"'===e[0]?r.getLiteralValue(e):e},createLiteral:function(e,t){if(!t)switch(typeof e){case"boolean":t="http://www.w3.org/2001/XMLSchema#boolean";break;case"number":if(isFinite(e)){t=e%1==0?"http://www.w3.org/2001/XMLSchema#integer":"http://www.w3.org/2001/XMLSchema#decimal";break}default:return'"'+e+'"'}return'"'+e+(/^[a-z]+(-[a-z0-9]+)*$/i.test(t)?'"@'+t.toLowerCase():'"^^'+t)}};function n(e,t){for(var n in r)t?e.prototype[n]=i(r[n]):e[n]=r[n];return e}function i(e){return function(t){return e(this,t)}}e.exports=n(n)},function(e,t,r){"use strict";var n,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};n=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var u=10;function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function l(e,t,r,n){var i,o,a,s;if("function"!=typeof r)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r);if(void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),a=o[t]),void 0===a)a=o[t]=r,++e._eventsCount;else if("function"==typeof a?a=o[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),(i=c(e))>0&&a.length>i&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,console&&console.warn&&console.warn(s)}return e}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,o(this.listener,this.target,e))}.bind(n);return i.listener=r,n.wrapFn=i,i}function f(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)o(u,this,t);else{var c=u.length,l=p(u,c);for(r=0;r<c;++r)o(l[r],this,t)}return!0},s.prototype.addListener=function(e,t){return l(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return l(this,e,t,!0)},s.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,n,i,o,a;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t,r){(t=e.exports=r(56)).Stream=t,t.Readable=t,t.Writable=r(44),t.Duplex=r(21),t.Transform=r(60),t.PassThrough=r(100)},function(e,t,r){var n=r(25),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(o(n,t),t.Buffer=a),o(i,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t,r){"use strict";(function(t,n,i){var o=r(31);function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=m;var s,u=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?n:o.nextTick;m.WritableState=v;var c=r(28);c.inherits=r(22);var l={deprecate:r(98)},h=r(57),f=r(43).Buffer,d=i.Uint8Array||function(){};var p,g=r(58);function y(){}function v(e,t){s=s||r(21),e=e||{};var n=t instanceof s;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,c=e.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(c||0===c)?c:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var h=!1===e.decodeStrings;this.decodeStrings=!h,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){--t.pendingcb,r?(o.nextTick(i,n),o.nextTick(k,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(i(n),e._writableState.errorEmitted=!0,e.emit("error",n),k(e,t))}(e,r,n,t,i);else{var a=_(r);a||r.corked||r.bufferProcessing||!r.bufferedRequest||x(e,r),n?u(w,e,r,a,i):w(e,r,a,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function m(e){if(s=s||r(21),!(p.call(m,this)||this instanceof s))return new m(e);this._writableState=new v(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),h.call(this)}function b(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function w(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),k(e,t)}function x(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var s=0,u=!0;r;)i[s]=r,r.isBuf||(u=!1),r=r.next,s+=1;i.allBuffers=u,b(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,l=r.encoding,h=r.callback;if(b(e,t,!1,t.objectMode?1:c.length,c,l,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function _(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function T(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),k(e,t)})}function k(e,t){var r=_(t);return r&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,o.nextTick(T,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}c.inherits(m,h),v.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(v.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===m&&(e&&e._writableState instanceof v)}})):p=function(e){return e instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(e,t,r){var n,i=this._writableState,a=!1,s=!i.objectMode&&(n=e,f.isBuffer(n)||n instanceof d);return s&&!f.isBuffer(e)&&(e=function(e){return f.from(e)}(e)),"function"==typeof t&&(r=t,t=null),s?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=y),i.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),o.nextTick(t,r)}(this,r):(s||function(e,t,r,n){var i=!0,a=!1;return null===r?a=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),o.nextTick(n,a),i=!1),i}(this,i,e,r))&&(i.pendingcb++,a=function(e,t,r,n,i,o){if(!r){var a=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=f.from(t,r));return t}(t,n,i);n!==a&&(r=!0,i="buffer",n=a)}var s=t.objectMode?1:n.length;t.length+=s;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else b(e,t,!1,s,n,i,o);return u}(this,i,s,e,t,r)),a},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||x(this,e))},m.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,k(e,t),r&&(t.finished?o.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,n,r)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),m.prototype.destroy=g.destroy,m.prototype._undestroy=g.undestroy,m.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,r(15),r(23).setImmediate,r(18))},function(e,t){var r=/^"([^]*)"(?:\^\^(.+)|@([\-a-z]+))?$/i,n=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,i=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,o={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};function a(e,t){if(!(this instanceof a))return new a(e,t);if(e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{var r="";this._outputStream={write:function(e,t,n){r+=e,n&&n()},end:function(e){e&&e(null,r)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes))}function s(e){var t=o[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}a.prototype={_write:function(e,t){this._outputStream.write(e,"utf8",t)},_writeTriple:function(e,t,r,n,i){try{this._graph!==n&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(n?this._encodeIriOrBlankNode(n)+" {\n":"")),this._subject=null,this._graph="["!==n[0]?n:"]"),this._subject===e?this._predicate===t?this._write(", "+this._encodeObject(r),i):this._write(";\n    "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(r),i):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)+" "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(r),i)}catch(e){i&&i(e)}},_writeTripleLine:function(e,t,r,n,i){delete this._prefixMatch;try{this._write(this._encodeIriOrBlankNode(e)+" "+this._encodeIriOrBlankNode(t)+" "+this._encodeObject(r)+(n?" "+this._encodeIriOrBlankNode(n)+".\n":".\n"),i)}catch(e){i&&i(e)}},_encodeIriOrBlankNode:function(e){var t=e[0];if("["===t||"("===t||"_"===t&&":"===e[1])return e;n.test(e)&&(e=e.replace(i,s));var r=this._prefixRegex.exec(e);return r?r[1]?this._prefixIRIs[r[1]]+r[2]:e:"<"+e+">"},_encodeLiteral:function(e,t,r){return n.test(e)&&(e=e.replace(i,s)),r?'"'+e+'"@'+r:t?'"'+e+'"^^'+this._encodeIriOrBlankNode(t):'"'+e+'"'},_encodeSubject:function(e){if('"'===e[0])throw new Error("A literal as subject is not allowed: "+e);return"["===e[0]&&(this._subject="]"),this._encodeIriOrBlankNode(e)},_encodePredicate:function(e){if('"'===e[0])throw new Error("A literal as predicate is not allowed: "+e);return"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===e?"a":this._encodeIriOrBlankNode(e)},_encodeObject:function(e){if('"'!==e[0])return this._encodeIriOrBlankNode(e);var t=r.exec(e);if(!t)throw new Error("Invalid literal: "+e);return this._encodeLiteral(t[1],t[2],t[3])},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},addTriple:function(e,t,r,n,i){void 0===r?this._writeTriple(e.subject,e.predicate,e.object,e.graph||"",t):"string"!=typeof n?this._writeTriple(e,t,r,"",n):this._writeTriple(e,t,r,n,i)},addTriples:function(e){for(var t=0;t<e.length;t++)this.addTriple(e[t])},addPrefix:function(e,t,r){var n={};n[e]=t,this.addPrefixes(n,r)},addPrefixes:function(e,t){var r=this._prefixIRIs,n=!1;for(var i in e){var o=e[i];/[#\/]$/.test(o)&&r[o]!==(i+=":")&&(n=!0,r[o]=i,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+i+" <"+o+">.\n"))}if(n){var a="",s="";for(var u in r)a+=a?"|"+u:u,s+=(s?"|":"")+r[u];a=a.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+s+")[^/]*$|^("+a+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(n?"\n":"",t)},blank:function(e,t){var r,n,i=e;switch(void 0===e?i=[]:"string"==typeof e?i=[{predicate:e,object:t}]:"length"in e||(i=[e]),n=i.length){case 0:return"[]";case 1:if("["!==(r=i[0]).object[0])return"[ "+this._encodePredicate(r.predicate)+" "+this._encodeObject(r.object)+" ]";default:for(var o="[",a=0;a<n;a++)(r=i[a]).predicate===e?o+=", "+this._encodeObject(r.object):(o+=(a?";\n  ":"\n  ")+this._encodePredicate(r.predicate)+" "+this._encodeObject(r.object),e=r.predicate);return o+"\n]"}},list:function(e){for(var t=e&&e.length||0,r=new Array(t),n=0;n<t;n++)r[n]=this._encodeObject(e[n]);return"("+r.join(" ")+")"},_prefixRegex:/$0^/,end:function(e){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var t=e&&function(r,n){t=null,e(r,n)};if(this._endStream)try{return this._outputStream.end(t)}catch(e){}t&&t()}},e.exports=a},function(e,t,r){e.exports=r(107)},function(e,t,r){"use strict";const n=r(71),i=r(34),o=r(48),a=r(51),s=r(36),u=r(19),c={subject:"s",object:"o",graph:"g"};e.exports=class extends n{constructor(e){super(e=e||{}),this.name="URDNA2015",this.options=Object.assign({},e),this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new i("_:c14n"),this.hashAlgorithm="sha256",this.quads}main(e,t){const r=this;let n;r.schedule.start=Date.now(),r.quads=e;const o={};r.waterfall([t=>{r.forEach(e,(e,t,n)=>{r.forEachComponent(e,t=>{if("BlankNode"!==t.termType)return;const n=t.value;n in r.blankNodeInfo?r.blankNodeInfo[n].quads.push(e):(o[n]=!0,r.blankNodeInfo[n]={quads:[e]})}),n()},t)},e=>{let t=!0;r.whilst(()=>t,e=>{t=!1,r.hashToBlankNodes={},r.waterfall([e=>{r.forEach(o,(e,t,n)=>{r.hashFirstDegreeQuads(t,(e,i)=>{if(e)return n(e);i in r.hashToBlankNodes?r.hashToBlankNodes[i].push(t):r.hashToBlankNodes[i]=[t],n()})},e)},e=>{const n=Object.keys(r.hashToBlankNodes).sort();r.forEach(n,(e,n,i)=>{const a=r.hashToBlankNodes[e];if(a.length>1)return i();const s=a[0];r.canonicalIssuer.getId(s),delete o[s],delete r.hashToBlankNodes[e],t=!0,i()},e)}],e)},e)},e=>{const t=Object.keys(r.hashToBlankNodes).sort();r.forEach(t,(e,t,n)=>{const o=[],a=r.hashToBlankNodes[e];r.waterfall([e=>{r.forEach(a,(e,t,n)=>{if(r.canonicalIssuer.hasId(e))return n();const a=new i("_:b");a.getId(e),r.hashNDegreeQuads(e,a,(e,t)=>{if(e)return n(e);o.push(t),n()})},e)},e=>{o.sort((e,t)=>e.hash<t.hash?-1:e.hash>t.hash?1:0),r.forEach(o,(e,t,n)=>{for(const t in e.issuer.existing)r.canonicalIssuer.getId(t);n()},e)}],n)},e)},e=>{const t=[];r.waterfall([e=>{r.forEach(r.quads,(e,n,i)=>{r.forEachComponent(e,e=>{"BlankNode"!==e.termType||e.value.startsWith(r.canonicalIssuer.prefix)||(e.value=r.canonicalIssuer.getId(e.value))}),t.push(s.serializeQuad(e)),i()},e)},e=>(t.sort(),n=t.join(""),e())],e)}],e=>t(e,n))}hashFirstDegreeQuads(e,t){const r=this,n=r.blankNodeInfo[e];if("hash"in n)return t(null,n.hash);const i=[],a=n.quads;r.forEach(a,(t,n,o)=>{const a={predicate:t.predicate};r.forEachComponent(t,(t,n)=>{a[n]=r.modifyFirstDegreeComponent(e,t,n)}),i.push(s.serializeQuad(a)),o()},e=>{if(e)return t(e);i.sort();const a=new o(r.hashAlgorithm);for(let e=0;e<i.length;++e)a.update(i[e]);n.hash=a.digest(),t(null,n.hash)})}hashRelatedBlankNode(e,t,r,n,i){const a=this;let s;a.waterfall([t=>a.canonicalIssuer.hasId(e)?(s=a.canonicalIssuer.getId(e),t()):r.hasId(e)?(s=r.getId(e),t()):void a.hashFirstDegreeQuads(e,(e,r)=>{if(e)return t(e);s=r,t()})],e=>{if(e)return i(e);const r=new o(a.hashAlgorithm);return r.update(n),"g"!==n&&r.update(a.getRelatedPredicate(t)),r.update(s),i(null,r.digest())})}hashNDegreeQuads(e,t,r){const n=this;let i;const s=new o(n.hashAlgorithm);n.waterfall([r=>n.createHashToRelated(e,t,(e,t)=>{if(e)return r(e);i=t,r()}),e=>{const r=Object.keys(i).sort();n.forEach(r,(e,r,o)=>{s.update(e);let u,c="";const l=new a(i[e]);n.whilst(()=>l.hasNext(),e=>{const r=l.next();let i=t.clone(),o="";const a=[];n.waterfall([t=>{n.forEach(r,(t,r,s)=>{if(n.canonicalIssuer.hasId(t)?o+=n.canonicalIssuer.getId(t):(i.hasId(t)||a.push(t),o+=i.getId(t)),0!==c.length&&o.length>=c.length&&o>c)return e();s()},t)},t=>{n.forEach(a,(t,r,a)=>{n.hashNDegreeQuads(t,i,(r,n)=>r?a(r):(o+=i.getId(t),o+="<"+n.hash+">",i=n.issuer,0!==c.length&&o.length>=c.length&&o>c?e():void a()))},t)},e=>{(0===c.length||o<c)&&(c=o,u=i),e()}],e)},e=>{if(e)return o(e);s.update(c),t=u,o()})},e)}],e=>{r(e,{hash:s.digest(),issuer:t})})}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:((t=u.clone(t)).value=t.value===e?"_:a":"_:z",t)}getRelatedPredicate(e){return"<"+e.predicate.value+">"}createHashToRelated(e,t,r){const n=this,i={},o=n.blankNodeInfo[e].quads;n.forEach(o,(r,o,a)=>{n.forEach(r,(o,a,s)=>{if("predicate"===a||"BlankNode"!==o.termType||o.value===e)return s();const u=o.value,l=c[a];n.hashRelatedBlankNode(u,r,t,l,(e,t)=>{if(e)return s(e);t in i?i[t].push(u):i[t]=[u],s()})},a)},e=>r(e,i))}forEachComponent(e,t){for(const r in e)"predicate"!==r&&t(e[r],r,e)}}},function(e,t,r){"use strict";const n=r(24);r(35),r(72),r(76),e.exports=class{constructor(e){this.md=n.md[e].create()}update(e){this.md.update(e,"utf8")}digest(){return this.md.digest().toHex()}}},function(e,t,r){(function(t,n,i,o){var a=r(24),s=r(75),u=e.exports=a.util=a.util||{};function c(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function l(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(u.isArrayBuffer(e)||u.isArrayBufferView(e))if(void 0!==o&&e instanceof o)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(e){for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof l||"object"==typeof e&&"string"==typeof e.data&&"number"==typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if(void 0!==t&&t.nextTick&&!t.browser)return u.nextTick=t.nextTick,void(u.setImmediate="function"==typeof n?n:u.nextTick);if("function"==typeof n)return u.setImmediate=function(){return n.apply(void 0,arguments)},void(u.nextTick=function(e){return n(e)});if(u.setImmediate=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var e="forge.setImmediate",r=[];u.setImmediate=function(t){r.push(t),1===r.length&&window.postMessage(e,"*")},window.addEventListener("message",function(t){if(t.source===window&&t.data===e){t.stopPropagation();var n=r.slice();r.length=0,n.forEach(function(e){e()})}},!0)}if("undefined"!=typeof MutationObserver){var i=Date.now(),o=!0,a=document.createElement("div");r=[];new MutationObserver(function(){var e=r.slice();r.length=0,e.forEach(function(e){e()})}).observe(a,{attributes:!0});var s=u.setImmediate;u.setImmediate=function(e){Date.now()-i>15?(i=Date.now(),s(e)):(r.push(e),1===r.length&&a.setAttribute("a",o=!o))}}u.nextTick=u.setImmediate}(),u.isNodejs=void 0!==t&&t.versions&&t.versions.node,u.globalScope=u.isNodejs?i:"undefined"==typeof self?window:self,u.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},u.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer},u.isArrayBufferView=function(e){return e&&u.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},u.ByteBuffer=l,u.ByteStringBuffer=l;u.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},u.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},u.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},u.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},u.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},u.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},u.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(u.encodeUtf8(e))},u.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},u.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},u.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},u.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},u.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},u.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},u.ByteStringBuffer.prototype.putInt=function(e,t){c(t);var r="";do{t-=8,r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)},u.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},u.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},u.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},u.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},u.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},u.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},u.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},u.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},u.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},u.ByteStringBuffer.prototype.getInt=function(e){c(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},u.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},u.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},u.ByteStringBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},u.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},u.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},u.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},u.ByteStringBuffer.prototype.copy=function(){var e=u.createBuffer(this.data);return e.read=this.read,e},u.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},u.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},u.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},u.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},u.ByteStringBuffer.prototype.toString=function(){return u.decodeUtf8(this.bytes())},u.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=u.isArrayBuffer(e),n=u.isArrayBufferView(e);if(r||n)return this.data=r?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},u.DataBuffer.prototype.length=function(){return this.write-this.read},u.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},u.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},u.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},u.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this},u.DataBuffer.prototype.putBytes=function(e,t){if(u.isArrayBufferView(e)){var r=(n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-n.byteOffset;return this.accommodate(r),new Uint8Array(this.data.buffer,this.write).set(n),this.write+=r,this}if(u.isArrayBuffer(e)){var n=new Uint8Array(e);return this.accommodate(n.byteLength),new Uint8Array(this.data.buffer).set(n,this.write),this.write+=n.byteLength,this}if(e instanceof u.DataBuffer||"object"==typeof e&&"number"==typeof e.read&&"number"==typeof e.write&&u.isArrayBufferView(e.data)){n=new Uint8Array(e.data.byteLength,e.read,e.length());return this.accommodate(n.byteLength),new Uint8Array(e.data.byteLength,this.write).set(n),this.write+=n.byteLength,this}if(e instanceof u.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"==typeof e){var i;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.hex.decode(e,i,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),i=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.base64.decode(e,i,this.write),this;if("utf8"===t&&(e=u.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.raw.decode(i),this;if("utf16"===t)return this.accommodate(2*e.length),i=new Uint16Array(this.data.buffer,this.write),this.write+=u.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},u.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},u.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},u.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},u.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},u.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},u.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},u.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},u.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},u.DataBuffer.prototype.putInt=function(e,t){c(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},u.DataBuffer.prototype.putSignedInt=function(e,t){return c(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},u.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},u.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},u.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},u.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},u.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},u.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},u.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},u.DataBuffer.prototype.getInt=function(e){c(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},u.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},u.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},u.DataBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},u.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},u.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},u.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},u.DataBuffer.prototype.copy=function(){return new u.DataBuffer(this)},u.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},u.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},u.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},u.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e},u.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return u.binary.raw.encode(t);if("hex"===e)return u.binary.hex.encode(t);if("base64"===e)return u.binary.base64.encode(t);if("utf8"===e)return u.text.utf8.decode(t);if("utf16"===e)return u.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},u.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=u.encodeUtf8(e)),new u.ByteBuffer(e)},u.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return r},u.xorBytes=function(e,t,r){for(var n="",i="",o="",a=0,s=0;r>0;--r,++a)i=e.charCodeAt(a)^t.charCodeAt(a),s>=10&&(n+=o,o="",s=0),o+=String.fromCharCode(i),++s;return n+=o},u.hexToBytes=function(e){var t="",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},u.bytesToHex=function(e){return u.createBuffer(e).toHex()},u.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],d="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";u.encode64=function(e,t){for(var r,n,i,o="",a="",s=0;s<e.length;)r=e.charCodeAt(s++),n=e.charCodeAt(s++),i=e.charCodeAt(s++),o+=h.charAt(r>>2),o+=h.charAt((3&r)<<4|n>>4),isNaN(n)?o+="==":(o+=h.charAt((15&n)<<2|i>>6),o+=isNaN(i)?"=":h.charAt(63&i)),t&&o.length>t&&(a+=o.substr(0,t)+"\r\n",o=o.substr(t));return a+=o},u.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,i,o="",a=0;a<e.length;)t=f[e.charCodeAt(a++)-43],r=f[e.charCodeAt(a++)-43],n=f[e.charCodeAt(a++)-43],i=f[e.charCodeAt(a++)-43],o+=String.fromCharCode(t<<2|r>>4),64!==n&&(o+=String.fromCharCode((15&r)<<4|n>>2),64!==i&&(o+=String.fromCharCode((3&n)<<6|i)));return o},u.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},u.decodeUtf8=function(e){return decodeURIComponent(escape(e))},u.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:s.encode,decode:s.decode}},u.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},u.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,o=0;o<e.length;++o)n[i++]=e.charCodeAt(o);return t?i-r:n},u.binary.hex.encode=u.bytesToHex,u.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2)));var i=0,o=r=r||0;for(1&e.length&&(i=1,n[o++]=parseInt(e[0],16));i<e.length;i+=2)n[o++]=parseInt(e.substr(i,2),16);return t?o-r:n},u.binary.base64.encode=function(e,t){for(var r,n,i,o="",a="",s=0;s<e.byteLength;)r=e[s++],n=e[s++],i=e[s++],o+=h.charAt(r>>2),o+=h.charAt((3&r)<<4|n>>4),isNaN(n)?o+="==":(o+=h.charAt((15&n)<<2|i>>6),o+=isNaN(i)?"=":h.charAt(63&i)),t&&o.length>t&&(a+=o.substr(0,t)+"\r\n",o=o.substr(t));return a+=o},u.binary.base64.decode=function(e,t,r){var n,i,o,a,s=t;s||(s=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var u=0,c=r=r||0;u<e.length;)n=f[e.charCodeAt(u++)-43],i=f[e.charCodeAt(u++)-43],o=f[e.charCodeAt(u++)-43],a=f[e.charCodeAt(u++)-43],s[c++]=n<<2|i>>4,64!==o&&(s[c++]=(15&i)<<4|o>>2,64!==a&&(s[c++]=(3&o)<<6|a));return t?c-r:s.subarray(0,c)},u.binary.base58.encode=function(e,t){return u.binary.baseN.encode(e,d,t)},u.binary.base58.decode=function(e,t){return u.binary.baseN.decode(e,d,t)},u.text={utf8:{},utf16:{}},u.text.utf8.encode=function(e,t,r){e=u.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,o=0;o<e.length;++o)n[i++]=e.charCodeAt(o);return t?i-r:n},u.text.utf8.decode=function(e){return u.decodeUtf8(String.fromCharCode.apply(null,e))},u.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));for(var i=new Uint16Array(n.buffer),o=r=r||0,a=r,s=0;s<e.length;++s)i[a++]=e.charCodeAt(s),o+=2;return t?o-r:n},u.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},u.deflate=function(e,t,r){if(t=u.decode64(e.deflate(u.encode64(t)).rval),r){var n=2;32&t.charCodeAt(1)&&(n=6),t=t.substring(n,t.length-4)}return t},u.inflate=function(e,t,r){var n=e.inflate(u.encode64(t)).rval;return null===n?null:u.decode64(n)};var p=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(null===r?n=e.removeItem(t):(r=u.encode64(JSON.stringify(r)),n=e.setItem(t,r)),void 0!==n&&!0!==n.rval){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},g=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(u.decode64(r))),r},y=function(e,t,r,n){var i=g(e,t);null===i&&(i={}),i[r]=n,p(e,t,i)},v=function(e,t,r){var n=g(e,t);return null!==n&&(n=r in n?n[r]:null),n},m=function(e,t,r){var n=g(e,t);if(null!==n&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),p(e,t,n)}},b=function(e,t){p(e,t,null)},w=function(e,t,r){var n,i=null;void 0===r&&(r=["web","flash"]);var o=!1,a=null;for(var s in r){n=r[s];try{if("flash"===n||"both"===n){if(null===t[0])throw new Error("Flash local storage not available.");i=e.apply(this,t),o="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,i=e.apply(this,t),o=!0)}catch(e){a=e}if(o)break}if(!o)throw a;return i};u.setItem=function(e,t,r,n,i){w(y,arguments,i)},u.getItem=function(e,t,r,n){return w(v,arguments,n)},u.removeItem=function(e,t,r,n){w(m,arguments,n)},u.clearItems=function(e,t,r){w(b,arguments,r)},u.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e),n=null===r?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?80!==n.port&&"http"===n.scheme?n.fullHost+=":"+n.port:443!==n.port&&"https"===n.scheme&&(n.fullHost+=":"+n.port):"http"===n.scheme?n.port=80:"https"===n.scheme&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var x=null;u.getQueryVariables=function(e){var t,r=function(e){for(var t={},r=e.split("&"),n=0;n<r.length;n++){var i,o,a=r[n].indexOf("=");a>0?(i=r[n].substring(0,a),o=r[n].substring(a+1)):(i=r[n],o=null),i in t||(t[i]=[]),i in Object.prototype||null===o||t[i].push(unescape(o))}return t};return void 0===e?(null===x&&(x="undefined"!=typeof window&&window.location&&window.location.search?r(window.location.search.substring(1)):{}),t=x):t=r(e),t},u.parseFragment=function(e){var t=e,r="",n=e.indexOf("?");n>0&&(t=e.substring(0,n),r=e.substring(n+1));var i=t.split("/");return i.length>0&&""===i[0]&&i.shift(),{pathString:t,queryString:r,path:i,query:""===r?{}:u.getQueryVariables(r)}},u.makeRequest=function(e){var t=u.parseFragment(e),r={path:t.pathString,query:t.queryString,getPath:function(e){return void 0===e?t.path:t.path[e]},getQuery:function(e,r){var n;return void 0===e?n=t.query:(n=t.query[e])&&void 0!==r&&(n=n[r]),n},getQueryLast:function(e,t){var n=r.getQuery(e);return n?n[n.length-1]:t}};return r},u.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var n=jQuery.param(t||{});return r=r||"",e+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")},u.setPath=function(e,t,r){if("object"==typeof e&&null!==e)for(var n=0,i=t.length;n<i;){var o=t[n++];if(n==i)e[o]=r;else{var a=o in e;(!a||a&&"object"!=typeof e[o]||a&&null===e[o])&&(e[o]={}),e=e[o]}}},u.getPath=function(e,t,r){for(var n=0,i=t.length,o=!0;o&&n<i&&"object"==typeof e&&null!==e;){var a=t[n++];(o=a in e)&&(e=e[a])}return o?e:r},u.deletePath=function(e,t){if("object"==typeof e&&null!==e)for(var r=0,n=t.length;r<n;){var i=t[r++];if(r==n)delete e[i];else{if(!(i in e)||"object"!=typeof e[i]||null===e[i])break;e=e[i]}}},u.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},u.format=function(e){for(var t,r,n=/%./g,i=0,o=[],a=0;t=n.exec(e);){(r=e.substring(a,n.lastIndex-2)).length>0&&o.push(r),a=n.lastIndex;var s=t[0][1];switch(s){case"s":case"o":i<arguments.length?o.push(arguments[1+i++]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+s+"?>")}}return o.push(e.substring(a)),o.join("")},u.formatNumber=function(e,t,r,n){var i=e,o=isNaN(t=Math.abs(t))?2:t,a=void 0===r?",":r,s=void 0===n?".":n,u=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",l=c.length>3?c.length%3:0;return u+(l?c.substr(0,l)+s:"")+c.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+s)+(o?a+Math.abs(i-c).toFixed(o).slice(2):"")},u.formatSize=function(e){return e=e>=1073741824?u.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?u.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?u.formatNumber(e/1024,0)+" KiB":u.formatNumber(e,0)+" bytes"},u.bytesFromIP=function(e){return-1!==e.indexOf(".")?u.bytesFromIPv4(e):-1!==e.indexOf(":")?u.bytesFromIPv6(e):null},u.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=u.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()},u.bytesFromIPv6=function(e){for(var t=0,r=2*(8-(e=e.split(":").filter(function(e){return 0===e.length&&++t,!0})).length+t),n=u.createBuffer(),i=0;i<8;++i)if(e[i]&&0!==e[i].length){var o=u.hexToBytes(e[i]);o.length<2&&n.putByte(0),n.putBytes(o)}else n.fillWithByte(0,r),r=0;return n.getBytes()},u.bytesToIP=function(e){return 4===e.length?u.bytesToIPv4(e):16===e.length?u.bytesToIPv6(e):null},u.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},u.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var o=u.bytesToHex(e[i]+e[i+1]);"0"===o[0]&&"0"!==o;)o=o.substr(1);if("0"===o){var a=r[r.length-1],s=t.length;a&&s===a.end+1?(a.end=s,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:s,end:s})}t.push(o)}if(r.length>0){var c=r[n];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),0===c.start&&t.unshift(""),7===c.end&&t.push(""))}return t.join(":")},u.estimateCores=function(e,t){if("function"==typeof e&&(t=e,e={}),e=e||{},"cores"in u&&!e.update)return t(null,u.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return u.cores=navigator.hardwareConcurrency,t(null,u.cores);if("undefined"==typeof Worker)return u.cores=1,t(null,u.cores);if("undefined"==typeof Blob)return u.cores=2,t(null,u.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})})}.toString(),")()"],{type:"application/javascript"}));!function e(n,i,o){if(0===i){var a=Math.floor(n.reduce(function(e,t){return e+t},0)/n.length);return u.cores=Math.max(1,a),URL.revokeObjectURL(r),t(null,u.cores)}!function(e,t){for(var n=[],i=[],o=0;o<e;++o){var a=new Worker(r);a.addEventListener("message",function(r){if(i.push(r.data),i.length===e){for(var o=0;o<e;++o)n[o].terminate();t(null,i)}}),n.push(a)}for(o=0;o<e;++o)n[o].postMessage(o)}(o,function(t,r){n.push(function(e,t){for(var r=[],n=0;n<e;++n)for(var i=t[n],o=r[n]=[],a=0;a<e;++a)if(n!==a){var s=t[a];(i.st>s.st&&i.st<s.et||s.st>i.st&&s.st<i.et)&&o.push(a)}return r.reduce(function(e,t){return Math.max(e,t.length)},0)}(o,r)),e(n,i-1,o)})}([],5,16)}}).call(this,r(15),r(23).setImmediate,r(18),r(25).Buffer)},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";e.exports=class{constructor(e){this.list=e.sort(),this.done=!1,this.left={};for(let t=0;t<e.length;++t)this.left[e[t]]=!0}hasNext(){return!this.done}next(){const e=this.list.slice();let t=null,r=0;const n=this.list.length;for(let e=0;e<n;++e){const i=this.list[e],o=this.left[i];(null===t||i>t)&&(o&&e>0&&i>this.list[e-1]||!o&&e<n-1&&i>this.list[e+1])&&(t=i,r=e)}if(null===t)this.done=!0;else{const e=this.left[t]?r-1:r+1;this.list[r]=this.list[e],this.list[e]=t;for(let e=0;e<n;++e)this.list[e]>t&&(this.left[this.list[e]]=!this.left[this.list[e]])}return e}}},function(e,t,r){"use strict";const n=r(34),i=r(48),o=r(51),a=r(36),s=r(19),u={subject:"s",object:"o",graph:"g"};e.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new n("_:c14n"),this.hashAlgorithm="sha256",this.quads}main(e){const t=this;t.quads=e;const r={};for(const n of e)t.forEachComponent(n,e=>{if("BlankNode"!==e.termType)return;const i=e.value;i in t.blankNodeInfo?t.blankNodeInfo[i].quads.push(n):(r[i]=!0,t.blankNodeInfo[i]={quads:[n]})});let i=!0;for(;i;){i=!1,t.hashToBlankNodes={};for(const e in r){const r=t.hashFirstDegreeQuads(e);r in t.hashToBlankNodes?t.hashToBlankNodes[r].push(e):t.hashToBlankNodes[r]=[e]}const e=Object.keys(t.hashToBlankNodes).sort();for(let n=0;n<e.length;++n){const o=e[n],a=t.hashToBlankNodes[o];if(a.length>1)continue;const s=a[0];t.canonicalIssuer.getId(s),delete r[s],delete t.hashToBlankNodes[o],i=!0}}const o=Object.keys(t.hashToBlankNodes).sort();for(let e=0;e<o.length;++e){const r=[],i=o[e],a=t.hashToBlankNodes[i];for(let e=0;e<a.length;++e){const i=a[e];if(t.canonicalIssuer.hasId(i))continue;const o=new n("_:b");o.getId(i);const s=t.hashNDegreeQuads(i,o);r.push(s)}r.sort((e,t)=>e.hash<t.hash?-1:e.hash>t.hash?1:0);for(let e=0;e<r.length;++e){const n=r[e];for(const e in n.issuer.existing)t.canonicalIssuer.getId(e)}}const s=[];for(let e=0;e<t.quads.length;++e){const r=t.quads[e];t.forEachComponent(r,e=>{"BlankNode"!==e.termType||e.value.startsWith(t.canonicalIssuer.prefix)||(e.value=t.canonicalIssuer.getId(e.value))}),s.push(a.serializeQuad(r))}return s.sort(),s.join("")}hashFirstDegreeQuads(e){const t=this,r=t.blankNodeInfo[e];if("hash"in r)return r.hash;const n=[],o=r.quads;for(let r=0;r<o.length;++r){const i=o[r],s={predicate:i.predicate};t.forEachComponent(i,(r,n)=>{s[n]=t.modifyFirstDegreeComponent(e,r,n)}),n.push(a.serializeQuad(s))}n.sort();const s=new i(t.hashAlgorithm);for(let e=0;e<n.length;++e)s.update(n[e]);return r.hash=s.digest(),r.hash}hashRelatedBlankNode(e,t,r,n){const o=this;let a;a=o.canonicalIssuer.hasId(e)?o.canonicalIssuer.getId(e):r.hasId(e)?r.getId(e):o.hashFirstDegreeQuads(e);const s=new i(o.hashAlgorithm);return s.update(n),"g"!==n&&s.update(o.getRelatedPredicate(t)),s.update(a),s.digest()}hashNDegreeQuads(e,t){const r=this,n=new i(r.hashAlgorithm),a=r.createHashToRelated(e,t),s=Object.keys(a).sort();for(let e=0;e<s.length;++e){const i=s[e];n.update(i);let u,c="";const l=new o(a[i]);for(;l.hasNext();){const e=l.next();let n=t.clone(),i="";const o=[];let a=!1;for(let t=0;t<e.length;++t){const s=e[t];if(r.canonicalIssuer.hasId(s)?i+=r.canonicalIssuer.getId(s):(n.hasId(s)||o.push(s),i+=n.getId(s)),0!==c.length&&i.length>=c.length&&i>c){a=!0;break}}if(!a){for(let e=0;e<o.length;++e){const t=o[e],s=r.hashNDegreeQuads(t,n);if(i+=n.getId(t),i+="<"+s.hash+">",n=s.issuer,0!==c.length&&i.length>=c.length&&i>c){a=!0;break}}a||(0===c.length||i<c)&&(c=i,u=n)}}n.update(c),t=u}return{hash:n.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:((t=s.clone(t)).value=t.value===e?"_:a":"_:z",t)}getRelatedPredicate(e){return"<"+e.predicate.value+">"}createHashToRelated(e,t){const r=this,n={},i=r.blankNodeInfo[e].quads;for(let o=0;o<i.length;++o){const a=i[o];for(const i in a){const o=a[i];if("predicate"===i||"BlankNode"!==o.termType||o.value===e)continue;const s=o.value,c=u[i],l=r.hashRelatedBlankNode(s,a,t,c);l in n?n[l].push(s):n[l]=[s]}}return n}forEachComponent(e,t){for(const r in e)"predicate"!==r&&t(e[r],r,e)}}},function(e,t,r){var n=r(40).expandPrefixedName;function i(e,t){if(!(this instanceof i))return new i(e,t);this._size=0,this._graphs=Object.create(null),this._entities=Object.create(null),this._entities["><"]=0,this._entityCount=0,this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),this._prefixes=Object.create(null),t&&t.prefixes&&this.addPrefixes(t.prefixes),e&&this.addTriples(e)}i.prototype={get size(){var e=this._size;if(null!==e)return e;var t,r,n=this._graphs;for(var i in n)for(var o in t=n[i].subjects)for(var a in r=t[o])e+=Object.keys(r[a]).length;return this._size=e},_addToIndex:function(e,t,r,n){var i=e[t]||(e[t]={});(i[r]||(i[r]={}))[n]=null},_removeFromIndex:function(e,t,r,n){var i,o=e[t],a=o[r];for(i in delete a[n],a)return;for(i in delete o[r],o)return;delete e[t]},_findInIndex:function(e,t,r,n,i,o,a,s){var u,c,l,h=[],f=Object.keys(this._entities);for(var d in t&&((u=e,e={})[t]=u[t]),e){var p=f[d];if(c=e[d])for(var g in r&&((u=c,c={})[r]=u[r]),c){var y=f[g];if(l=c[g])for(var v=(n?n in l?[n]:[]:Object.keys(l)),m=v.length-1;m>=0;m--){var b={subject:"",predicate:"",object:"",graph:s};b[i]=p,b[o]=y,b[a]=f[v[m]],h.push(b)}}}return h},_countInIndex:function(e,t,r,n){var i,o,a,s=0;for(var u in t&&((i=e,e={})[t]=i[t]),e)if(o=e[u])for(var c in r&&((i=o,o={})[r]=i[r]),o)(a=o[c])&&(n?n in a&&s++:s+=Object.keys(a).length);return s},addTriple:function(e,t,r,n){t||(n=e.graph,r=e.object,t=e.predicate,e=e.subject),n=n||"";var i=this._graphs[n];i||(i=this._graphs[n]={subjects:{},predicates:{},objects:{}},Object.freeze(i));var o=this._entities;e=o[e]||(o[e]=++this._entityCount),t=o[t]||(o[t]=++this._entityCount),r=o[r]||(o[r]=++this._entityCount),this._addToIndex(i.subjects,e,t,r),this._addToIndex(i.predicates,t,r,e),this._addToIndex(i.objects,r,e,t),this._size=null},addTriples:function(e){for(var t=e.length-1;t>=0;t--)this.addTriple(e[t])},addPrefix:function(e,t){this._prefixes[e]=t},addPrefixes:function(e){for(var t in e)this.addPrefix(t,e[t])},removeTriple:function(e,t,r,n){t||(n=e.graph,r=e.object,t=e.predicate,e=e.subject),n=n||"";var i,o,a,s=this._entities,u=this._graphs;if((e=s[e])&&((t=s[t])&&(r=s[r])&&(i=u[n])&&(o=i.subjects[e])&&(a=o[t])&&r in a)){for(e in this._removeFromIndex(i.subjects,e,t,r),this._removeFromIndex(i.predicates,t,r,e),this._removeFromIndex(i.objects,r,e,t),null!==this._size&&this._size--,i.subjects)return;delete u[n]}},removeTriples:function(e){for(var t=e.length-1;t>=0;t--)this.removeTriple(e[t])},find:function(e,t,r,i){var o=this._prefixes;return this.findByIRI(n(e,o),n(t,o),n(r,o),n(i,o))},findByIRI:function(e,t,r,n){n=n||"";var i=this._graphs[n],o=this._entities;return i?e&&!(e=o[e])?[]:t&&!(t=o[t])?[]:r&&!(r=o[r])?[]:e?r?this._findInIndex(i.objects,r,e,t,"object","subject","predicate",n):this._findInIndex(i.subjects,e,t,null,"subject","predicate","object",n):t?this._findInIndex(i.predicates,t,r,null,"predicate","object","subject",n):r?this._findInIndex(i.objects,r,null,null,"object","subject","predicate",n):this._findInIndex(i.subjects,null,null,null,"subject","predicate","object",n):[]},count:function(e,t,r,i){var o=this._prefixes;return this.countByIRI(n(e,o),n(t,o),n(r,o),n(i,o))},countByIRI:function(e,t,r,n){n=n||"";var i=this._graphs[n],o=this._entities;return i?e&&!(e=o[e])?0:t&&!(t=o[t])?0:r&&!(r=o[r])?0:e?r?this._countInIndex(i.objects,r,e,t):this._countInIndex(i.subjects,e,t,r):t?this._countInIndex(i.predicates,t,r,e):this._countInIndex(i.objects,r,e,t):0},createBlankNode:function(e){var t,r;if(e)for(t=e="_:"+e,r=1;this._entities[t];)t=e+r++;else do{t="_:b"+this._blankNodeIndex++}while(this._entities[t]);return this._entities[t]=++this._entityCount,t}},e.exports=i},function(e,t,r){var n=r(55).Transform,i=r(61),o=r(39);function a(e){if(!(this instanceof a))return new a(e);n.call(this,{decodeStrings:!0}),this._readableState.objectMode=!0;var t=this,r=new o(e);r.parse(function(e,r){r&&t.push(r)||e&&t.emit("error",e)},this.emit.bind(this,"prefix")),this._transform=function(e,t,n){r.addChunk(e),n()},this._flush=function(e){r.end(),e()}}i.inherits(a,n),e.exports=a},function(e,t,r){e.exports=i;var n=r(41).EventEmitter;function i(){n.call(this)}r(22)(i,n),i.Readable=r(42),i.Writable=r(101),i.Duplex=r(102),i.Transform=r(103),i.PassThrough=r(104),i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function o(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(r.on("end",s),r.on("close",u));var a=!1;function s(){a||(a=!0,e.end())}function u(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(l(),0===n.listenerCount(this,"error"))throw e}function l(){r.removeListener("data",i),e.removeListener("drain",o),r.removeListener("end",s),r.removeListener("close",u),r.removeListener("error",c),e.removeListener("error",c),r.removeListener("end",l),r.removeListener("close",l),e.removeListener("close",l)}return r.on("error",c),e.on("error",c),r.on("end",l),r.on("close",l),e.on("close",l),e.emit("pipe",r),e}},function(e,t,r){"use strict";(function(t,n){var i=r(31);e.exports=b;var o,a=r(50);b.ReadableState=m;r(41).EventEmitter;var s=function(e,t){return e.listeners(t).length},u=r(57),c=r(43).Buffer,l=t.Uint8Array||function(){};var h=r(28);h.inherits=r(22);var f=r(95),d=void 0;d=f&&f.debuglog?f.debuglog("stream"):function(){};var p,g=r(96),y=r(58);h.inherits(b,u);var v=["error","close","destroy","pause","resume"];function m(e,t){e=e||{};var n=t instanceof(o=o||r(21));this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,a=e.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=r(59).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function b(e){if(o=o||r(21),!(this instanceof b))return new b(e);this._readableState=new m(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),u.call(this)}function w(e,t,r,n,i){var o,a=e._readableState;null===t?(a.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,k(e)}(e,a)):(i||(o=function(e,t){var r;n=t,c.isBuffer(n)||n instanceof l||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(a,t)),o?e.emit("error",o):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),n?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):x(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!r?(t=a.decoder.write(t),a.objectMode||0!==t.length?x(e,a,t,!1):I(e,a)):x(e,a,t,!1))):n||(a.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(a)}function x(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&k(e)),I(e,t)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),b.prototype.destroy=y.destroy,b.prototype._undestroy=y.undestroy,b.prototype._destroy=function(e,t){this.push(null),t(e)},b.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),w(this,e,t,!1,r)},b.prototype.unshift=function(e){return w(this,e,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(e){return p||(p=r(59).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};var _=8388608;function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=_?e=_:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function k(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(d("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(S,e):S(e))}function S(e){d("emit readable"),e.emit("readable"),O(e)}function I(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(N,e,t))}function N(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(d("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function j(e){d("readable nexttick read 0"),e.read(0)}function E(e,t){t.reading||(d("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),O(e),t.flowing&&!t.reading&&e.read(0)}function O(e){var t=e._readableState;for(d("flow",t.flowing);t.flowing&&null!==e.read(););}function C(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=c.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,a),0===(e-=a)){a===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function R(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(A,t,e))}function A(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function L(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}b.prototype.read=function(e){d("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return d("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?R(this):k(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&R(this),null;var n,i=t.needReadable;return d("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&d("length less than watermark",i=!0),t.ended||t.reading?d("reading or ended",i=!1):i&&(d("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(r,t))),null===(n=e>0?C(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&R(this)),null!==n&&this.emit("data",n),n},b.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(e,t){var r=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,d("pipe count=%d opts=%j",o.pipesCount,t);var u=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?l:b;function c(t,n){d("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,d("cleanup"),e.removeListener("close",v),e.removeListener("finish",m),e.removeListener("drain",h),e.removeListener("error",y),e.removeListener("unpipe",c),r.removeListener("end",l),r.removeListener("end",b),r.removeListener("data",g),f=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||h())}function l(){d("onend"),e.end()}o.endEmitted?i.nextTick(u):r.once("end",u),e.on("unpipe",c);var h=function(e){return function(){var t=e._readableState;d("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,O(e))}}(r);e.on("drain",h);var f=!1;var p=!1;function g(t){d("ondata"),p=!1,!1!==e.write(t)||p||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==L(o.pipes,e))&&!f&&(d("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,p=!0),r.pause())}function y(t){d("onerror",t),b(),e.removeListener("error",y),0===s(e,"error")&&e.emit("error",t)}function v(){e.removeListener("finish",m),b()}function m(){d("onfinish"),e.removeListener("close",v),b()}function b(){d("unpipe"),r.unpipe(e)}return r.on("data",g),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?a(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",y),e.once("close",v),e.once("finish",m),e.emit("pipe",r),o.flowing||(d("pipe resume"),r.resume()),e},b.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,r);return this}var a=L(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},b.prototype.on=function(e,t){var r=u.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&k(this):i.nextTick(j,this))}return r},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var e=this._readableState;return e.flowing||(d("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(E,e,t))}(this,e)),this},b.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",function(){if(d("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){(d("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i)||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<v.length;o++)e.on(v[o],this.emit.bind(this,v[o]));return this._read=function(t){d("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=C}).call(this,r(18),r(15))},function(e,t,r){e.exports=r(41).EventEmitter},function(e,t,r){"use strict";var n=r(31);function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||n.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(n.nextTick(i,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,r){"use strict";var n=r(99).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=f,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function l(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},o.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=a(t[n]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--n<r||-2===i)return 0;if((i=a(t[n]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--n<r||-2===i)return 0;if((i=a(t[n]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,r){"use strict";e.exports=a;var n=r(21),i=r(28);function o(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function a(e){if(!(this instanceof a))return new a(e);n.call(this,e),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush(function(t,r){u(e,t,r)}):u(this,null,null)}function u(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=r(22),i.inherits(a,n),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},a.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},a.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,function(e){t(e),r.emit("close")})}},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},i=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,a=String(e).replace(i,function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),u=n[r];r<o;u=n[++r])g(u)||!w(u)?a+=" "+u:a+=" "+s(u);return a},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),i=!0}return r.apply(this,arguments)}};var o,a={};function s(e,r){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),p(r)?n.showHidden=r:r&&t._extend(n,r),m(n.showHidden)&&(n.showHidden=!1),m(n.depth)&&(n.depth=2),m(n.colors)&&(n.colors=!1),m(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),l(n,e,n.depth)}function u(e,t){var r=s.styles[t];return r?"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m":e}function c(e,t){return e}function l(e,r,n){if(e.customInspect&&r&&T(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,e);return v(i)||(i=l(e,i,n)),i}var o=function(e,t){if(m(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(y(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(g(t))return e.stylize("null","null")}(e,r);if(o)return o;var a=Object.keys(r),s=function(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(r)),_(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(r);if(0===a.length){if(T(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(b(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(x(r))return e.stylize(Date.prototype.toString.call(r),"date");if(_(r))return h(r)}var c,w="",k=!1,S=["{","}"];(d(r)&&(k=!0,S=["[","]"]),T(r))&&(w=" [Function"+(r.name?": "+r.name:"")+"]");return b(r)&&(w=" "+RegExp.prototype.toString.call(r)),x(r)&&(w=" "+Date.prototype.toUTCString.call(r)),_(r)&&(w=" "+h(r)),0!==a.length||k&&0!=r.length?n<0?b(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),c=k?function(e,t,r,n,i){for(var o=[],a=0,s=t.length;a<s;++a)j(t,String(a))?o.push(f(e,t,r,n,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(f(e,t,r,n,i,!0))}),o}(e,r,n,s,a):a.map(function(t){return f(e,r,n,s,t,k)}),e.seen.pop(),function(e,t,r){if(e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(c,w,S)):S[0]+w+S[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,r,n,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),j(n,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=g(r)?l(e,u.value,null):l(e,u.value,r-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),m(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function d(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function g(e){return null===e}function y(e){return"number"==typeof e}function v(e){return"string"==typeof e}function m(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===k(e)}function w(e){return"object"==typeof e&&null!==e}function x(e){return w(e)&&"[object Date]"===k(e)}function _(e){return w(e)&&("[object Error]"===k(e)||e instanceof Error)}function T(e){return"function"==typeof e}function k(e){return Object.prototype.toString.call(e)}function S(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(m(o)&&(o=e.env.NODE_DEBUG||""),r=r.toUpperCase(),!a[r])if(new RegExp("\\b"+r+"\\b","i").test(o)){var n=e.pid;a[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else a[r]=function(){};return a[r]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=p,t.isNull=g,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=m,t.isRegExp=b,t.isObject=w,t.isDate=x,t.isError=_,t.isFunction=T,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(105);var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function N(){var e=new Date,t=[S(e.getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":");return[e.getDate(),I[e.getMonth()],t].join(" ")}function j(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",N(),t.format.apply(t,arguments))},t.inherits=r(106),t._extend=function(e,t){if(!t||!w(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var E="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(E&&e[E]){var t;if("function"!=typeof(t=e[E]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,E,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise(function(e,n){t=e,r=n}),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push(function(e,n){e?r(e):t(n)});try{e.apply(this,i)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),E&&Object.defineProperty(t,E,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=E,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var i=r.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};t.apply(this,r).then(function(t){e.nextTick(a,null,t)},function(t){e.nextTick(O,t,a)})}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(this,r(15))},function(e,t,r){var n=r(55).Transform,i=r(61),o=r(45);function a(e){if(!(this instanceof a))return new a(e);n.call(this,{encoding:"utf8"}),this._writableState.objectMode=!0;var t=this,r=new o({write:function(e,r,n){t.push(e),n&&n()},end:function(e){t.push(null),e&&e()}},e);this._transform=function(e,t,n){r.addTriple(e,n)},this._flush=function(e){r.end(e)}}i.inherits(a,n),e.exports=a},function(e,t){function r(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,u,"next",e)}function u(e){r(a,i,o,s,u,"throw",e)}s(void 0)})}}},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t,r){e.exports=r(108)},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(t,n)}e.exports=r},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var n,i,o,a,s,u=1,c={},l=!1,h=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick(function(){p(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){p(e.data)},n=function(e){o.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(i=h.documentElement,n=function(e){var t=h.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):n=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(t){e.postMessage(a+t,"*")}),f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var i={callback:e,args:t};return c[u]=i,n(u),u++},f.clearImmediate=d}function d(e){delete c[e]}function p(e){if(l)setTimeout(p,0,e);else{var t=c[e];if(t){l=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n)}}(t)}finally{d(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,r(18),r(15))},function(e,t,r){"use strict";const n=r(19);e.exports=class{constructor({maxCallStackDepth:e=500,maxTotalCallStackDepth:t=4294967295,timeSlice:r=10}={}){this.schedule={},this.schedule.MAX_DEPTH=e,this.schedule.MAX_TOTAL_DEPTH=t,this.schedule.depth=0,this.schedule.totalDepth=0,this.schedule.timeSlice=r}doWork(e,t){const r=this.schedule;if(r.totalDepth>=r.MAX_TOTAL_DEPTH)return t(new Error("Maximum total call stack depth exceeded; canonicalization aborting."));!function i(){if(r.depth===r.MAX_DEPTH)return r.depth=0,r.running=!1,n.nextTick(i);const o=Date.now();if(r.running||(r.start=Date.now(),r.deadline=r.start+r.timeSlice),o<r.deadline)return r.running=!0,r.depth++,r.totalDepth++,e((e,n)=>{r.depth--,r.totalDepth--,t(e,n)});r.depth=0,r.running=!1,n.setImmediate(i)}()}forEach(e,t,r){const n=this;let i,o,a=0;if(Array.isArray(e))o=e.length,i=()=>a!==o&&(i.value=e[a++],i.key=a,!0);else{const t=Object.keys(e);o=t.length,i=()=>a!==o&&(i.key=t[a++],i.value=e[i.key],!0)}!function e(o){return o?r(o):i()?n.doWork(()=>t(i.value,i.key,e)):void r()}()}waterfall(e,t){const r=this;r.forEach(e,(e,t,n)=>r.doWork(e,n),t)}whilst(e,t,r){const n=this;!function i(o){return o?r(o):e()?void n.doWork(t,i):r()}()}}},function(e,t,r){var n=r(24);r(35),r(49);var i=e.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=i,i.create=function(){a||(o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),64),a=!0);var e=null,t=n.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,o=0;o<r;++o)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i}};return i.start(),i.update=function(o,a){"utf8"===a&&(o=n.util.encodeUtf8(o));var u=o.length;i.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var c=i.fullMessageLength.length-1;c>=0;--c)i.fullMessageLength[c]+=u[1],u[1]=u[0]+(i.fullMessageLength[c]/4294967296>>>0),i.fullMessageLength[c]=i.fullMessageLength[c]>>>0,u[0]=u[1]/4294967296>>>0;return t.putBytes(o),s(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var a=n.util.createBuffer();a.putBytes(t.bytes());var u,c=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;a.putBytes(o.substr(0,i.blockLength-c));for(var l=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)l+=(u=8*i.fullMessageLength[h+1])/4294967296>>>0,a.putInt32(l>>>0),l=u>>>0;a.putInt32(l);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};s(f,r,a);var d=n.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d},i};var o=null,a=!1;function s(e,t,r){for(var n,i,o,a,s,u,c,l=r.length();l>=64;){for(i=e.h0,o=e.h1,a=e.h2,s=e.h3,u=e.h4,c=0;c<16;++c)n=r.getInt32(),t[c]=n,n=(i<<5|i>>>27)+(s^o&(a^s))+u+1518500249+n,u=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;c<20;++c)n=(n=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|n>>>31,t[c]=n,n=(i<<5|i>>>27)+(s^o&(a^s))+u+1518500249+n,u=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;c<32;++c)n=(n=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|n>>>31,t[c]=n,n=(i<<5|i>>>27)+(o^a^s)+u+1859775393+n,u=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;c<40;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(i<<5|i>>>27)+(o^a^s)+u+1859775393+n,u=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;c<60;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(i<<5|i>>>27)+(o&a|s&(o^a))+u+2400959708+n,u=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;c<80;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(i<<5|i>>>27)+(o^a^s)+u+3395469782+n,u=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+o|0,e.h2=e.h2+a|0,e.h3=e.h3+s|0,e.h4=e.h4+u|0,l-=64}}},function(e,t,r){"use strict";t.byteLength=function(e){var t=c(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,n=c(e),a=n[0],s=n[1],u=new o(function(e,t,r){return 3*(t+r)/4-r}(0,a,s)),l=0,h=s>0?a-4:a;for(r=0;r<h;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===s&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,u[l++]=255&t);1===s&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],a=0,s=r-i;a<s;a+=16383)o.push(l(e,a,a+16383>s?s:a+16383));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)n[s]=a[s],i[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e,t,r){for(var i,o,a=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,l=-7,h=r?i-1:0,f=r?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=c}return(d?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(t*u-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+d]=255&a,d+=p,a/=256,c-=8);e[r+d-p]|=128*g}},function(e,t,r){(function(t){var r={};e.exports=r;var n={};r.encode=function(e,t,r){if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==r&&"number"!=typeof r)throw new TypeError('"maxline" must be a number.');var n="";if(e instanceof Uint8Array){var i=0,o=t.length,a=t.charAt(0),s=[0];for(i=0;i<e.length;++i){for(var u=0,c=e[i];u<s.length;++u)c+=s[u]<<8,s[u]=c%o,c=c/o|0;for(;c>0;)s.push(c%o),c=c/o|0}for(i=0;0===e[i]&&i<e.length-1;++i)n+=a;for(i=s.length-1;i>=0;--i)n+=t[s[i]]}else n=function(e,t){var r=0,n=t.length,i=t.charAt(0),o=[0];for(r=0;r<e.length();++r){for(var a=0,s=e.at(r);a<o.length;++a)s+=o[a]<<8,o[a]=s%n,s=s/n|0;for(;s>0;)o.push(s%n),s=s/n|0}var u="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)u+=i;for(r=o.length-1;r>=0;--r)u+=t[o[r]];return u}(e,t);if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join("\r\n")}return n},r.decode=function(e,r){if("string"!=typeof e)throw new TypeError('"input" must be a string.');if("string"!=typeof r)throw new TypeError('"alphabet" must be a string.');var i=n[r];if(!i){i=n[r]=[];for(var o=0;o<r.length;++o)i[r.charCodeAt(o)]=o}e=e.replace(/\s/g,"");var a=r.length,s=r.charAt(0),u=[0];for(o=0;o<e.length;o++){var c=i[e.charCodeAt(o)];if(void 0===c)return;for(var l=0,h=c;l<u.length;++l)h+=u[l]*a,u[l]=255&h,h>>=8;for(;h>0;)u.push(255&h),h>>=8}for(var f=0;e[f]===s&&f<e.length-1;++f)u.push(0);return void 0!==t?t.from(u.reverse()):new Uint8Array(u.reverse())}}).call(this,r(25).Buffer)},function(e,t,r){var n=r(24);r(35),r(49);var i=e.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=i,i.create=function(){a||(o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),64),s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=!0);var e=null,t=n.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,o=0;o<r;++o)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i}};return i.start(),i.update=function(o,a){"utf8"===a&&(o=n.util.encodeUtf8(o));var s=o.length;i.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var c=i.fullMessageLength.length-1;c>=0;--c)i.fullMessageLength[c]+=s[1],s[1]=s[0]+(i.fullMessageLength[c]/4294967296>>>0),i.fullMessageLength[c]=i.fullMessageLength[c]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(o),u(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var a=n.util.createBuffer();a.putBytes(t.bytes());var s,c=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;a.putBytes(o.substr(0,i.blockLength-c));for(var l=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)l+=(s=8*i.fullMessageLength[h+1])/4294967296>>>0,a.putInt32(l>>>0),l=s>>>0;a.putInt32(l);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};u(f,r,a);var d=n.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d.putInt32(f.h5),d.putInt32(f.h6),d.putInt32(f.h7),d},i};var o=null,a=!1,s=null;function u(e,t,r){for(var n,i,o,a,u,c,l,h,f,d,p,g,y,v=r.length();v>=64;){for(u=0;u<16;++u)t[u]=r.getInt32();for(;u<64;++u)n=((n=t[u-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=((i=t[u-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[u]=n+t[u-7]+i+t[u-16]|0;for(c=e.h0,l=e.h1,h=e.h2,f=e.h3,d=e.h4,p=e.h5,g=e.h6,y=e.h7,u=0;u<64;++u)o=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),a=c&l|h&(c^l),n=y+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(g^d&(p^g))+s[u]+t[u],y=g,g=p,p=d,d=f+n>>>0,f=h,h=l,l=c,c=n+(i=o+a)>>>0;e.h0=e.h0+c|0,e.h1=e.h1+l|0,e.h2=e.h2+h|0,e.h3=e.h3+f|0,e.h4=e.h4+d|0,e.h5=e.h5+p|0,e.h6=e.h6+g|0,e.h7=e.h7+y|0,v-=64}}},function(e,t,r){"use strict";const n=r(47),i=r(19);e.exports=class extends n{constructor(e){super(e),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,t,r){return"BlankNode"!==t.termType?t:((t=i.clone(t)).value="name"===r?"_:g":t.value===e?"_:a":"_:z",t)}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t,r){const n=this,i={},o=n.blankNodeInfo[e].quads;n.forEach(o,(r,o,a)=>{let s,u;if("BlankNode"===r.subject.termType&&r.subject.value!==e)u=r.subject.value,s="p";else{if("BlankNode"!==r.object.termType||r.object.value===e)return a();u=r.object.value,s="r"}n.hashRelatedBlankNode(u,r,t,s,(e,t)=>{if(e)return a(e);t in i?i[t].push(u):i[t]=[u],a()})},e=>r(e,i))}}},function(e,t,r){"use strict";const n=r(52),i=r(19);e.exports=class extends n{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,t,r){return"BlankNode"!==t.termType?t:((t=i.clone(t)).value="name"===r?"_:g":t.value===e?"_:a":"_:z",t)}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t){const r=this,n={},i=r.blankNodeInfo[e].quads;for(let o=0;o<i.length;++o){const a=i[o];let s,u;if("BlankNode"===a.subject.termType&&a.subject.value!==e)u=a.subject.value,s="p";else{if("BlankNode"!==a.object.termType||a.object.value===e)continue;u=a.object.value,s="r"}const c=r.hashRelatedBlankNode(u,a,t,s);c in n?n[c].push(u):n[c]=[u]}return n}}},function(e,t){},function(e,t,r){"use strict";e.exports=r(33).NQuads},function(e,t,r){"use strict";const{RDF_LANGSTRING:n,RDF_PLAIN_LITERAL:i,RDF_OBJECT:o,RDF_XML_LITERAL:a,XSD_STRING:s}=r(26);let u;function c(){return"undefined"==typeof XMLSerializer?r(29).XMLSerializer:XMLSerializer}u="undefined"!=typeof Node?Node:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},e.exports=class{parse(e){const t={"@default":[]},r=e.getSubjects();for(let l=0;l<r.length;++l){const h=r[l];if(null===h)continue;const f=e.getSubjectTriples(h);if(null===f)continue;const d=f.predicates;for(const e in d){const r=d[e].objects;for(let l=0;l<r.length;++l){const f=r[l],d={};0===h.indexOf("_:")?d.subject={type:"blank node",value:h}:d.subject={type:"IRI",value:h},0===e.indexOf("_:")?d.predicate={type:"blank node",value:e}:d.predicate={type:"IRI",value:e};let p=f.value;if(f.type===a){const e=new(c());p="";for(let t=0;t<f.value.length;t++)f.value[t].nodeType===u.ELEMENT_NODE?p+=e.serializeToString(f.value[t]):f.value[t].nodeType===u.TEXT_NODE&&(p+=f.value[t].nodeValue)}d.object={},f.type===o?0===f.value.indexOf("_:")?d.object.type="blank node":d.object.type="IRI":(d.object.type="literal",f.type===i?f.language?(d.object.datatype=n,d.object.language=f.language):d.object.datatype=s:d.object.datatype=f.type),d.object.value=p,t["@default"].push(d)}}}return t}}},function(e,t,r){"use strict";const n=r(17),{isArray:i,isObject:o,isEmptyObject:a,isString:s,isUndefined:u}=r(13),{isList:c,isValue:l,isGraph:h}=r(16),{expandIri:f,getContextValue:d,isKeyword:p,process:g}=r(20),{isAbsolute:y}=r(27),{addValue:v,asArray:m,getValues:b,validateTypeValue:w}=r(10),x={};function _(e,t,r){const o=[],a=Object.keys(t).sort();for(const u of a){const a=f(e,u,{vocab:!0},r);let c=t[u];i(c)||(c=[c]);for(const e of c){if(null===e)continue;if(!s(e))throw new n("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:t});const r={"@value":e};"@none"!==a&&(r["@language"]=u.toLowerCase()),o.push(r)}}return o}function T({activeCtx:e,options:t,activeProperty:r,value:n,expansionMap:o,asGraph:a,indexKey:s}){const c=[],l=Object.keys(n).sort(),p="@type"===s;for(let y of l){if(p){const r=d(e,y,"@context");u(r)||(e=g({activeCtx:e,localCtx:r,isTypeScopedContext:!0,options:t}))}let l=n[y];i(l)||(l=[l]);const v=f(e,y,{vocab:!0},t);"@id"===s?y=f(e,y,{base:!0},t):p&&(y=v),l=x.expand({activeCtx:e,activeProperty:r,element:l,options:t,insideList:!1,insideIndex:!0,expansionMap:o});for(let e of l)a&&!h(e)&&(e={"@graph":[e]}),"@type"===s?"@none"===v||(e["@type"]?e["@type"]=[y].concat(e["@type"]):e["@type"]=[y]):"@none"===v||s in e||(e[s]=y),c.push(e)}return c}e.exports=x,x.expand=({activeCtx:e,activeProperty:t=null,element:r,options:k={},insideList:S=!1,insideIndex:I=!1,typeScopedContext:N=null,expansionMap:j=(()=>void 0)})=>{if(null==r)return null;if("@default"===t&&(k=Object.assign({},k,{isFrame:!1})),!i(r)&&!o(r)){if(!S&&(null===t||"@graph"===f(e,t,{vocab:!0},k))){const n=j({unmappedValue:r,activeCtx:e,activeProperty:t,options:k,insideList:S});return void 0===n?null:n}return function({activeCtx:e,activeProperty:t,value:r,options:n}){if(null==r)return null;const i=f(e,t,{vocab:!0},n);if("@id"===i)return f(e,r,{base:!0},n);if("@type"===i)return f(e,r,{vocab:!0,base:!0},n);const o=d(e,t,"@type");if(("@id"===o||"@graph"===i)&&s(r))return{"@id":f(e,r,{base:!0},n)};if("@vocab"===o&&s(r))return{"@id":f(e,r,{vocab:!0,base:!0},n)};if(p(i))return r;const a={};if(o&&!["@id","@vocab"].includes(o))a["@type"]=o;else if(s(r)){const r=d(e,t,"@language");null!==r&&(a["@language"]=r)}["boolean","number","string"].includes(typeof r)||(r=r.toString());return a["@value"]=r,a}({activeCtx:e,activeProperty:t,value:r,options:k})}if(i(r)){let o=[];const a=d(e,t,"@container")||[];S=S||a.includes("@list");for(let a=0;a<r.length;++a){let s=x.expand({activeCtx:e,activeProperty:t,element:r[a],options:k,expansionMap:j,insideIndex:I,typeScopedContext:N});if(S&&(i(s)||c(s)))throw new n("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null===s&&void 0===(s=j({unmappedValue:r[a],activeCtx:e,activeProperty:t,parent:r,index:a,options:k,expandedParent:o,insideList:S}))||(i(s)?o=o.concat(s):o.push(s))}return o}const E=f(e,t,{vocab:!0},k);N=N||(e.previousContext?e:null);let O=Object.keys(r).sort(),C=!I;if(C&&N&&O.length<=2&&!O.includes("@context"))for(const t of O){const r=f(N,t,{vocab:!0},k);if("@value"===r){C=!1,e=N;break}if("@id"===r&&1===O.length){C=!1;break}}C&&(e=e.revertTypeScopedContext()),"@context"in r&&(e=g({activeCtx:e,localCtx:r["@context"],options:k}));for(const t of O){if("@type"===f(e,t,{vocab:!0},k)){const n=r[t],i=Array.isArray(n)?n.length>1?n.slice().sort():n:[n];for(const t of i){const r=d(e.previousContext||e,t,"@context");u(r)||(e=g({activeCtx:e,localCtx:r,options:k,isTypeScopedContext:!0}))}}}let R={};!function e({activeCtx:t,activeProperty:r,expandedActiveProperty:b,element:k,expandedParent:S,options:I={},insideList:N,expansionMap:j}){const E=Object.keys(k).sort();const O=[];for(const e of E){let E,C=k[e];if("@context"===e)continue;let R=f(t,e,{vocab:!0},I);if((null===R||!y(R)&&!p(R))&&void 0===(R=j({unmappedProperty:e,activeCtx:t,activeProperty:r,parent:k,options:I,insideList:N,value:C,expandedParent:S})))continue;if(p(R)){if("@reverse"===b)throw new n("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:C});if(R in S)throw new n("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:R})}if("@id"===R){if(!s(C)){if(!I.isFrame)throw new n('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:C});if(o(C)){if(!a(C))throw new n('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:C})}else{if(!i(C))throw new n('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:C});if(!C.every(e=>s(e)))throw new n('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:C})}}v(S,"@id",m(C).map(e=>s(e)?f(t,e,{base:!0},I):e),{propertyIsArray:I.isFrame});continue}if("@type"===R){w(C),v(S,"@type",m(C).map(e=>s(e)?f(t.previousContext||t,e,{base:!0,vocab:!0},I):e),{propertyIsArray:I.isFrame});continue}if("@graph"===R&&!o(C)&&!i(C))throw new n('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:C});if("@value"===R){if((o(C)||i(C))&&!I.isFrame)throw new n('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:C});v(S,"@value",C,{propertyIsArray:I.isFrame});continue}if("@language"===R){if(null===C)continue;if(!s(C)&&!I.isFrame)throw new n('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:C});C=m(C).map(e=>s(e)?e.toLowerCase():e),v(S,"@language",C,{propertyIsArray:I.isFrame});continue}if("@index"===R){if(!s(C))throw new n('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:C});v(S,"@index",C);continue}if("@reverse"===R){if(!o(C))throw new n('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:C});if("@reverse"in(E=x.expand({activeCtx:t,activeProperty:"@reverse",element:C,options:I,expansionMap:j})))for(const e in E["@reverse"])v(S,e,E["@reverse"][e],{propertyIsArray:!0});let e=S["@reverse"]||null;for(const t in E){if("@reverse"===t)continue;null===e&&(e=S["@reverse"]={}),v(e,t,[],{propertyIsArray:!0});const r=E[t];for(let i=0;i<r.length;++i){const o=r[i];if(l(o)||c(o))throw new n('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:E});v(e,t,o,{propertyIsArray:!0})}}continue}if("@nest"===R){O.push(e);continue}let A=t;const L=d(t,e,"@context");u(L)||(A=g({activeCtx:t,localCtx:L,isPropertyTermScopedContext:!0,options:I}));const D=d(A,e,"@container")||[];if(D.includes("@language")&&o(C))E=_(A,C,I);else if(D.includes("@index")&&o(C)){const t=D.includes("@graph");E=T({activeCtx:A,options:I,activeProperty:e,value:C,expansionMap:j,asGraph:t,indexKey:"@index"})}else if(D.includes("@id")&&o(C)){const t=D.includes("@graph");E=T({activeCtx:A,options:I,activeProperty:e,value:C,expansionMap:j,asGraph:t,indexKey:"@id"})}else if(D.includes("@type")&&o(C))E=T({activeCtx:A.revertTypeScopedContext(),options:I,activeProperty:e,value:C,expansionMap:j,asGraph:!1,indexKey:"@type"});else{const t="@list"===R;if(t||"@set"===R){let e=r;if(t&&"@graph"===b&&(e=null),E=x.expand({activeCtx:A,activeProperty:e,element:C,options:I,insideList:t,expansionMap:j}),t&&c(E))throw new n("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else E=x.expand({activeCtx:A,activeProperty:e,element:C,options:I,insideList:!1,expansionMap:j})}if(null===E&&"@value"!==R&&void 0===(E=j({unmappedValue:C,expandedProperty:R,activeCtx:A,activeProperty:r,parent:k,options:I,insideList:N,key:e,expandedParent:S})))continue;if("@list"!==R&&!c(E)&&D.includes("@list")&&(E={"@list":m(E)}),D.includes("@graph")&&!D.some(e=>"@id"===e||"@index"===e)&&(E=m(E).map(e=>h(e)?e:{"@graph":m(e)})),A.mappings.has(e)&&A.mappings.get(e).reverse){const e=S["@reverse"]=S["@reverse"]||{};E=m(E);for(let t=0;t<E.length;++t){const r=E[t];if(l(r)||c(r))throw new n('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:E});v(e,R,r,{propertyIsArray:!0})}continue}const M=!["@index","@id","@type","@value","@language"].includes(R);v(S,R,E,{propertyIsArray:M})}for(const a of O){const s=i(k[a])?k[a]:[k[a]];for(const i of s){if(!o(i)||Object.keys(i).some(e=>"@value"===f(t,e,{vocab:!0},I)))throw new n("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:i});e({activeCtx:t,activeProperty:r,expandedActiveProperty:b,element:i,expandedParent:S,options:I,insideList:N,expansionMap:j})}}}({activeCtx:e,activeProperty:t,expandedActiveProperty:E,element:r,expandedParent:R,options:k,insideList:S,typeScopedContext:N,expansionMap:j});let A=(O=Object.keys(R)).length;if("@value"in R){if("@type"in R&&"@language"in R)throw new n('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:R});let i=A-1;if("@type"in R&&(i-=1),"@index"in R&&(i-=1),"@language"in R&&(i-=1),0!==i)throw new n('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:R});const o=null===R["@value"]?[]:m(R["@value"]),u=b(R,"@type");if(0===o.length){const n=j({unmappedValue:R,activeCtx:e,activeProperty:t,element:r,options:k,insideList:S});R=void 0!==n?n:null}else{if(!o.every(e=>s(e)||a(e))&&"@language"in R)throw new n("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:R});if(!u.every(e=>y(e)&&!(s(e)&&0===e.indexOf("_:"))||a(e)))throw new n('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:R})}}else if("@type"in R&&!i(R["@type"]))R["@type"]=[R["@type"]];else if("@set"in R||"@list"in R){if(A>1&&!(2===A&&"@index"in R))throw new n('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:R});"@set"in R&&(R=R["@set"],A=(O=Object.keys(R)).length)}else if(1===A&&"@language"in R){const n=j(R,{unmappedValue:R,activeCtx:e,activeProperty:t,element:r,options:k,insideList:S});R=void 0!==n?n:null}if(o(R)&&!k.keepFreeFloatingNodes&&!S&&(null===t||"@graph"===E)&&(0===A||"@value"in R||"@list"in R||1===A&&"@id"in R)){const n=j({unmappedValue:R,activeCtx:e,activeProperty:t,element:r,options:k,insideList:S});R=void 0!==n?n:null}return R}},function(e,t,r){"use strict";const{clone:n}=r(10);e.exports=class{constructor(e=100){this.order=[],this.cache=new Map,this.size=e}get(e,t){const r=this.cache.get(e);if(r){const e=JSON.stringify(t);return r.get(e)||null}return null}set(e,t,r){if(this.order.length===this.size){const e=this.order.shift();this.cache.get(e.activeCtx).delete(e.localCtx)}const i=JSON.stringify(t);this.order.push({activeCtx:e,localCtx:i});let o=this.cache.get(e);o||(o=new Map,this.cache.set(e,o)),o.set(i,n(r))}}},function(e,t,r){"use strict";const{isSubjectReference:n}=r(16),{createMergedNodeMap:i}=r(30),o={};e.exports=o,o.flatten=e=>{const t=i(e),r=[],o=Object.keys(t).sort();for(let e=0;e<o.length;++e){const i=t[o[e]];n(i)||r.push(i)}return r}},function(e,t,r){"use strict";const n=r(16),i=r(13),o=r(10),{RDF_LIST:a,RDF_FIRST:s,RDF_REST:u,RDF_NIL:c,RDF_TYPE:l,XSD_BOOLEAN:h,XSD_DOUBLE:f,XSD_INTEGER:d,XSD_STRING:p}=r(26),g={};function y(e,t){if(e.termType.endsWith("Node"))return{"@id":e.value};const r={"@value":e.value};if(e.language)r["@language"]=e.language;else{let n=e.datatype.value;if(n||(n=p),t){if(n===h)"true"===r["@value"]?r["@value"]=!0:"false"===r["@value"]&&(r["@value"]=!1);else if(i.isNumeric(r["@value"]))if(n===d){const e=parseInt(r["@value"],10);e.toFixed(0)===r["@value"]&&(r["@value"]=e)}else n===f&&(r["@value"]=parseFloat(r["@value"]));[h,d,f,p].includes(n)||(r["@type"]=n)}else n!==p&&(r["@type"]=n)}return r}e.exports=g,g.fromRDF=async(e,{useRdfType:t=!1,useNativeTypes:r=!1})=>{const h={},f={"@default":h},d={};for(const n of e){const e="DefaultGraph"===n.graph.termType?"@default":n.graph.value;e in f||(f[e]={}),"@default"===e||e in h||(h[e]={"@id":e});const i=f[e],a=n.subject.value,s=n.predicate.value,u=n.object;a in i||(i[a]={"@id":a});const p=i[a],g=u.termType.endsWith("Node");if(!g||u.value in i||(i[u.value]={"@id":u.value}),s===l&&!t&&g){o.addValue(p,"@type",u.value,{propertyIsArray:!0});continue}const v=y(u,r);if(o.addValue(p,s,v,{propertyIsArray:!0}),g)if(u.value===c){const e=i[u.value];"usages"in e||(e.usages=[]),e.usages.push({node:p,property:s,value:v})}else u.value in d?d[u.value]=!1:d[u.value]={node:p,property:s,value:v}}for(const e in f){const t=f[e];if(!(c in t))continue;const r=t[c];if(r.usages){for(let e of r.usages){let r=e.node,o=e.property,l=e.value;const h=[],f=[];let p=Object.keys(r).length;for(;o===u&&i.isObject(d[r["@id"]])&&i.isArray(r[s])&&1===r[s].length&&i.isArray(r[u])&&1===r[u].length&&(3===p||4===p&&i.isArray(r["@type"])&&1===r["@type"].length&&r["@type"][0]===a)&&(h.push(r[s][0]),f.push(r["@id"]),r=(e=d[r["@id"]]).node,o=e.property,l=e.value,p=Object.keys(r).length,n.isBlankNode(r)););if(o===s){if(r["@id"]===c)continue;u in t[l["@id"]]&&(l=t[l["@id"]][u][0]),h.pop(),f.pop()}delete l["@id"],l["@list"]=h.reverse();for(const e of f)delete t[e]}delete r.usages}}const p=[],g=Object.keys(h).sort();for(const e of g){const t=h[e];if(e in f){const r=t["@graph"]=[],i=f[e],o=Object.keys(i).sort();for(const e of o){const t=i[e];n.isSubjectReference(t)||r.push(t)}}n.isSubjectReference(t)||p.push(t)}return p}},function(e,t,r){"use strict";const{createNodeMap:n}=r(30),{isKeyword:i}=r(20),o=r(16),a=r(13),s=r(10),{RDF_FIRST:u,RDF_REST:c,RDF_NIL:l,RDF_TYPE:h,RDF_LANGSTRING:f,XSD_BOOLEAN:d,XSD_DOUBLE:p,XSD_INTEGER:g,XSD_STRING:y}=r(26),{isAbsolute:v}=r(27),m={};function b(e,t,r,n,a){const s=Object.keys(t).sort();for(let u=0;u<s.length;++u){const c=s[u],l=t[c],f=Object.keys(l).sort();for(let t of f){const s=l[t];if("@type"===t)t=h;else if(i(t))continue;for(const i of s){const s={termType:c.startsWith("_:")?"BlankNode":"NamedNode",value:c};if(!v(c))continue;const u={termType:t.startsWith("_:")?"BlankNode":"NamedNode",value:t};if(v(t)&&("BlankNode"!==u.termType||a.produceGeneralizedRdf))if(o.isList(i))w(i["@list"],n,s,u,e,r);else{const t=x(i);t&&e.push({subject:s,predicate:u,object:t,graph:r})}}}}}function w(e,t,r,n,i,o){const a={termType:"NamedNode",value:u},s={termType:"NamedNode",value:c},h={termType:"NamedNode",value:l};for(const u of e){const e={termType:"BlankNode",value:t.getId()};i.push({subject:r,predicate:n,object:e,graph:o}),r=e,n=a;const c=x(u);c&&i.push({subject:r,predicate:n,object:c,graph:o}),n=s}i.push({subject:r,predicate:n,object:h,graph:o})}function x(e){const t={};if(o.isValue(e)){t.termType="Literal",t.value=void 0,t.datatype={termType:"NamedNode"};let r=e["@value"];const n=e["@type"]||null;a.isBoolean(r)?(t.value=r.toString(),t.datatype.value=n||d):a.isDouble(r)||n===p?(a.isDouble(r)||(r=parseFloat(r)),t.value=r.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),t.datatype.value=n||p):a.isNumber(r)?(t.value=r.toFixed(0),t.datatype.value=n||g):"@language"in e?(t.value=r,t.datatype.value=n||f,t.language=e["@language"]):(t.value=r,t.datatype.value=n||y)}else{const r=a.isObject(e)?e["@id"]:e;t.termType=r.startsWith("_:")?"BlankNode":"NamedNode",t.value=r}return"NamedNode"!==t.termType||v(t.value)?t:null}e.exports=m,m.toRDF=(e,t)=>{const r=new s.IdentifierIssuer("_:b"),i={"@default":{}};n(e,i,"@default",r);const o=[],a=Object.keys(i).sort();for(const e of a){let n;if("@default"===e)n={termType:"DefaultGraph",value:""};else{if(!v(e))continue;(n=e.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"}).value=e}b(o,i[e],n,r,t)}return o}},function(e,t,r){"use strict";const{isKeyword:n}=r(20),i=r(16),o=r(13),a=r(10),s=r(17),{createNodeMap:u,mergeNodeMapGraphs:c}=r(30),l={};function h(e){const t={};for(const r in e)void 0!==e[r]&&(t["@"+r]=[e[r]]);return[t]}function f(e,t,r){for(let n=r.length-1;n>=0;--n){const i=r[n];if(i.graph===t&&i.subject["@id"]===e["@id"])return!0}return!1}function d(e,t,r){const n="@"+r;let i=n in e?e[n][0]:t[r];return"embed"===r&&(!0===i?i="@last":!1===i?i="@never":"@always"!==i&&"@never"!==i&&"@link"!==i&&(i="@last")),i}function p(e){if(!o.isArray(e)||1!==e.length||!o.isObject(e[0]))throw new s("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e})}function g(e,t,r,s){let u=!0,c=!1;for(const l in r){let h=!1;const f=a.getValues(t,l),d=0===a.getValues(r,l).length;if(n(l)){if("@id"!==l&&"@type"!==l)continue;if(u=!1,"@id"===l){if(r["@id"].length>=0&&!o.isEmptyObject(r["@id"][0]))return r["@id"].includes(f[0]);h=!0;continue}if("@type"in r)if(d){if(f.length>0)return!1;h=!0}else{if(1!==r["@type"].length||!o.isEmptyObject(r["@type"][0])){for(const e of r["@type"])if(f.some(t=>t===e))return!0;return!1}h=f.length>0}}const g=a.getValues(r,l)[0];let y=!1;if(g&&(p([g]),y="@default"in g),u=!1,0!==f.length||!y){if(f.length>0&&d)return!1;if(void 0===g){if(f.length>0)return!1;h=!0}else if(o.isObject(g))h=f.length>0;else if(i.isValue(g))h=f.some(e=>b(g,e));else if(i.isSubject(g)||i.isSubjectReference(g))h=f.some(t=>m(e,g,t,s));else if(i.isList(g)){const t=g["@list"][0];if(i.isList(f[0])){const r=f[0]["@list"];i.isValue(t)?h=r.some(e=>b(t,e)):(i.isSubject(t)||i.isSubjectReference(t))&&(h=r.some(r=>m(e,t,r,s)))}else h=!1}if(!h&&s.requireAll)return!1;c=c||h}}return u||c}function y(e,t){const r=e.uniqueEmbeds[e.graph],n=r[t],i=n.parent,s=n.property,u={"@id":t};if(o.isArray(i)){for(let e=0;e<i.length;++e)if(a.compareValues(i[e],u)){i[e]=u;break}}else{const e=o.isArray(i[s]);a.removeValue(i,s,u,{propertyIsArray:e}),a.addValue(i,s,u,{propertyIsArray:e})}const c=e=>{const t=Object.keys(r);for(const n of t)n in r&&o.isObject(r[n].parent)&&r[n].parent["@id"]===e&&(delete r[n],c(n))};c(t)}function v(e,t,r){o.isObject(e)?a.addValue(e,t,r,{propertyIsArray:!0}):e.push(r)}function m(e,t,r,n){if(!("@id"in r))return!1;const i=e.subjects[r["@id"]];return i&&g(e,i,t,n)}function b(e,t){const r=t["@value"],n=t["@type"],i=t["@language"],a=e["@value"]?o.isArray(e["@value"])?e["@value"]:[e["@value"]]:[],s=e["@type"]?o.isArray(e["@type"])?e["@type"]:[e["@type"]]:[],u=e["@language"]?o.isArray(e["@language"])?e["@language"]:[e["@language"]]:[];return 0===a.length&&0===s.length&&0===u.length||!(!a.includes(r)&&!o.isEmptyObject(a[0]))&&(!!(!n&&0===s.length||s.includes(n)||n&&o.isEmptyObject(s[0]))&&!!(!i&&0===u.length||u.includes(i)||i&&o.isEmptyObject(u[0])))}e.exports=l,l.frameMergedOrDefault=(e,t,r)=>{const n={options:r,graph:"@default",graphMap:{"@default":{}},graphStack:[],subjectStack:[],link:{},bnodeMap:{}},i=new a.IdentifierIssuer("_:b");u(e,n.graphMap,"@default",i),r.merged&&(n.graphMap["@merged"]=c(n.graphMap),n.graph="@merged"),n.subjects=n.graphMap[n.graph];const o=[];return l.frame(n,Object.keys(n.subjects).sort(),t,o),r.pruneBlankNodeIdentifiers&&(r.bnodesToClear=Object.keys(n.bnodeMap).filter(e=>1===n.bnodeMap[e].length)),o},l.frame=(e,t,r,s,u=null)=>{p(r),r=r[0];const c=e.options,m={embed:d(r,c,"embed"),explicit:d(r,c,"explicit"),requireAll:d(r,c,"requireAll")},w=function(e,t,r,n){const i={};for(const o of t){const t=e.graphMap[e.graph][o];g(e,t,r,n)&&(i[o]=t)}return i}(e,t,r,m),x=Object.keys(w).sort();for(const t of x){const p=w[t];if("@link"===m.embed&&t in e.link){v(s,u,e.link[t]);continue}null===u?e.uniqueEmbeds={[e.graph]:{}}:e.uniqueEmbeds[e.graph]=e.uniqueEmbeds[e.graph]||{};const g={};if(g["@id"]=t,0===t.indexOf("_:")&&a.addValue(e.bnodeMap,t,g,{propertyIsArray:!0}),e.link[t]=g,"@never"===m.embed||f(p,e.graph,e.subjectStack))v(s,u,g);else{if("@last"===m.embed&&(t in e.uniqueEmbeds[e.graph]&&y(e,t),e.uniqueEmbeds[e.graph][t]={parent:s,property:u}),e.subjectStack.push({subject:p,graph:e.graph}),t in e.graphMap){let n=!1,i=null;"@graph"in r?(i=r["@graph"][0],o.isObject(i)||(i={}),n=!("@merged"===t||"@default"===t)):(n="@merged"!==e.graph,i={}),n&&(e.graphStack.push(e.graph),e.graph=t,l.frame(e,Object.keys(e.graphMap[t]).sort(),[i],g,"@graph"),e.graph=e.graphStack.pop)}for(const t of Object.keys(p).sort())if(n(t)){if(g[t]=a.clone(p[t]),"@type"===t)for(const t of p["@type"])0===t.indexOf("_:")&&a.addValue(e.bnodeMap,t,g,{propertyIsArray:!0})}else if(!m.explicit||t in r)for(let n of p[t]){const o=t in r?r[t]:h(m);if(i.isList(n)){const o={"@list":[]};v(g,t,o);const s=n["@list"];for(const u in s)if(n=s[u],i.isSubjectReference(n)){const i=t in r?r[t][0]["@list"]:h(m);l.frame(e,[n["@id"]],i,o,"@list")}else v(o,"@list",a.clone(n))}else i.isSubjectReference(n)?l.frame(e,[n["@id"]],o,g,t):b(o[0],n)&&v(g,t,a.clone(n))}for(const e of Object.keys(r).sort()){if(n(e))continue;const t=r[e][0]||{};if(!(d(t,c,"omitDefault")||e in g)){let r="@null";"@default"in t&&(r=a.clone(t["@default"])),o.isArray(r)||(r=[r]),g[e]=[{"@preserve":r}]}}if("@reverse"in r)for(const n of Object.keys(r["@reverse"]).sort()){const i=r["@reverse"][n];for(const r of Object.keys(e.subjects)){a.getValues(e.subjects[r],n).some(e=>e["@id"]===t)&&(g["@reverse"]=g["@reverse"]||{},a.addValue(g["@reverse"],n,[],{propertyIsArray:!0}),l.frame(e,[r],i,g["@reverse"][n],u))}}v(s,u,g),e.subjectStack.pop()}}}},function(e,t,r){"use strict";const n=r(17),{isArray:i,isObject:o,isString:a,isUndefined:s}=r(13),{isList:u,isValue:c,isGraph:l,isSimpleGraph:h,isSubjectReference:f}=r(16),{expandIri:d,getContextValue:p,isKeyword:g,process:y}=r(20),{removeBase:v}=r(27),{addValue:m,asArray:b,compareShortestLeast:w}=r(10),x={};function _(e,t,r){if("@nest"!==d(e,t,{vocab:!0},r))throw new n("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}e.exports=x,x.compact=({activeCtx:e,activeProperty:t=null,element:r,options:a={},compactionMap:d=(()=>void 0)})=>{if(i(r)){let n=[];for(let i=0;i<r.length;++i){let o=x.compact({activeCtx:e,activeProperty:t,element:r[i],options:a,compactionMap:d});null===o&&void 0===(o=d({unmappedValue:r[i],activeCtx:e,activeProperty:t,parent:r,index:i,options:a}))||n.push(o)}if(a.compactArrays&&1===n.length){0===(p(e,t,"@container")||[]).length&&(n=n[0])}return n}const v=p(e,t,"@context");if(s(v)||(e=y({activeCtx:e,localCtx:v,isPropertyTermScopedContext:!0,options:a})),o(r)){if(a.link&&"@id"in r&&a.link.hasOwnProperty(r["@id"])){const e=a.link[r["@id"]];for(let t=0;t<e.length;++t)if(e[t].expanded===r)return e[t].compacted}if(c(r)||f(r)){const n=x.compactValue({activeCtx:e,activeProperty:t,value:r,options:a});return a.link&&f(r)&&(a.link.hasOwnProperty(r["@id"])||(a.link[r["@id"]]=[]),a.link[r["@id"]].push({expanded:r,compacted:n})),n}const v="@reverse"===t,w={};e=e.revertTypeScopedContext(),a.link&&"@id"in r&&(a.link.hasOwnProperty(r["@id"])||(a.link[r["@id"]]=[]),a.link[r["@id"]].push({expanded:r,compacted:w}));let T=r["@type"]||[];T.length>1&&(T=Array.from(T).sort());const k=e;for(const t of T){const r=x.compactIri({activeCtx:k,iri:t,relativeTo:{vocab:!0}}),n=p(k,r,"@context");s(n)||(e=y({activeCtx:e,localCtx:n,options:a,isTypeScopedContext:!0}))}const S=Object.keys(r).sort();for(const s of S){const f=r[s];if("@id"!==s&&"@type"!==s)if("@reverse"!==s)if("@preserve"!==s)if("@index"!==s)if("@graph"!==s&&"@list"!==s&&g(s)){const t=x.compactIri({activeCtx:e,iri:s,relativeTo:{vocab:!0}});m(w,t,f)}else{if(!i(f))throw new n("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===f.length){const t=x.compactIri({activeCtx:e,iri:s,value:f,relativeTo:{vocab:!0},reverse:v}),r=e.mappings.has(t)?e.mappings.get(t)["@nest"]:null;let n=w;r&&(_(e,r,a),o(w[r])||(w[r]={}),n=w[r]),m(n,t,f,{propertyIsArray:!0})}for(const t of f){const r=x.compactIri({activeCtx:e,iri:s,value:t,relativeTo:{vocab:!0},reverse:v}),f=e.mappings.has(r)?e.mappings.get(r)["@nest"]:null;let g=w;f&&(_(e,f,a),o(w[f])||(w[f]={}),g=w[f]);const y=p(e,r,"@container")||[],T=l(t),k=u(t);let S;k?S=t["@list"]:T&&(S=t["@graph"]);let I=x.compact({activeCtx:e,activeProperty:r,element:k||T?S:t,options:a,compactionMap:d});if(k)if(i(I)||(I=[I]),y.includes("@list")){if(g.hasOwnProperty(r))throw new n('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"})}else I={[x.compactIri({activeCtx:e,iri:"@list",relativeTo:{vocab:!0}})]:I},"@index"in t&&(I[x.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"]);if(T)if(y.includes("@graph")&&(y.includes("@id")||y.includes("@index")&&h(t))){let n;g.hasOwnProperty(r)?n=g[r]:g[r]=n={};const i=(y.includes("@id")?t["@id"]:t["@index"])||x.compactIri({activeCtx:e,iri:"@none",vocab:!0});m(n,i,I,{propertyIsArray:!a.compactArrays||y.includes("@set")})}else y.includes("@graph")&&h(t)?m(g,r,I,{propertyIsArray:!a.compactArrays||y.includes("@set")}):(i(I)&&1===I.length&&a.compactArrays&&(I=I[0]),I={[x.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}})]:I},"@id"in t&&(I[x.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t["@id"]),"@index"in t&&(I[x.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"]),m(g,r,I,{propertyIsArray:!a.compactArrays||y.includes("@set")}));else if(y.includes("@language")||y.includes("@index")||y.includes("@id")||y.includes("@type")){let n,i;if(g.hasOwnProperty(r)?n=g[r]:g[r]=n={},y.includes("@language"))c(I)&&(I=I["@value"]),i=t["@language"];else if(y.includes("@index"))i=t["@index"];else if(y.includes("@id")){const t=x.compactIri({activeCtx:e,iri:"@id",vocab:!0});i=I[t],delete I[t]}else if(y.includes("@type")){const t=x.compactIri({activeCtx:e,iri:"@type",vocab:!0});let r;switch([i,...r]=b(I[t]||[]),r.length){case 0:delete I[t];break;case 1:I[t]=r[0];break;default:I[t]=r}}i||(i=x.compactIri({activeCtx:e,iri:"@none",vocab:!0})),m(n,i,I,{propertyIsArray:y.includes("@set")})}else{const e=!a.compactArrays||y.includes("@set")||y.includes("@list")||i(I)&&0===I.length||"@list"===s||"@graph"===s;m(g,r,I,{propertyIsArray:e})}}}else{if((p(e,t,"@container")||[]).includes("@index"))continue;const r=x.compactIri({activeCtx:e,iri:s,relativeTo:{vocab:!0}});m(w,r,f)}else{const r=x.compact({activeCtx:e,activeProperty:t,element:f,options:a,compactionMap:d});i(r)&&0===r.length||m(w,s,r)}else{const t=x.compact({activeCtx:e,activeProperty:"@reverse",element:f,options:a,compactionMap:d});for(const r in t)if(e.mappings.has(r)&&e.mappings.get(r).reverse){const n=t[r],i=(p(e,r,"@container")||[]).includes("@set")||!a.compactArrays;m(w,r,n,{propertyIsArray:i}),delete t[r]}if(Object.keys(t).length>0){const r=x.compactIri({activeCtx:e,iri:s,relativeTo:{vocab:!0}});m(w,r,t)}}else{const t="@type"===s,r=t&&e.previousContext||e;let n=b(f).map(e=>x.compactIri({activeCtx:r,iri:e,relativeTo:{vocab:t}}));1===n.length&&(n=n[0]);const o=x.compactIri({activeCtx:e,iri:s,relativeTo:{vocab:!0}}),a=i(n)&&0===f.length;m(w,o,n,{propertyIsArray:a})}}return w}return r},x.compactIri=({activeCtx:e,iri:t,value:r=null,relativeTo:n={vocab:!1},reverse:i=!1})=>{if(null===t)return t;e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext);const a=e.getInverse();if(g(t)&&t in a&&"@none"in a[t]&&"@type"in a[t]["@none"]&&"@none"in a[t]["@none"]["@type"])return a[t]["@none"]["@type"]["@none"];if(n.vocab&&t in a){const n=e["@language"]||"@none",a=[];o(r)&&"@index"in r&&!("@graph"in r)&&a.push("@index","@index@set"),o(r)&&"@preserve"in r&&(r=r["@preserve"][0]),l(r)?("@index"in r&&a.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in r&&a.push("@graph@id","@graph@id@set"),a.push("@graph","@graph@set","@set"),"@index"in r||a.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in r||a.push("@graph@id","@graph@id@set")):o(r)&&!c(r)&&a.push("@id","@id@set","@type","@set@type");let s="@language",h="@null";if(i)s="@type",h="@reverse",a.push("@set");else if(u(r)){"@index"in r||a.push("@list");const e=r["@list"];if(0===e.length)s="@any",h="@none";else{let t=0===e.length?n:null,r=null;for(let n=0;n<e.length;++n){const i=e[n];let o="@none",a="@none";if(c(i)?"@language"in i?o=i["@language"]:"@type"in i?a=i["@type"]:o="@null":a="@id",null===t?t=o:o!==t&&c(i)&&(t="@none"),null===r?r=a:a!==r&&(r="@none"),"@none"===t&&"@none"===r)break}t=t||"@none","@none"!==(r=r||"@none")?(s="@type",h=r):h=t}}else c(r)?"@language"in r&&!("@index"in r)?(a.push("@language","@language@set"),h=r["@language"]):"@type"in r&&(s="@type",h=r["@type"]):(s="@type",h="@id"),a.push("@set");a.push("@none"),!o(r)||"@index"in r||a.push("@index","@index@set"),c(r)&&1===Object.keys(r).length&&a.push("@language","@language@set");const d=function(e,t,r,n,i,o){null===o&&(o="@null");const a=[];if("@id"!==o&&"@reverse"!==o||!f(r))a.push(o);else{"@reverse"===o&&a.push("@reverse");const t=x.compactIri({activeCtx:e,iri:r["@id"],relativeTo:{vocab:!0}});e.mappings.has(t)&&e.mappings.get(t)&&e.mappings.get(t)["@id"]===r["@id"]?a.push.apply(a,["@vocab","@id"]):a.push.apply(a,["@id","@vocab"])}a.push("@none");const s=e.inverse[t];for(let e=0;e<n.length;++e){const t=n[e];if(!(t in s))continue;const r=s[t][i];for(let e=0;e<a.length;++e){const t=a[e];if(t in r)return r[t]}}return null}(e,t,r,a,s,h);if(null!==d)return d}if(n.vocab&&"@vocab"in e){const r=e["@vocab"];if(0===t.indexOf(r)&&t!==r){const n=t.substr(r.length);if(!e.mappings.has(n))return n}}let s=null;const h=[];let d=e.fastCurieMap;const p=t.length-1;for(let e=0;e<p&&t[e]in d;++e)""in(d=d[t[e]])&&h.push(d[""][0]);for(let n=h.length-1;n>=0;--n){const i=h[n],o=i.terms;for(const n of o){const o=n+":"+t.substr(i.iri.length);e.mappings.get(n)._prefix&&(!e.mappings.has(o)||null===r&&e.mappings.get(o)["@id"]===t)&&(null===s||w(o,s)<0)&&(s=o)}}return null!==s?s:n.vocab?t:v(e["@base"],t)},x.compactValue=({activeCtx:e,activeProperty:t,value:r,options:n})=>{if(c(r)){const n=p(e,t,"@type"),i=p(e,t,"@language"),o=p(e,t,"@container")||[],s="@index"in r&&!o.includes("@index");if(!s&&(r["@type"]===n||r["@language"]===i))return r["@value"];const u=Object.keys(r).length,c=1===u||2===u&&"@index"in r&&!s,l="@language"in e,h=a(r["@value"]),f=e.mappings.has(t)&&null===e.mappings.get(t)["@language"];if(c&&(!l||!h||f))return r["@value"];const d={};return s&&(d[x.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=r["@index"]),"@type"in r?d[x.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}})]=x.compactIri({activeCtx:e,iri:r["@type"],relativeTo:{vocab:!0}}):"@language"in r&&(d[x.compactIri({activeCtx:e,iri:"@language",relativeTo:{vocab:!0}})]=r["@language"]),d[x.compactIri({activeCtx:e,iri:"@value",relativeTo:{vocab:!0}})]=r["@value"],d}const i=d(e,t,{vocab:!0},n),o=p(e,t,"@type"),s=x.compactIri({activeCtx:e,iri:r["@id"],relativeTo:{vocab:"@vocab"===o}});return"@id"===o||"@vocab"===o||"@graph"===i?s:{[x.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]:s}},
/**
 * Removes the @preserve keywords as the last step of the compaction
 * algorithm when it is running on framed output.
 *
 * @param ctx the active context used to compact the input.
 * @param input the framed, compacted output.
 * @param options the compaction options used.
 *
 * @return the resulting output.
 */
x.removePreserve=(e,t,r)=>{if(i(t)){const n=[];for(let i=0;i<t.length;++i){const o=x.removePreserve(e,t[i],r);null!==o&&n.push(o)}t=n}else if(o(t)){
// remove @preserve
if("@preserve"in t)return"@null"===t["@preserve"]?null:t["@preserve"];if(c(t))return t;if(u(t))return t["@list"]=x.removePreserve(e,t["@list"],r),t;const n=x.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}});if(t.hasOwnProperty(n)){const e=t[n];if(r.link.hasOwnProperty(e)){const n=r.link[e].indexOf(t);if(-1!==n)return r.link[e][n];r.link[e].push(t)}else r.link[e]=[t]}const o=x.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}});for(const a in t){if(a===n&&r.bnodesToClear.includes(t[a])){delete t[n];continue}let s=x.removePreserve(e,t[a],r);const u=p(e,a,"@container")||[];r.compactArrays&&i(s)&&1===s.length&&0===u.length&&a!==o&&(s=s[0]),t[a]=s}}return t}},function(e,t,r){"use strict";const{parseLinkHeader:n,buildHeaders:i}=r(10),{LINK_HEADER_REL:o}=r(26),a=r(17),s=r(37);e.exports=({secure:e,strictSSL:t=!0,maxRedirects:u=-1,request:c,headers:l={}}={strictSSL:!0,maxRedirects:-1,headers:{}})=>{l=i(l),c=c||r(90);const h=r(91);return(new s).wrapLoader(function(r){return async function r(i,s){if(0!==i.indexOf("http:")&&0!==i.indexOf("https:"))throw new a('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:i});if(e&&0!==i.indexOf("https"))throw new a('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:i});let f=null;if(null!==f)return f;let d;try{d=await function(e,t){return new Promise((r,n)=>{e(t,(e,t,i)=>{e?n(e):r({res:t,body:i})})})}(c,{url:i,headers:l,strictSSL:t,followRedirect:!1})}catch(e){throw new a("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:i,cause:e})}const{res:p,body:g}=d;f={contextUrl:null,documentUrl:i,document:g||null};const y=h.STATUS_CODES[p.statusCode];if(p.statusCode>=400)throw new a("URL could not be dereferenced: "+y,"jsonld.InvalidUrl",{code:"loading document failed",url:i,httpStatusCode:p.statusCode});if(p.headers.link&&"application/ld+json"!==p.headers["content-type"]){const e=n(p.headers.link)[o];if(Array.isArray(e))throw new a("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:i});e&&(f.contextUrl=e.target)}if(p.statusCode>=300&&p.statusCode<400&&p.headers.location){if(s.length===u)throw new a("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:i,httpStatusCode:p.statusCode,redirects:s});if(-1!==s.indexOf(i))throw new a("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:i,httpStatusCode:p.statusCode,redirects:s});return s.push(i),r(p.headers.location,s)}s.push(i);return f}(r,[])})}},function(e,t){},function(e,t){},function(e,t,r){"use strict";const{parseLinkHeader:n,buildHeaders:i}=r(10),{LINK_HEADER_REL:o}=r(26),a=r(17),s=r(37),u=/(^|(\r\n))link:/i;e.exports=({secure:e,headers:t={},xhr:r}={headers:{}})=>{return t=i(t),(new s).wrapLoader(async function(i){if(0!==i.indexOf("http:")&&0!==i.indexOf("https:"))throw new a('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:i});if(e&&0!==i.indexOf("https"))throw new a('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:i});let s;try{s=await function(e,t,r){const n=new(e=e||XMLHttpRequest);return new Promise((e,i)=>{n.onload=()=>e(n),n.onerror=e=>i(e),n.open("GET",t,!0);for(const e in r)n.setRequestHeader(e,r[e]);n.send()})}(r,i,t)}catch(e){throw new a("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:i,cause:e})}if(s.status>=400)throw new a("URL could not be dereferenced: "+s.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:i,httpStatusCode:s.status});const c={contextUrl:null,documentUrl:i,document:s.response},l=s.getResponseHeader("Content-Type");let h;u.test(s.getAllResponseHeaders())&&(h=s.getResponseHeader("Link"));if(h&&"application/ld+json"!==l){if(h=n(h)[o],Array.isArray(h))throw new a("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:i});h&&(c.contextUrl=h.target)}return c})}},function(e,t,r){"use strict";e.exports=e=>{class t{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(t,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(t.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:t}),t.compact=function(t,r){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):e.compact(t,r)},t.expand=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):e.expand(t)},t.flatten=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):e.flatten(t)},t}},function(e,t,r){var n={"./N3Lexer":38,"./N3Lexer.js":38,"./N3Parser":39,"./N3Parser.js":39,"./N3Store":53,"./N3Store.js":53,"./N3StreamParser":54,"./N3StreamParser.js":54,"./N3StreamWriter":62,"./N3StreamWriter.js":62,"./N3Util":40,"./N3Util.js":40,"./N3Writer":45,"./N3Writer.js":45};function i(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id=94},function(e,t){},function(e,t,r){"use strict";var n=r(43).Buffer,i=r(97);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t,r,i,o=n.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,r=o,i=s,t.copy(r,i),s+=a.data.length,a=a.next;return o},e}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,r){(function(t){function r(e){try{if(!t.localStorage)return!1}catch(e){return!1}var r=t.localStorage[e];return null!=r&&"true"===String(r).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(this,r(18))},function(e,t,r){var n=r(25),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(o(n,t),t.Buffer=a),a.prototype=Object.create(i.prototype),o(i,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t,r){"use strict";e.exports=o;var n=r(60),i=r(28);function o(e){if(!(this instanceof o))return new o(e);n.call(this,e)}i.inherits=r(22),i.inherits(o,n),o.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){e.exports=r(44)},function(e,t,r){e.exports=r(21)},function(e,t,r){e.exports=r(42).Transform},function(e,t,r){e.exports=r(42).PassThrough},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){var n=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r,n){var i=t&&t.prototype instanceof g?t:g,o=Object.create(i.prototype),a=new N(n||[]);return o._invoke=function(e,t,r){var n=l;return function(i,o){if(n===f)throw new Error("Generator is already running");if(n===d){if("throw"===i)throw o;return E()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=k(a,r);if(s){if(s===p)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var u=c(e,t,r);if("normal"===u.type){if(n=r.done?d:h,u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=d,r.method="throw",r.arg=u.arg)}}}(e,r,a),o}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var l="suspendedStart",h="suspendedYield",f="executing",d="completed",p={};function g(){}function y(){}function v(){}var m={};m[o]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(j([])));w&&w!==r&&n.call(w,o)&&(m=w);var x=v.prototype=g.prototype=Object.create(m);function _(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function T(e){var t;this._invoke=function(r,i){function o(){return new Promise(function(t,o){!function t(r,i,o,a){var s=c(e[r],e,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&n.call(l,"__await")?Promise.resolve(l.__await).then(function(e){t("next",e,o,a)},function(e){t("throw",e,o,a)}):Promise.resolve(l).then(function(e){u.value=e,o(u)},function(e){return t("throw",e,o,a)})}a(s.arg)}(r,i,t,o)})}return t=t?t.then(o,o):o()}}function k(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method))return p;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=c(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,p;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function j(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:E}}function E(){return{value:t,done:!0}}return y.prototype=x.constructor=v,v.constructor=y,v[s]=y.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},_(T.prototype),T.prototype[a]=function(){return this},e.AsyncIterator=T,e.async=function(t,r,n,i){var o=new T(u(t,r,n,i));return e.isGeneratorFunction(r)?o:o.next().then(function(e){return e.done?e.value:o.next()})},_(x),x[s]="Generator",x[o]=function(){return this},x.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=j,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;I(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:j(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"convertToJson",function(){return ft}),r.d(n,"convertToNQuads",function(){return dt});var i=r(1),o=r.n(i),a=r(4),s=r.n(a),u=r(6),c=r.n(u),l=r(7),h=r.n(l),f=r(8),d=r.n(f),p=r(12),g=r(9),y=function(e){function t(e){var r;if(o()(this,t),(r=c()(this,h()(t).call(this))).termType=t.termType,e){if("string"!=typeof e)throw console.log("Bad blank id:",e),new Error("Bad id argument to new blank node: "+e);if(e.includes("#")){var n=e.split("#");e=n[n.length-1]}r.id=e}else r.id="n"+t.nextId++;return r.value=r.id,r}return d()(t,e),s()(t,[{key:"compareTerm",value:function(e){return this.classOrder<e.classOrder?-1:this.classOrder>e.classOrder?1:this.id<e.id?-1:this.id>e.id?1:0}},{key:"copy",value:function(e){var r=new t;return e.copyTo(this,r),r}},{key:"toCanonical",value:function(){return"_:"+this.value}},{key:"toString",value:function(){return t.NTAnonymousNodePrefix+this.id}}]),t}(g.a);y.nextId=0,y.termType="BlankNode",y.NTAnonymousNodePrefix="_:",y.prototype.classOrder=p.a.BlankNode,y.prototype.isBlank=1,y.prototype.isVar=1;var v=function(e){function t(e){var r;return o()(this,t),(r=c()(this,h()(t).call(this))).termType=t.termType,r.id=y.nextId++,r.elements=[],r.closed=!1,e&&e.length>0&&e.forEach(function(e){r.elements.push(g.a.fromValue(e))}),r}return d()(t,e),s()(t,[{key:"append",value:function(e){return this.elements.push(e)}},{key:"close",value:function(){return this.closed=!0,this.closed}},{key:"shift",value:function(){return this.elements.shift()}},{key:"substitute",value:function(e){return new t(this.elements.map(function(t){t.substitute(e)}))}},{key:"toNT",value:function(){return y.NTAnonymousNodePrefix+this.id}},{key:"toString",value:function(){return"("+this.elements.join(" ")+")"}},{key:"unshift",value:function(e){return this.elements.unshift(e)}}]),t}(g.a);function m(e){return function(...t){var r=t.pop();return e.call(this,t,r)}}v.termType="Collection",v.prototype.classOrder=p.a.Collection,v.prototype.compareTerm=y.prototype.compareTerm,v.prototype.isVar=0;var b="function"==typeof setImmediate&&setImmediate,w="object"==typeof process&&"function"==typeof process.nextTick;function x(e){setTimeout(e,0)}function _(e){return(t,...r)=>e(()=>t(...r))}var T=_(b?setImmediate:w?process.nextTick:x);function k(e){return N(e)?function(...t){const r=t.pop();return S(e.apply(this,t),r)}:m(function(t,r){var n;try{n=e.apply(this,t)}catch(e){return r(e)}if(n&&"function"==typeof n.then)return S(n,r);r(null,n)})}function S(e,t){return e.then(e=>{I(t,null,e)},e=>{I(t,e&&e.message?e:new Error(e))})}function I(e,t,r){try{e(t,r)}catch(e){T(e=>{throw e},e)}}function N(e){return"AsyncFunction"===e[Symbol.toStringTag]}function j(e){if("function"!=typeof e)throw new Error("expected a function");return N(e)?k(e):e}function E(e,t=e.length){if(!t)throw new Error("arity is undefined");function r(...r){return"function"==typeof r[t-1]?e.apply(this,r):new Promise((n,i)=>{r[t-1]=(e,...t)=>{if(e)return i(e);n(t.length>1?t:t[0])},e.apply(this,r)})}return Object.defineProperty(r,"name",{value:`awaitable(${e.name})`}),r}function O(e){return function(t,...r){return E(function(n){var i=this;return e(t,(e,t)=>{j(e).apply(i,r.concat(t))},n)})}}function C(e,t,r,n){t=t||[];var i=[],o=0,a=j(r);return e(t,(e,t,r)=>{var n=o++;a(e,(e,t)=>{i[n]=t,r(e)})},e=>{n(e,i)})}function R(e){return e&&"number"==typeof e.length&&e.length>=0&&e.length%1==0}const A={};function L(e){function t(...t){if(null!==e){var r=e;e=null,r.apply(this,t)}}return Object.assign(t,e),t}function D(e){if(R(e))return function(e){var t=-1,r=e.length;return function(){return++t<r?{value:e[t],key:t}:null}}(e);var t,r,n,i,o=function(e){return e[Symbol.iterator]&&e[Symbol.iterator]()}(e);return o?function(e){var t=-1;return function(){var r=e.next();return r.done?null:(t++,{value:r.value,key:t})}}(o):(r=(t=e)?Object.keys(t):[],n=-1,i=r.length,function(){var e=r[++n];return n<i?{value:t[e],key:e}:null})}function M(e){return function(...t){if(null===e)throw new Error("Callback was already called.");var r=e;e=null,r.apply(this,t)}}function U(e,t,r,n){let i=!1,o=!1,a=!1,s=0,u=0;function c(){s>=t||a||i||(a=!0,e.next().then(({value:e,done:t})=>{if(!o&&!i){if(a=!1,t)return i=!0,void(s<=0&&n(null));s++,r(e,u,l),u++,c()}}).catch(h))}function l(e,t){if(s-=1,!o)return e?h(e):!1===e?(i=!0,void(o=!0)):t===A||i&&s<=0?(i=!0,n(null)):void c()}function h(e){o||(a=!1,i=!0,n(e))}c()}var P=e=>(t,r,n)=>{if(n=L(n),e<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!t)return n(null);if(function(e){return"AsyncGenerator"===e[Symbol.toStringTag]}(t))return U(t,e,r,n);if(function(e){return"function"==typeof e[Symbol.asyncIterator]}(t))return U(t[Symbol.asyncIterator](),e,r,n);var i=D(t),o=!1,a=!1,s=0,u=!1;function c(e,t){if(!a)if(s-=1,e)o=!0,n(e);else if(!1===e)o=!0,a=!0;else{if(t===A||o&&s<=0)return o=!0,n(null);u||l()}}function l(){for(u=!0;s<e&&!o;){var t=i();if(null===t)return o=!0,void(s<=0&&n(null));s+=1,r(t.value,t.key,M(c))}u=!1}l()};var B=E(function(e,t,r,n){return P(t)(e,j(r),n)},4);function F(e,t,r){r=L(r);var n=0,i=0,{length:o}=e,a=!1;function s(e,t){!1===e&&(a=!0),!0!==a&&(e?r(e):++i!==o&&t!==A||r(null))}for(0===o&&r(null);n<o;n++)t(e[n],n,M(s))}function q(e,t,r){return B(e,1/0,t,r)}var z=E(function(e,t,r){return(R(e)?F:q)(e,j(t),r)},3);var H=E(function(e,t,r){return C(z,e,t,r)},3),V=O(H);var X=E(function(e,t,r){return B(e,1,t,r)},3);var W=E(function(e,t,r){return C(X,e,t,r)},3),G=O(W);const J=Symbol("promiseCallback");function Q(){let e,t;function r(r,...n){if(r)return t(r);e(n.length>1?n:n[0])}return r[J]=new Promise((r,n)=>{e=r,t=n}),r}function Y(e,t,r){"number"!=typeof t&&(r=t,t=null),r=L(r||Q());var n=Object.keys(e).length;if(!n)return r(null);t||(t=n);var i={},o=0,a=!1,s=!1,u=Object.create(null),c=[],l=[],h={};function f(e,t){c.push(()=>(function(e,t){if(s)return;var n=M((t,...n)=>{if(o--,!1!==t)if(n.length<2&&([n]=n),t){var c={};if(Object.keys(i).forEach(e=>{c[e]=i[e]}),c[e]=n,s=!0,u=Object.create(null),a)return;r(t,c)}else i[e]=n,function(e){(u[e]||[]).forEach(e=>e()),d()}(e);else a=!0});o++;var c=j(t[t.length-1]);t.length>1?c(i,n):c(n)})(e,t))}function d(){if(!a){if(0===c.length&&0===o)return r(null,i);for(;c.length&&o<t;){c.shift()()}}}function p(t){var r=[];return Object.keys(e).forEach(n=>{const i=e[n];Array.isArray(i)&&i.indexOf(t)>=0&&r.push(n)}),r}return Object.keys(e).forEach(t=>{var r=e[t];if(!Array.isArray(r))return f(t,[r]),void l.push(t);var n=r.slice(0,r.length-1),i=n.length;if(0===i)return f(t,r),void l.push(t);h[t]=i,n.forEach(o=>{if(!e[o])throw new Error("async.auto task `"+t+"` has a non-existent dependency `"+o+"` in "+n.join(", "));!function(e,t){var r=u[e];r||(r=u[e]=[]);r.push(t)}(o,()=>{0===--i&&f(t,r)})})}),function(){var e,t=0;for(;l.length;)e=l.pop(),t++,p(e).forEach(e=>{0==--h[e]&&l.push(e)});if(t!==n)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),d(),r[J]}var $=/^(?:async\s+)?(?:function)?\s*\w*\s*\(\s*([^)]+)\s*\)(?:\s*{)/,Z=/^(?:async\s+)?\(?\s*([^)=]+)\s*\)?(?:\s*=>)/,K=/,/,ee=/(=.+)?(\s*)$/,te=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;class re{constructor(){this.head=this.tail=null,this.length=0}removeLink(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e}empty(){for(;this.head;)this.shift();return this}insertAfter(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1}insertBefore(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1}unshift(e){this.head?this.insertBefore(this.head,e):ne(this,e)}push(e){this.tail?this.insertAfter(this.tail,e):ne(this,e)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var e=this.head;e;)yield e.data,e=e.next}remove(e){for(var t=this.head;t;){var{next:r}=t;e(t)&&this.removeLink(t),t=r}return this}}function ne(e,t){e.length=1,e.head=e.tail=t}function ie(e,t,r){if(null==t)t=1;else if(0===t)throw new RangeError("Concurrency must not be zero");var n=j(e),i=0,o=[];const a={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function s(e,t){return e?t?void(a[e]=a[e].filter(e=>e!==t)):a[e]=[]:Object.keys(a).forEach(e=>a[e]=[])}function u(e,...t){a[e].forEach(e=>e(...t))}var c=!1;function l(e,t,r,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");var i,o;function a(e,...t){return e?r?o(e):i():t.length<=1?i(t[0]):void i(t)}g.started=!0;var s={data:e,callback:r?a:n||a};if(t?g._tasks.unshift(s):g._tasks.push(s),c||(c=!0,T(()=>{c=!1,g.process()})),r||!n)return new Promise((e,t)=>{i=e,o=t})}function h(e){return function(t,...r){i-=1;for(var n=0,a=e.length;n<a;n++){var s=e[n],c=o.indexOf(s);0===c?o.shift():c>0&&o.splice(c,1),s.callback(t,...r),null!=t&&u("error",t,s.data)}i<=g.concurrency-g.buffer&&u("unsaturated"),g.idle()&&u("drain"),g.process()}}function f(e){return!(0!==e.length||!g.idle())&&(T(()=>u("drain")),!0)}const d=e=>t=>{if(!t)return new Promise((t,r)=>{!function(e,t){const r=(...n)=>{s(e,r),t(...n)};a[e].push(r)}(e,(e,n)=>{if(e)return r(e);t(n)})});s(e),function(e,t){a[e].push(t)}(e,t)};var p=!1,g={_tasks:new re,*[Symbol.iterator](){yield*g._tasks[Symbol.iterator]()},concurrency:t,payload:r,buffer:t/4,started:!1,paused:!1,push(e,t){if(Array.isArray(e)){if(f(e))return;return e.map(e=>l(e,!1,!1,t))}return l(e,!1,!1,t)},pushAsync(e,t){if(Array.isArray(e)){if(f(e))return;return e.map(e=>l(e,!1,!0,t))}return l(e,!1,!0,t)},kill(){s(),g._tasks.empty()},unshift(e,t){if(Array.isArray(e)){if(f(e))return;return e.map(e=>l(e,!0,!1,t))}return l(e,!0,!1,t)},unshiftAsync(e,t){if(Array.isArray(e)){if(f(e))return;return e.map(e=>l(e,!0,!0,t))}return l(e,!0,!0,t)},remove(e){g._tasks.remove(e)},process(){if(!p){for(p=!0;!g.paused&&i<g.concurrency&&g._tasks.length;){var e=[],t=[],r=g._tasks.length;g.payload&&(r=Math.min(r,g.payload));for(var a=0;a<r;a++){var s=g._tasks.shift();e.push(s),o.push(s),t.push(s.data)}i+=1,0===g._tasks.length&&u("empty"),i===g.concurrency&&u("saturated");var c=M(h(e));n(t,c)}p=!1}},length:()=>g._tasks.length,running:()=>i,workersList:()=>o,idle:()=>g._tasks.length+i===0,pause(){g.paused=!0},resume(){!1!==g.paused&&(g.paused=!1,T(g.process))}};return Object.defineProperties(g,{saturated:{writable:!1,value:d("saturated")},unsaturated:{writable:!1,value:d("unsaturated")},empty:{writable:!1,value:d("empty")},drain:{writable:!1,value:d("drain")},error:{writable:!1,value:d("error")}}),g}var oe=E(function(e,t,r,n){n=L(n);var i=j(r);return X(e,(e,r,n)=>{i(t,e,(e,r)=>{t=r,n(e)})},e=>n(e,t))},4);function ae(...e){var t=e.map(j);return function(...e){var r=this,n=e[e.length-1];return"function"==typeof n?e.pop():n=Q(),oe(t,e,(e,t,n)=>{t.apply(r,e.concat((e,...t)=>{n(e,t)}))},(e,t)=>n(e,...t)),n[J]}}var se=E(function(e,t,r,n){return C(P(t),e,r,n)},4);var ue=E(function(e,t,r,n){var i=j(r);return se(e,t,(e,t)=>{i(e,(e,...r)=>e?t(e):t(e,r))},(e,t)=>{for(var r=[],i=0;i<t.length;i++)t[i]&&(r=r.concat(...t[i]));return n(e,r)})},4);var ce=E(function(e,t,r){return ue(e,1/0,t,r)},3);var le=E(function(e,t,r){return ue(e,1,t,r)},3);function he(e,t){return(r,n,i,o)=>{var a,s=!1;const u=j(i);r(n,(r,n,i)=>{u(r,(n,o)=>n||!1===n?i(n):e(o)&&!a?(s=!0,a=t(!0,r),i(null,A)):void i())},e=>{if(e)return o(e);o(null,s?a:t(!1))})}}var fe=E(function(e,t,r){return he(e=>e,(e,t)=>t)(z,e,t,r)},3);var de=E(function(e,t,r,n){return he(e=>e,(e,t)=>t)(P(t),e,r,n)},4);var pe=E(function(e,t,r){return he(e=>e,(e,t)=>t)(P(1),e,t,r)},3);function ge(e){return(t,...r)=>j(t)(...r,(t,...r)=>{"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&r.forEach(t=>console[e](t)))})}var ye=ge("dir");var ve=E(function(e,t,r){r=M(r);var n,i=j(e),o=j(t);function a(e,...t){if(e)return r(e);!1!==e&&(n=t,o(...t,s))}function s(e,t){return e?r(e):!1!==e?t?void i(a):r(null,...n):void 0}return s(null,!0)},3);function me(e){return(t,r,n)=>e(t,n)}var be=E(function(e,t,r){return z(e,me(j(t)),r)},3);var we=E(function(e,t,r,n){return P(t)(e,me(j(r)),n)},4);var xe=E(function(e,t,r){return we(e,1,t,r)},3);function _e(e){return N(e)?e:function(...t){var r=t.pop(),n=!0;t.push((...e)=>{n?T(()=>r(...e)):r(...e)}),e.apply(this,t),n=!1}}var Te=E(function(e,t,r){return he(e=>!e,e=>!e)(z,e,t,r)},3);var ke=E(function(e,t,r,n){return he(e=>!e,e=>!e)(P(t),e,r,n)},4);var Se=E(function(e,t,r){return he(e=>!e,e=>!e)(X,e,t,r)},3);function Ie(e,t,r,n){var i=new Array(t.length);e(t,(e,t,n)=>{r(e,(e,r)=>{i[t]=!!r,n(e)})},e=>{if(e)return n(e);for(var r=[],o=0;o<t.length;o++)i[o]&&r.push(t[o]);n(null,r)})}function Ne(e,t,r,n){var i=[];e(t,(e,t,n)=>{r(e,(r,o)=>{if(r)return n(r);o&&i.push({index:t,value:e}),n(r)})},e=>{if(e)return n(e);n(null,i.sort((e,t)=>e.index-t.index).map(e=>e.value))})}function je(e,t,r,n){return(R(t)?Ie:Ne)(e,t,j(r),n)}var Ee=E(function(e,t,r){return je(z,e,t,r)},3);var Oe=E(function(e,t,r,n){return je(P(t),e,r,n)},4);var Ce=E(function(e,t,r){return je(X,e,t,r)},3);var Re=E(function(e,t){var r=M(t),n=j(_e(e));return function e(t){if(t)return r(t);!1!==t&&n(e)}()},2);var Ae=E(function(e,t,r,n){var i=j(r);return se(e,t,(e,t)=>{i(e,(r,n)=>r?t(r):t(r,{key:n,val:e}))},(e,t)=>{for(var r={},{hasOwnProperty:i}=Object.prototype,o=0;o<t.length;o++)if(t[o]){var{key:a}=t[o],{val:s}=t[o];i.call(r,a)?r[a].push(s):r[a]=[s]}return n(e,r)})},4);var Le=ge("log");var De=E(function(e,t,r,n){n=L(n);var i={},o=j(r);return P(t)(e,(e,t,r)=>{o(e,t,(e,n)=>{if(e)return r(e);i[t]=n,r(e)})},e=>n(e,i))},4);var Me=_(w?process.nextTick:b?setImmediate:x),Ue=E((e,t,r)=>{var n=R(t)?[]:{};e(t,(e,t,r)=>{j(e)((e,...i)=>{i.length<2&&([i]=i),n[t]=i,r(e)})},e=>r(e,n))},3);function Pe(e,t){var r=j(e);return ie((e,t)=>{r(e[0],t)},t,1)}class Be{constructor(){this.heap=[],this.pushCount=Number.MIN_SAFE_INTEGER}get length(){return this.heap.length}empty(){return this.heap=[],this}percUp(e){let t;for(;e>0&&qe(this.heap[e],this.heap[t=Fe(e)]);){let r=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=r,e=t}}percDown(e){let t;for(;(t=1+(e<<1))<this.heap.length&&(t+1<this.heap.length&&qe(this.heap[t+1],this.heap[t])&&(t+=1),!qe(this.heap[e],this.heap[t]));){let r=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=r,e=t}}push(e){e.pushCount=++this.pushCount,this.heap.push(e),this.percUp(this.heap.length-1)}unshift(e){return this.heap.push(e)}shift(){let[e]=this.heap;return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.percDown(0),e}toArray(){return[...this]}*[Symbol.iterator](){for(let e=0;e<this.heap.length;e++)yield this.heap[e].data}remove(e){let t=0;for(let r=0;r<this.heap.length;r++)e(this.heap[r])||(this.heap[t]=this.heap[r],t++);this.heap.splice(t);for(let e=Fe(this.heap.length-1);e>=0;e--)this.percDown(e);return this}}function Fe(e){return(e+1>>1)-1}function qe(e,t){return e.priority!==t.priority?e.priority<t.priority:e.pushCount<t.pushCount}var ze=E(function(e,t){if(t=L(t),!Array.isArray(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var r=0,n=e.length;r<n;r++)j(e[r])(t)},2);function He(e,t,r,n){var i=[...e].reverse();return oe(i,t,r,n)}function Ve(e){var t=j(e);return m(function(e,r){return e.push((e,...t)=>{let n={};if(e&&(n.error=e),t.length>0){var i=t;t.length<=1&&([i]=t),n.value=i}r(null,n)}),t.apply(this,e)})}function Xe(e,t,r,n){const i=j(r);return je(e,t,(e,t)=>{i(e,(e,r)=>{t(e,!r)})},n)}var We=E(function(e,t,r){return Xe(z,e,t,r)},3);var Ge=E(function(e,t,r,n){return Xe(P(t),e,r,n)},4);var Je=E(function(e,t,r){return Xe(X,e,t,r)},3);function Qe(e){return function(){return e}}const Ye=5,$e=0;function Ze(e,t,r){var n={times:Ye,intervalFunc:Qe($e)};if(arguments.length<3&&"function"==typeof e?(r=t||Q(),t=e):(!function(e,t){if("object"==typeof t)e.times=+t.times||Ye,e.intervalFunc="function"==typeof t.interval?t.interval:Qe(+t.interval||$e),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||Ye}}(n,e),r=r||Q()),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var i=j(t),o=1;return function e(){i((t,...i)=>{!1!==t&&(t&&o++<n.times&&("function"!=typeof n.errorFilter||n.errorFilter(t))?setTimeout(e,n.intervalFunc(o-1)):r(t,...i))})}(),r[J]}var Ke=E(function(e,t,r){return he(Boolean,e=>e)(z,e,t,r)},3);var et=E(function(e,t,r,n){return he(Boolean,e=>e)(P(t),e,r,n)},4);var tt=E(function(e,t,r){return he(Boolean,e=>e)(X,e,t,r)},3);var rt=E(function(e,t,r){var n=j(t);return H(e,(e,t)=>{n(e,(r,n)=>{if(r)return t(r);t(r,{value:e,criteria:n})})},(e,t)=>{if(e)return r(e);r(null,t.sort(i).map(e=>e.value))});function i(e,t){var r=e.criteria,n=t.criteria;return r<n?-1:r>n?1:0}},3);function nt(e,t,r,n){var i=j(r);return se(function(e){for(var t=Array(e);e--;)t[e]=e;return t}(e),t,i,n)}var it=E(function(e,t){var r,n=null;return xe(e,(e,t)=>{j(e)((e,...i)=>{if(!1===e)return t(e);i.length<2?[r]=i:r=i,n=e,t(e?null:{})})},()=>t(n,r))});var ot=E(function(e,t,r){r=M(r);var n=j(t),i=j(e),o=[];function a(e,...t){if(e)return r(e);o=t,!1!==e&&i(s)}function s(e,t){return e?r(e):!1!==e?t?void n(a):r(null,...o):void 0}return i(s)},3);var at=E(function(e,t){if(t=L(t),!Array.isArray(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var r=0;function n(t){j(e[r++])(...t,M(i))}function i(i,...o){if(!1!==i)return i||r===e.length?t(i,...o):void n(o)}n([])}),st={apply:function(e,...t){return(...r)=>e(...t,...r)},applyEach:V,applyEachSeries:G,asyncify:k,auto:Y,autoInject:function(e,t){var r={};return Object.keys(e).forEach(t=>{var n,i=e[t],o=N(i),a=!o&&1===i.length||o&&0===i.length;if(Array.isArray(i))n=[...i],i=n.pop(),r[t]=n.concat(n.length>0?s:i);else if(a)r[t]=i;else{if(n=function(e){const t=e.toString().replace(te,"");let r=t.match($);if(r||(r=t.match(Z)),!r)throw new Error("could not parse args in autoInject\nSource:\n"+t);let[,n]=r;return n.replace(/\s/g,"").split(K).map(e=>e.replace(ee,"").trim())}(i),0===i.length&&!o&&0===n.length)throw new Error("autoInject task functions require explicit parameters.");o||n.pop(),r[t]=n.concat(s)}function s(e,t){var r=n.map(t=>e[t]);r.push(t),j(i)(...r)}}),Y(r,t)},cargo:function(e,t){return ie(e,1,t)},cargoQueue:function(e,t,r){return ie(e,t,r)},compose:function(...e){return ae(...e.reverse())},concat:ce,concatLimit:ue,concatSeries:le,constant:function(...e){return function(...t){return t.pop()(null,...e)}},detect:fe,detectLimit:de,detectSeries:pe,dir:ye,doUntil:function(e,t,r){const n=j(t);return ve(e,(...e)=>{const t=e.pop();n(...e,(e,r)=>t(e,!r))},r)},doWhilst:ve,each:be,eachLimit:we,eachOf:z,eachOfLimit:B,eachOfSeries:X,eachSeries:xe,ensureAsync:_e,every:Te,everyLimit:ke,everySeries:Se,filter:Ee,filterLimit:Oe,filterSeries:Ce,forever:Re,groupBy:function(e,t,r){return Ae(e,1/0,t,r)},groupByLimit:Ae,groupBySeries:function(e,t,r){return Ae(e,1,t,r)},log:Le,map:H,mapLimit:se,mapSeries:W,mapValues:function(e,t,r){return De(e,1/0,t,r)},mapValuesLimit:De,mapValuesSeries:function(e,t,r){return De(e,1,t,r)},memoize:function(e,t=(e=>e)){var r=Object.create(null),n=Object.create(null),i=j(e),o=m((e,o)=>{var a=t(...e);a in r?T(()=>o(null,...r[a])):a in n?n[a].push(o):(n[a]=[o],i(...e,(e,...t)=>{e||(r[a]=t);var i=n[a];delete n[a];for(var o=0,s=i.length;o<s;o++)i[o](e,...t)}))});return o.memo=r,o.unmemoized=e,o},nextTick:Me,parallel:function(e,t){return Ue(z,e,t)},parallelLimit:function(e,t,r){return Ue(P(t),e,r)},priorityQueue:function(e,t){var r=Pe(e,t);return r._tasks=new Be,r.push=function(e,t=0,n=(()=>{})){if("function"!=typeof n)throw new Error("task callback must be a function");if(r.started=!0,Array.isArray(e)||(e=[e]),0===e.length&&r.idle())return T(()=>r.drain());for(var i=0,o=e.length;i<o;i++){var a={data:e[i],priority:t,callback:n};r._tasks.push(a)}T(r.process)},delete r.unshift,r},queue:Pe,race:ze,reduce:oe,reduceRight:He,reflect:Ve,reflectAll:function(e){var t;return Array.isArray(e)?t=e.map(Ve):(t={},Object.keys(e).forEach(r=>{t[r]=Ve.call(this,e[r])})),t},reject:We,rejectLimit:Ge,rejectSeries:Je,retry:Ze,retryable:function(e,t){t||(t=e,e=null);let r=e&&e.arity||t.length;N(t)&&(r+=1);var n=j(t);return m((t,i)=>{function o(e){n(...t,e)}return(t.length<r-1||null==i)&&(t.push(i),i=Q()),e?Ze(e,o,i):Ze(o,i),i[J]})},seq:ae,series:function(e,t){return Ue(X,e,t)},setImmediate:T,some:Ke,someLimit:et,someSeries:tt,sortBy:rt,timeout:function(e,t,r){var n=j(e);return m((i,o)=>{var a,s=!1;i.push((...e)=>{s||(o(...e),clearTimeout(a))}),a=setTimeout(function(){var t=e.name||"anonymous",n=new Error('Callback function "'+t+'" timed out.');n.code="ETIMEDOUT",r&&(n.info=r),s=!0,o(n)},t),n(...i)})},times:function(e,t,r){return nt(e,1/0,t,r)},timesLimit:nt,timesSeries:function(e,t,r){return nt(e,1,t,r)},transform:function(e,t,r,n){arguments.length<=3&&"function"==typeof t&&(n=r,r=t,t=Array.isArray(e)?[]:{}),n=L(n||Q());var i=j(r);return z(e,(e,r,n)=>{i(t,e,r,n)},e=>n(e,t)),n[J]},tryEach:it,unmemoize:function(e){return(...t)=>(e.unmemoized||e)(...t)},until:function(e,t,r){const n=j(e);return ot(e=>n((t,r)=>e(t,!r)),t,r)},waterfall:at,whilst:ot,all:Te,allLimit:ke,allSeries:Se,any:Ke,anyLimit:et,anySeries:tt,find:fe,findLimit:de,findSeries:pe,flatMap:ce,flatMapLimit:ue,flatMapSeries:le,forEach:be,forEachSeries:xe,forEachLimit:we,forEachOf:z,forEachOfSeries:X,forEachOfLimit:B,inject:oe,foldl:oe,foldr:He,select:Ee,selectLimit:Oe,selectSeries:Ce,wrapSync:k,during:ot,doDuring:ve},ut=r(32),ct=r.n(ut),lt=r(11),ht=r.n(lt);function ft(e,t){var r,n=ht.a.Parser(),i=ht.a.Writer({format:"N-Quads"});st.waterfall([function(t){n.parse(e,t)},function(e,t,r){null!==e&&i.addTriple(e),"function"==typeof r&&i.end(r)},function(e,t){try{ct.a.fromRDF(e,{format:"application/nquads"},t)}catch(e){t(e)}},function(e,n){r=JSON.stringify(e),t(null,r)}],function(e,n){t(e,r)})}function dt(e,t){var r,n=ht.a.Parser(),i=ht.a.Writer({format:"N-Quads"});st.waterfall([function(t){n.parse(e,t)},function(e,t,r){null!==e&&i.addTriple(e),"function"==typeof r&&i.end(r)},function(e,n){t(null,r=e)}],function(e,n){t(e,r)})}var pt=r(14),gt=r.n(pt),yt=r(5),vt=function e(){o()(this,e)};vt.boolean=new yt.a("http://www.w3.org/2001/XMLSchema#boolean"),vt.dateTime=new yt.a("http://www.w3.org/2001/XMLSchema#dateTime"),vt.decimal=new yt.a("http://www.w3.org/2001/XMLSchema#decimal"),vt.double=new yt.a("http://www.w3.org/2001/XMLSchema#double"),vt.integer=new yt.a("http://www.w3.org/2001/XMLSchema#integer"),vt.langString=new yt.a("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),vt.string=new yt.a("http://www.w3.org/2001/XMLSchema#string");var mt=function(e){function t(e,r,n){var i;return o()(this,t),(i=c()(this,h()(t).call(this))).termType=t.termType,i.value=e,r&&(i.lang=r,n=vt.langString),n&&(i.datatype=yt.a.fromValue(n)),i}return d()(t,e),s()(t,[{key:"copy",value:function(){return new t(this.value,this.lang,this.datatype)}},{key:"equals",value:function(e){return!!e&&(this.termType===e.termType&&this.value===e.value&&this.language===e.language&&(!this.datatype&&!e.datatype||this.datatype&&this.datatype.equals(e.datatype)))}},{key:"toNT",value:function(){if("number"==typeof this.value)return this.toString();if("string"!=typeof this.value)throw new Error("Value of RDF literal is not string or number: "+this.value);var e=this.value;return e='"'+(e=(e=(e=e.replace(/\\/g,"\\\\")).replace(/\"/g,'\\"')).replace(/\n/g,"\\n"))+'"',this.language?e+="@"+this.language:this.datatype.equals(vt.string)||(e+="^^"+this.datatype.toCanonical()),e}},{key:"toString",value:function(){return""+this.value}},{key:"language",get:function(){return this.lang},set:function(e){this.lang=e||""}}],[{key:"fromBoolean",value:function(e){return new t(e?"1":"0",null,vt.boolean)}},{key:"fromDate",value:function(e){if(!(e instanceof Date))throw new TypeError("Invalid argument to Literal.fromDate()");var r=function(e){return(""+(100+e)).slice(1,3)};return new t(e.getUTCFullYear()+"-"+r(e.getUTCMonth()+1)+"-"+r(e.getUTCDate())+"T"+r(e.getUTCHours())+":"+r(e.getUTCMinutes())+":"+r(e.getUTCSeconds())+"Z",null,vt.dateTime)}},{key:"fromNumber",value:function(e){if("number"!=typeof e)throw new TypeError("Invalid argument to Literal.fromNumber()");var r,n=e.toString();return r=n.indexOf("e")<0&&Math.abs(e)<=Number.MAX_SAFE_INTEGER?Number.isInteger(e)?vt.integer:vt.decimal:vt.double,new t(n,null,r)}},{key:"fromValue",value:function(e){if(null==e)return e;if("object"===gt()(e)&&e.termType)return e;switch(gt()(e)){case"object":if(e instanceof Date)return t.fromDate(e);case"boolean":return t.fromBoolean(e);case"number":return t.fromNumber(e);case"string":return new t(e)}throw new Error("Can't make literal from "+e+" of type "+gt()(e))}}]),t}(g.a);function bt(e){return function(t){return new yt.a(e+(t||""))}}mt.termType="Literal",mt.prototype.classOrder=p.a.Literal,mt.prototype.datatype=vt.string,mt.prototype.lang="",mt.prototype.isVar=0;var wt=g.a;g.a.fromValue=function(e){return null==e?e:e&&e.termType?e:Array.isArray(e)?new v(e):mt.fromValue(e)};var xt={xsd:bt("http://www.w3.org/2001/XMLSchema#")};g.a.toJS=function(e){if(e.elements)return e.elements.map(g.a.toJS);if(!e.datatype)return e;if(e.datatype.sameTerm(xt.xsd("boolean")))return"1"===e.value;if(e.datatype.sameTerm(xt.xsd("dateTime"))||e.datatype.sameTerm(xt.xsd("date")))return new Date(e.value);if(e.datatype.sameTerm(xt.xsd("integer"))||e.datatype.sameTerm(xt.xsd("float"))||e.datatype.sameTerm(xt.xsd("decimal"))){Number(e.value);return Number(e.value)}return e.value};var _t=function(e){function t(){var e;return o()(this,t),(e=c()(this,h()(t).call(this))).termType="DefaultGraph",e.value="",e}return d()(t,e),s()(t,[{key:"toCanonical",value:function(){return this.value}}]),t}(wt),Tt=r(46),kt=r.n(Tt),St=r(63),It=r.n(St),Nt=r(3),jt=r(0),Et=r(2),Ot=function(){var e=function(e){this.flags="",this.base=null,this.prefixes=[],this.namespaces=[],this.suggestPrefix("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),this.suggestPrefix("xml","reserved:reservedForFutureUse"),this.namespacesUsed=[],this.keywords=["a"],this.prefixchars="abcdefghijklmnopqustuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",this.incoming=null,this.formulas=[],this.store=e};e.prototype.setBase=function(e){return this.base=e,this},e.prototype.setFlags=function(e){return this.flags=e||"",this},e.prototype.toStr=function(e){var t=e.toNT();return"Graph"===e.termType&&(this.formulas[t]=e),t},e.prototype.fromStr=function(e){if("{"===e[0]){var t=this.formulas[e];return t||console.log("No formula object for "+e),t}return this.store.fromNT(e)},e.prototype.suggestPrefix=function(e,t){"default"!==e.slice(0,7)&&"ns"!==e.slice(0,2)&&e&&t&&(e in this.namespaces||t in this.prefixes||(this.prefixes[t]=e,this.namespaces[e]=t))},e.prototype.suggestNamespaces=function(e){for(var t in e)return this.suggestPrefix(t,e[t]),this},e.prototype.checkIntegrity=function(){var e,t;for(e in this.namespaces)if(this.prefixes[this.namespaces[e]]!==e)throw new Error("Serializer integity error 1: "+e+", "+this.namespaces[e]+", "+this.prefixes[this.namespaces[e]]+"!");for(t in this.prefixes)if(this.namespaces[this.prefixes[t]]!==t)throw new Error("Serializer integity error 2: "+t+", "+this.prefixs[t]+", "+this.namespaces[this.prefixes[t]]+"!")},e.prototype.makeUpPrefix=function(t){var r=t;var n=function(r){return!!e.prototype.validPrefix.test(r)&&("ns"!==r&&(!(r in this.namespaces)&&(this.prefixes[t]=r,this.namespaces[r]=t,r)))}.bind(this);"#/".indexOf(r[r.length-1])>=0&&(r=r.slice(0,-1));var i=r.lastIndexOf("/");i>=0&&(r=r.slice(i+1));for(var o=0;o<r.length&&this.prefixchars.indexOf(r[o]);)o++;if((r=r.slice(0,o)).length<6&&n(r))return r;if(n(r.slice(0,3)))return r.slice(0,3);if(n(r.slice(0,2)))return r.slice(0,2);if(n(r.slice(0,4)))return r.slice(0,4);if(n(r.slice(0,1)))return r.slice(0,1);if(n(r.slice(0,5)))return r.slice(0,5);e.prototype.validPrefix.test(r)||(r="n");for(var a=0;;a++)if(n(r.slice(0,3)+a))return r.slice(0,3)+a},e.prototype.rootSubjects=function(e){for(var t={},r={},n={},i=0;i<e.length;i++){var o=e[i],a=function(e){t.hasOwnProperty(e)||(t[e]=[]),t[e].push(o.subject)};[o.subject,o.predicate,o.object].map(function(e){"BlankNode"===e.termType?n[e.toNT()]=!0:"Collection"===e.termType&&e.elements.forEach(function(e){a(e)})}),a(e[i].object);var s=r[this.toStr(o.subject)];s||(s=[]),s.push(o),r[this.toStr(o.subject)]=s}var u=[];for(var c in r)if(r.hasOwnProperty(c)){var l=this.fromStr(c);"BlankNode"===l.termType&&t[l]&&1===t[l].length||u.push(l)}this.incoming=t;for(var h={},f=0;f<u.length;f++)h[u[f].toNT()]=!0;return{roots:u,subjects:r,rootsHash:h,incoming:t}},e.prototype.toN3=function(e){return this.statementsToN3(e.statements)},e.prototype._notQNameChars="\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~",e.prototype._notNameChars=e.prototype._notQNameChars+":",e.prototype.explicitURI=function(e){return"<"+(e=this.flags.indexOf("r")<0&&this.base?Et.refTo(this.base,e):this.flags.indexOf("u")>=0?function(e){for(var t,r="",n=0;n<e.length;n++)t=e.charCodeAt(n),r+=t>65535?"\\U"+("00000000"+t.toString(16)).slice(-8):t>126?"\\u"+("0000"+t.toString(16)).slice(-4):e[n];return r}(e):encodeURI(e))+">"},e.prototype.statementsToNTriples=function(e){var t=e.slice();t.sort();for(var r="",n="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i=this,o=this.store,a=function e(t){if("Collection"!==t.termType)return i.atomicTermToN3(t);for(var a=t.elements,s=o.sym(n+"nill"),u=a.length-1;u>=0;u--){var c=new y;r+=e(c)+" "+e(o.sym(n+"first"))+" "+e(a[u])+".\n",r+=e(c)+" "+e(o.sym(n+"rest"))+" "+e(s)+".\n",s=c}return i.atomicTermToN3(s)},s=0;s<t.length;s++){var u=t[s],c="";c+=a(u.subject)+" ",c+=a(u.predicate)+" ",c+=a(u.object)+" ",this.flags.indexOf("q")>=0&&(c+=a(u.why)+" "),r+=c+=".\n"}return r},e.prototype.statementsToN3=function(t){var r=this.store,n={"http://www.w3.org/1999/02/22-rdf-syntax-ns#type":"aaa:00"};t.sort(function(e,t){return Nt.heavyCompareSPO(e,t,r,n)}),this.base&&!this.defaultNamespace&&(this.defaultNamespace=this.base+"#");var i={};this.flags.indexOf("s")<0&&(i["http://www.w3.org/2002/07/owl#sameAs"]="="),this.flags.indexOf("t")<0&&(i["http://www.w3.org/1999/02/22-rdf-syntax-ns#type"]="a"),this.flags.indexOf("i")<0&&(i["http://www.w3.org/2000/10/swap/log#implies"]="=>");var o=function(e){for(var t="",r=0;r<e;r++)t+=" ";return t},a=function e(t){for(var r="",n=0;n<t.length;n++){var i=t[n],o="string"==typeof i?i:e(i);if(0!==n){var a=r.slice(-1)||" ";","===o||";"===o||("."!==o||"0123456789.".includes(a))&&(r+=" ")}r+=o}return r};var s=function(e){for(var t=this.rootSubjects(e),r=t.roots,n=[],i=0;i<r.length;i++){var o=r[i];n.push(u(o,t))}return n}.bind(this);function u(e,t){return"BlankNode"!==e.termType||t.incoming[e]?[h(e,t)].concat([c(e,t)]).concat(["."]):l(e,t,!0).concat(["."])}var c=function(e,t){var r=[],n=null,o=t.subjects[this.toStr(e)]||[];if(void 0===o)throw new Error("Cant find statements for "+e);for(var a=[],s=0;s<o.length;s++){var u=o[s];u.predicate.uri===n?a.push(","):(n&&(r=r.concat([a]).concat([";"]),a=[]),r.push(i[u.predicate.uri]?i[u.predicate.uri]:h(u.predicate,t))),n=u.predicate.uri,a.push(l(u.object,t))}return r=r.concat([a])}.bind(this);var l=function(e,t,r){return"BlankNode"!==e.termType||!r&&void 0!==t.rootsHash[e.toNT()]?h(e,t):t.subjects[this.toStr(e)]?["[",c(e,t),"]"]:"[]"}.bind(this);e.prototype.termToN3=h;var h=function(e,t){var r,n;switch(e.termType){case"Graph":return(n=(n=["{"]).concat(s(e.statements))).concat(["}"]);case"Collection":for(n=["("],r=0;r<e.elements.length;r++)n.push([l(e.elements[r],t)]);return n.push(")"),n;default:return this.atomicTermToN3(e)}}.bind(this);var f=function(){var e="";for(var t in this.defaultNamespace&&(e+="@prefix : "+this.explicitURI(this.defaultNamespace)+".\n"),this.prefixes)this.prefixes.hasOwnProperty(t)&&this.namespacesUsed[t]&&(e+="@prefix "+this.prefixes[t]+": "+this.explicitURI(t)+".\n");return e+"\n"}.bind(this),d=s(t);return f()+function e(t,r){var n="",i=1e5;void 0===r&&(r=-1);for(var s=0;s<t.length;s++){var u=t[s];if("string"!=typeof u){var c=e(u,r+1);if(c.length<10*(80-4*r)&&c.indexOf('"""')<0){var l=a(u);l.length<80-4*r&&(u=l,c="")}c&&(i=1e4),n+=c}if("string"==typeof u){if(1===u.length&&"\n"===n.slice(-1)&&",.;".indexOf(u)>=0){n=n.slice(0,-1)+u+"\n",i+=1;continue}if(i<4*r+4||i+u.length+1<80&&";.".indexOf(n[n.length-2])<0)n=n.slice(0,-1)+" "+u+"\n",i+=u.length+1;else{var h=o(4*r)+u;n+=h+"\n",i=h.length,r<0&&(n+="\n",i=1e5)}}}return n}(d)},e.prototype.atomicTermToN3=function(e,t){switch(e.termType){case"BlankNode":case"Variable":return e.toNT();case"Literal":var r=e.value;if("string"!=typeof r)throw new TypeError("Value of RDF literal node must be a string");if(e.datatype&&this.flags.indexOf("x")<0)switch(e.datatype.uri){case"http://www.w3.org/2001/XMLSchema#integer":return r;case"http://www.w3.org/2001/XMLSchema#decimal":return r.indexOf(".")<0&&(r+=".0"),r;case"http://www.w3.org/2001/XMLSchema#double":return r.indexOf(".")<0&&(r+=".0"),r.indexOf("e")<0&&(r+="e0"),r;case"http://www.w3.org/2001/XMLSchema#boolean":return"1"===e.value?"true":"false"}var n=this.stringToN3(e.value);return e.language?n+="@"+e.language:e.datatype.equals(vt.string)||(n+="^^"+this.atomicTermToN3(e.datatype,t)),n;case"NamedNode":return this.symbolToN3(e);default:throw new Error("Internal: atomicTermToN3 cannot handle "+e+" of termType: "+e.termType)}},e.prototype.validPrefix=new RegExp(/^[a-zA-Z][a-zA-Z0-9]*$/),e.prototype.forbidden1=new RegExp(/[\\"\b\f\r\v\t\n\u0080-\uffff]/gm),e.prototype.forbidden3=new RegExp(/[\\"\b\f\r\v\u0080-\uffff]/gm),e.prototype.stringToN3=function(t,r){r||(r="e");var n,i,o,a,s,u="";for(t.length>20&&'"'!==t.slice(-1)&&r.indexOf("n")<0&&(t.indexOf("\n")>0||t.indexOf('"')>0)?(a='"""',s=e.prototype.forbidden3):(a='"',s=e.prototype.forbidden1),n=0;n<t.length;){if(s.lastIndex=0,null==s.exec(t.slice(n)))break;i=n+s.lastIndex-1,u+=t.slice(n,i);var c=t[i];'"'===c&&'"""'===a&&'"""'!==t.slice(i,i+3)?u+=c:(o='\b\f\r\t\v\n\\"'.indexOf(c))>=0?u+="\\"+'bfrtvn\\"'[o]:r.indexOf("e")>=0?u+="\\u"+("000"+c.charCodeAt(0).toString(16).toLowerCase()).slice(-4):u+=c,n=i+1}return a+u+t.slice(n)+a},e.prototype.symbolToN3=function(t){var r=t.uri,n=r.indexOf("#");if(n<0&&this.flags.indexOf("/")<0&&(n=r.lastIndexOf("/")),n>=0&&this.flags.indexOf("p")<0&&(0===r.indexOf("http")||0===r.indexOf("ws")||0===r.indexOf("file"))){for(var i=!0,o=n+1;o<r.length;o++)if(e.prototype._notNameChars.indexOf(r[o])>=0){i=!1;break}if(i){var a=r.slice(n+1),s=r.slice(0,n+1);if(this.defaultNamespace&&this.defaultNamespace===s&&this.flags.indexOf("d")<0)return this.flags.indexOf("k")>=0&&this.keyords.indexOf(a)<0?a:":"+a;var u=this.prefixes[s];if(u||(u=this.makeUpPrefix(s)),u)return this.namespacesUsed[s]=!0,u+":"+a}}return this.explicitURI(r)},e.prototype.writeStore=function(e){var t=this.store,r=t.fetcher,n=r&&r.appNode,i=this.store.index[3];for(var o in i){var a=t.fromNT(o);n&&a.sameTerm(n)||e("\n"+this.atomicTermToN3(a)+" "+this.atomicTermToN3(t.sym("http://www.w3.org/2000/10/swap/log#semantics"))+" { "+this.statementsToN3(t.statementsMatching(void 0,void 0,void 0,a))+" }.\n")}t.statementsMatching(void 0,t.sym("http://www.w3.org/2007/ont/link#requestedURI")).map(function(r){e("\n<"+r.object.value+"> log:metadata {\n");var n=t.statementsMatching(void 0,void 0,void 0,r.subject);e(this.statementsToN3(this.statementsToN3(n))),e("}.\n")});var s=[];n&&s.push(n);var u=[];s.map(function(e){u=u.concat(t.statementsMatching(void 0,void 0,void 0,e))}),e(this.statementsToN3(u))},e.prototype.statementsToXML=function(t){var r=[];r["http://www.w3.org/1999/02/22-rdf-syntax-ns#"]=!0;var n="http://www.w3.org/1999/02/22-rdf-syntax-ns#_",i=function(e){for(var t="",r=0;r<e;r++)t+=" ";return t},o=function e(t){for(var r="",n=0;n<t.length;n++){var i=t[n];r+="string"==typeof i?i:e(i)}return r};var a=function(e){this.suggestPrefix("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#");for(var t=this.rootSubjects(e),r=t.roots,n=[],i=0;i<r.length;i++){var o=r[i];n.push(c(o,t))}return n}.bind(this);function s(e){return void 0===e?"@@@undefined@@@@":e.replace(/[&<"]/g,function(e){switch(e[0]){case"&":return"&amp;";case"<":return"&lt;";case'"':return"&quot;"}})}var u=function(e){return s(this.base?Nt.uri.refTo(this.base,e.uri):e.uri)}.bind(this);var c=function(e,t){var r,i,o,a,d=[],p=t.subjects[this.toStr(e)];if(void 0===p)return h(e,t);p.sort(function(e,t){var r=e.predicate.uri,i=t.predicate.uri;if(r.substring(0,n.length)===n||i.substring(0,n.length)===n)return r.localeCompare(i);var o=r.substring(n.length),a=i.substring(n.length),s=parseInt(o,10),u=parseInt(a,10);return isNaN(s)||isNaN(u)||s!==o||u!==a?r.localeCompare(i):s-u});for(var g=0;g<p.length;g++)if("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"!==(o=p[g]).predicate.uri||r||"symbol"!==o.object.termType){if((a=o.predicate).uri.substr(0,n.length)===n){var y=a.uri.substr(n.length);y===parseInt(y,10).toString()&&(a=new yt.a("http://www.w3.org/1999/02/22-rdf-syntax-ns#li"))}switch(i=f(a),o.object.termType){case"BlankNode":d=1===t.incoming[o.object].length?d.concat(["<"+i+' rdf:parseType="Resource">',c(o.object,t),"</"+i+">"]):d.concat(["<"+i+' rdf:nodeID="'+o.object.toNT().slice(2)+'"/>']);break;case"NamedNode":d=d.concat(["<"+i+' rdf:resource="'+u(o.object)+'"/>']);break;case"Literal":d=d.concat(["<"+i+(o.object.datatype.equals(vt.string)?"":' rdf:datatype="'+s(o.object.datatype.uri)+'"')+(o.object.language?' xml:lang="'+o.object.language+'"':"")+">"+s(o.object.value)+"</"+i+">"]);break;case"Collection":d=d.concat(["<"+i+' rdf:parseType="Collection">',l(o.object,t),"</"+i+">"]);break;default:throw new Error("Can't serialize object of type "+o.object.termType+" into XML")}}else r=o.object;var v=r?f(r):"rdf:Description",m="";return"BlankNode"===e.termType?t.incoming[e]&&1===t.incoming[e].length||(m=' rdf:nodeID="'+e.toNT().slice(2)+'"'):m=' rdf:about="'+u(e)+'"',["<"+v+m+">"].concat([d]).concat(["</"+v+">"])}.bind(this);function l(e,t){for(var r=[],n=0;n<e.elements.length;n++)r.push(c(e.elements[n],t));return r}var h=function(e,t){var r=[],n=t.subjects[this.toStr(e)];if(!n)return r;n.sort();for(var i=0;i<n.length;i++){var o=n[i];switch(o.object.termType){case"BlankNode":r=t.rootsHash[o.object.toNT()]?r.concat(["<"+f(o.predicate)+' rdf:nodeID="'+o.object.toNT().slice(2)+'">',"</"+f(o.predicate)+">"]):r.concat(["<"+f(o.predicate)+' rdf:parseType="Resource">',h(o.object,t),"</"+f(o.predicate)+">"]);break;case"NamedNode":r=r.concat(["<"+f(o.predicate)+' rdf:resource="'+u(o.object)+'"/>']);break;case"Literal":r=r.concat(["<"+f(o.predicate)+(o.object.datatype.equals(vt.string)?"":' rdf:datatype="'+s(o.object.datatype.value)+'"')+(o.object.language?' xml:lang="'+o.object.language+'"':"")+">"+s(o.object.value)+"</"+f(o.predicate)+">"]);break;case"Collection":r=r.concat(["<"+f(o.predicate)+' rdf:parseType="Collection">',l(o.object,t),"</"+f(o.predicate)+">"]);break;default:throw new Error("Can't serialize object of type "+o.object.termType+" into XML")}}return r}.bind(this);var f=function(t){var n=t.uri,i=n.indexOf("#");if(i<0&&this.flags.indexOf("/")<0&&(i=n.lastIndexOf("/")),i<0)throw new Error("Cannot make qname out of <"+n+">");for(var o=i+1;o<n.length;o++)if(e.prototype._notNameChars.indexOf(n[o])>=0)throw new Error('Invalid character "'+n[o]+'" cannot be in XML qname for URI: '+n);var a=n.slice(i+1),s=n.slice(0,i+1);if(this.defaultNamespace&&this.defaultNamespace===s&&this.flags.indexOf("d")<0)return a;var u=this.prefixes[s];return u||(u=this.makeUpPrefix(s)),r[s]=!0,u+":"+a}.bind(this),d=a(t),p="<rdf:RDF";for(var g in this.defaultNamespace&&(p+=' xmlns="'+s(this.defaultNamespace)+'"'),r)if(r.hasOwnProperty(g)){var y=this.base&&this.flags.includes("z")?Nt.uri.refTo(this.base,g):g;p+="\n xmlns:"+this.prefixes[g]+'="'+s(y)+'"'}return function e(t,r){var n,a="",s=1e5;r||(r=0);for(var u=0;u<t.length;u++){var c=t[u];if("string"!=typeof c){var l=e(c,r+1);l.length<10*(80-4*r)&&l.indexOf('"""')<0&&(n=o(c)).length<80-4*r&&(c="   "+n,l=""),l&&(s=1e4),a+=l}"string"==typeof c&&(s<4*r+4?(a=a.slice(0,-1)+" "+c+"\n",s+=c.length+1):(a+=(n=i(4*r)+c)+"\n",s=n.length))}return a}([p+=">",d,"</rdf:RDF>"],-1)};return function(t){return new e(t)}}();function Ct(e,t,r,n,i,o){r=r||e.uri,o=o||{},n=n||"text/turtle";try{var a=Ot(t);o.flags&&a.setFlags(o.flags);var s=t.statementsMatching(void 0,void 0,void 0,e);switch(a.suggestNamespaces(t.namespaces),a.setBase(r),n){case"application/rdf+xml":return u(null,a.statementsToXML(s));case"text/n3":case"application/n3":return u(null,a.statementsToN3(s));case"text/turtle":case"application/x-turtle":return a.setFlags("si"),u(null,a.statementsToN3(s));case"application/n-triples":return a.setFlags("deinprstux"),u(null,a.statementsToNTriples(s));case"application/ld+json":a.setFlags("deinprstux"),ft(a.statementsToNTriples(s),i);break;case"application/n-quads":case"application/nquads":return a.setFlags("deinprstux q"),u(null,a.statementsToNTriples(s));default:throw new Error("Serialize: Content-type "+n+" not supported for data write.")}}catch(e){if(i)return i(e);throw e}function u(e,t){return i?void i(e,t):t}}var Rt=function(){function e(t,r,n,i){o()(this,e),this.subject=wt.fromValue(t),this.predicate=wt.fromValue(r),this.object=wt.fromValue(n),this.why=i}return s()(e,[{key:"equals",value:function(e){return e.subject.equals(this.subject)&&e.predicate.equals(this.predicate)&&e.object.equals(this.object)&&e.graph.equals(this.graph)}},{key:"substitute",value:function(t){var r=new e(this.subject.substitute(t),this.predicate.substitute(t),this.object.substitute(t),this.why.substitute(t));return console.log("@@@ statement substitute:"+r),r}},{key:"toCanonical",value:function(){var e=[this.subject.toCanonical(),this.predicate.toCanonical(),this.object.toCanonical()];return this.graph&&"DefaultGraph"!==this.graph.termType&&e.push(this.graph.toCanonical()),e.join(" ")+" ."}},{key:"toNT",value:function(){return[this.subject.toNT(),this.predicate.toNT(),this.object.toNT()].join(" ")+" ."}},{key:"toString",value:function(){return this.toNT()}},{key:"graph",get:function(){return this.why},set:function(e){this.why=e}}]),e}(),At=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return o()(this,t),(e=c()(this,h()(t).call(this))).termType=t.termType,e.value=r,e.base="varid:",e.uri=Et.join(r,e.base),e}return d()(t,e),s()(t,[{key:"equals",value:function(e){return!!e&&(this.termType===e.termType&&this.value===e.value)}},{key:"hashString",value:function(){return this.toString()}},{key:"substitute",value:function(e){var t;return null!=(t=e[this.toNT()])?t:this}},{key:"toString",value:function(){return this.uri.slice(0,this.base.length)===this.base?"?"+this.uri.slice(this.base.length):"?"+this.uri}}]),t}(wt);At.termType="Variable",At.prototype.classOrder=p.a.Variable,At.prototype.isVar=1;var Lt=function(e){function t(e,r,n,i){var a;return o()(this,t),(a=c()(this,h()(t).call(this))).termType=t.termType,a.statements=e||[],a.constraints=r||[],a.initBindings=n||[],a.optional=i||[],a}return d()(t,e),s()(t,[{key:"add",value:function(e,t,r,n){return this.statements.push(new Rt(e,t,r,n))}},{key:"addStatement",value:function(e){return this.statements.push(e)}},{key:"bnode",value:function(e){return new y(e)}},{key:"addAll",value:function(e){var t=this;e.forEach(function(e){t.add(e.subject,e.predicate,e.object,e.graph)})}},{key:"any",value:function(e,t,r,n){var i=this.anyStatementMatching(e,t,r,n);if(null!=i)return null==e?i.subject:null==t?i.predicate:null==r?i.object:void 0}},{key:"anyValue",value:function(e,t,r,n){var i=this.any(e,t,r,n);return i?i.value:void 0}},{key:"anyJS",value:function(e,t,r,n){var i=this.any(e,t,r,n);return i?wt.toJS(i):void 0}},{key:"anyStatementMatching",value:function(e,t,r,n){var i=this.statementsMatching(e,t,r,n,!0);if(i&&0!==i.length)return i[0]}},{key:"statementsMatching",value:function(e,t,r,n,i){return this.statements.filter(function(i){return(!e||e.sameTerm(i.subject))&&(!t||t.sameTerm(i.predicate))&&(!r||e.sameTerm(i.object))&&(!n||n.sameTerm(i.subject))})}},{key:"bottomTypeURIs",value:function(e){var t,r,n,i,o,a,s;for(i in t=[],e)if(e.hasOwnProperty(i)){for(s=e[i],r=!0,n=0,o=(a=this.each(void 0,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),this.sym(i))).length;n<o;n++)if(a[n].uri in e){r=!1;break}r&&(t[i]=s)}return t}},{key:"collection",value:function(){return new v}},{key:"each",value:function(e,t,r,n){var i,o,a,s,u,c,l,h,f,d=[],p=this.statementsMatching(e,t,r,n,!1);if(null==e)for(o=0,c=p.length;o<c;o++)i=p[o],d.push(i.subject);else if(null==t)for(a=0,l=p.length;a<l;a++)i=p[a],d.push(i.predicate);else if(null==r)for(s=0,h=p.length;s<h;s++)i=p[s],d.push(i.object);else if(null==n)for(u=0,f=p.length;u<f;u++)i=p[u],d.push(i.why);return d}},{key:"equals",value:function(e){return!!e&&this.hashString()===e.hashString()}},{key:"findMembersNT",value:function(e){var t,r,n,i,o,a,s,u,c,l,h,f,d,p,g,y,v,m,b,w,x;for(w in(m={})[e.toNT()]=!0,c={},f=this.transitiveClosure(m,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!0))if(f.hasOwnProperty(w)){for(t=0,n=(d=this.statementsMatching(void 0,this.sym("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),this.fromNT(w))).length;t<n;t++)c[(b=d[t]).subject.toNT()]=b;for(r=0,i=(p=this.each(void 0,this.sym("http://www.w3.org/2000/01/rdf-schema#domain"),this.fromNT(w))).length;r<i;r++)for(l=p[r],u=0,o=(g=this.statementsMatching(void 0,l)).length;u<o;u++)c[(b=g[u]).subject.toNT()]=b;for(h=0,a=(y=this.each(void 0,this.sym("http://www.w3.org/2000/01/rdf-schema#range"),this.fromNT(w))).length;h<a;h++)for(l=y[h],x=0,s=(v=this.statementsMatching(void 0,l)).length;x<s;x++)c[(b=v[x]).object.toNT()]=b}return c}},{key:"findMemberURIs",value:function(e){return this.NTtoURI(this.findMembersNT(e))}},{key:"findSubClassesNT",value:function(e){var t={};return t[e.toNT()]=!0,this.transitiveClosure(t,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!0)}},{key:"findSuperClassesNT",value:function(e){var t={};return t[e.toNT()]=!0,this.transitiveClosure(t,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!1)}},{key:"findTypesNT",value:function(e){var t,r,n,i,o,a,s,u,c,l,h,f,d,p;for("http://www.w3.org/1999/02/22-rdf-syntax-ns#type",p=[],t=0,n=(c=this.statementsMatching(e,void 0,void 0)).length;t<n;t++)if("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===(d=c[t]).predicate.uri)p[d.object.toNT()]=d;else for(r=0,i=(l=this.each(d.predicate,this.sym("http://www.w3.org/2000/01/rdf-schema#domain"))).length;r<i;r++)p[l[r].toNT()]=d;for(s=0,o=(h=this.statementsMatching(void 0,void 0,e)).length;s<o;s++)for(d=h[s],u=0,a=(f=this.each(d.predicate,this.sym("http://www.w3.org/2000/01/rdf-schema#range"))).length;u<a;u++)p[f[u].toNT()]=d;return this.transitiveClosure(p,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!1)}},{key:"findTypeURIs",value:function(e){return this.NTtoURI(this.findTypesNT(e))}},{key:"connectedStatements",value:function(e,t,r){r=r||[];for(var n=[e],i=[],o=[],a=[],s=this,u=function(e){var u=function(e){"BlankNode"!==e.termType||i[e.value]||(i[e.value]=!0,n.push(e))},c=s.statementsMatching(null,null,e,t).concat(s.statementsMatching(e,null,null,t));(c=c.filter(function(e){if(r[e.predicate.uri])return!1;var t=e.toNT();return!o[t]&&(o[t]=!0,!0)})).forEach(function(e,t){u(e.subject),u(e.object)}),a=a.concat(c)};n.length;)u(n.shift());return a}},{key:"formula",value:function(){return new t}},{key:"fromNT",value:function(e){var t,r,n;switch(e[0]){case"<":return this.sym(e.slice(1,-1));case'"':if(n=void 0,t=void 0,(r=e.lastIndexOf('"'))<e.length-1)if("@"===e[r+1])n=e.slice(r+2);else{if("^^"!==e.slice(r+1,r+3))throw new Error("Can't convert string from NT: "+e);t=this.fromNT(e.slice(r+3))}return e=(e=(e=(e=e.slice(1,r)).replace(/\\"/g,'"')).replace(/\\n/g,"\n")).replace(/\\\\/g,"\\"),this.literal(e,n,t);case"_":return new y(e.slice(2));case"?":return new At(e.slice(1))}throw new Error("Can't convert from NT: "+e)}},{key:"holds",value:function(e,t,r,n){var i;if(1===arguments.length){if(!e)return!0;if(e instanceof Array){for(i=0;i<e.length;i++)if(!this.holds(e[i]))return!1;return!0}if(e instanceof Rt)return this.holds(e.subject,e.predicate,e.object,e.why);if(e.statements)return this.holds(e.statements)}var o=this.anyStatementMatching(e,t,r,n);return null!=o}},{key:"holdsStatement",value:function(e){return this.holds(e.subject,e.predicate,e.object,e.why)}},{key:"list",value:function(e){var t=new v;return e.forEach(function(e){t.append(e)}),t}},{key:"literal",value:function(e,t,r){return new mt(""+e,t,r)}},{key:"NTtoURI",value:function(e){var t,r,n={};for(t in e)e.hasOwnProperty(t)&&(r=e[t],"<"===t[0]&&(n[t.slice(1,-1)]=r));return n}},{key:"serialize",value:function(e,t,r){var n,i,o;switch((o=Ct(this)).suggestNamespaces(this.namespaces),o.setBase(e),i=r?this.statementsMatching(void 0,void 0,void 0,r):this.statements,null!=t?t:"text/n3"){case"application/rdf+xml":n=o.statementsToXML(i);break;case"text/n3":case"text/turtle":n=o.statementsToN3(i);break;default:throw new Error("serialize: Content-type "+t+" not supported.")}return n}},{key:"substitute",value:function(e){var r=this.statements.map(function(t){return t.substitute(e)});console.log("Formula subs statmnts:"+r);var n=new t;return n.add(r),console.log("indexed-form subs formula:"+n),n}},{key:"sym",value:function(e,t){if(t)throw new Error("This feature (kb.sym with 2 args) is removed. Do not assume prefix mappings.");return new yt.a(e)}},{key:"the",value:function(e,t,r,n){var i=this.any(e,t,r,n);return null==i&&jt.a.error("No value found for the() {"+e+" "+t+" "+r+"}."),i}},{key:"transitiveClosure",value:function(e,t,r){var n,i,o,a,s,u={};Object.assign(u,e);for(var c={};;){if(null==(s=function(){for(var e in u)if(u.hasOwnProperty(e))return e}()))return c;for(n=0,i=(a=r?this.each(void 0,t,this.fromNT(s)):this.each(this.fromNT(s),t)).length;n<i;n++)(o=a[n].toNT())in c||o in u||(u[o]=u[s]);c[s]=u[s],delete u[s]}}},{key:"topTypeURIs",value:function(e){var t,r,n,i,o,a,s;for(r in a=[],e)if(e.hasOwnProperty(r)){for(s=e[r],i=0,t=0,n=(o=this.each(this.sym(r),this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"))).length;t<n;t++)if("http://www.w3.org/2000/01/rdf-schema#Resource"!==o[t].uri){i++;break}i||(a[r]=s)}return a["http://www.w3.org/2000/01/rdf-schema#Resource"]&&delete a["http://www.w3.org/2000/01/rdf-schema#Resource"],a["http://www.w3.org/2002/07/owl#Thing"]&&delete a["http://www.w3.org/2002/07/owl#Thing"],a}},{key:"toString",value:function(){return"{"+this.statements.join("\n")+"}"}},{key:"whether",value:function(e,t,r,n){return this.statementsMatching(e,t,r,n,!1).length}}]),t}(wt);Lt.termType="Graph",Lt.prototype.classOrder=p.a.Graph,Lt.prototype.isVar=0,Lt.prototype.ns=bt,Lt.prototype.variable=function(e){return new At(e)};var Dt=function e(t,r){o()(this,e),this.pat=new qt,this.vars=[],this.name=t,this.id=r};function Mt(e,t,r,n){function i(e){var t,r="";for(t in e)e.hasOwnProperty(t)&&(r+="    "+t+" -> "+e[t]);return r}function o(e){var t,r="Bindings: ",n=e.length;for(t=0;t<n;t++)r+=i(e[t][0])+";\n\t";return r}function a(e,t,r,n){var i;if(e.length!==t.length)return[];if(!e.length)return[[[],null]];var o=function(e,t,r,n){var i=r[e];if(void 0===i){if(e.isVar){var o=[];return o[e]=t,[[o,null]]}i=e}if(!i.complexType)return n.redirections[i]&&(i=n.redirections[i]),n.redirections[t]&&(t=n.redirections[t]),i.sameTerm(t)||i.uri&&i.uri===Ut?[[[],null]]:[];if(e instanceof Array)return t instanceof Array?a(e,t,r):[];throw new Error("query.js: oops - code not written yet")}(e[0],t[0],r,n);if(0===o.length)return o;var s,u,c,l,h,f,d,p=[],g=o.length;for(s=0;s<g;s++){for(h in d=[],u=o[s][0])u.hasOwnProperty(h)&&(d[h]=u[h]);for(h in r)r.hasOwnProperty(h)&&(d[h]=r[h]);for(l=(i=a(e.slice(1),t.slice(1),d,n)).length,c=0;c<l;c++){for(h in f=i[c][0],u)u.hasOwnProperty(h)&&(f[h]=u[h]);p.push([f,null])}}return p}function s(e,t){var r,n={};for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);for(r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function u(e,t){return this.trunkBindings=t,this.originalCallback=e,this.branches=[],this}function c(e,t){return this.count=0,this.success=!1,this.done=!1,this.callback=e,this.onDone=t,this}u.prototype.checkAllDone=function(){var e;for(e=0;e<this.branches.length;e++)if(!this.branches[e].done)return;jt.a.debug("OPTIONAL BIDNINGS ALL DONE:"),this.doCallBacks(this.branches.length-1,this.trunkBindings)},u.prototype.doCallBacks=function(e,t){var r;if(e<0)return this.originalCallback(t);for(r=0;r<this.branches[e].results.length;r++)this.doCallBacks(e-1,s(t,this.branches[e].results[r]))},c.prototype.reportMatch=function(e){this.callback(e),this.success=!0},c.prototype.reportDone=function(){this.done=!0,jt.a.info("Mandatory query branch finished.***"),void 0!==this.onDone&&this.onDone()};var l=function(e){return this.count=0,this.done=!1,this.results=[],this.junction=e,e.branches.push(this),this};function h(e,t,r){var n,i,o,a,s,u;for(t.nvars=0,t.index=null,n=[t.subject,t.predicate,t.object,t.why],a=[e.subjectIndex,e.predicateIndex,e.objectIndex,e.whyIndex],o=0;o<4;o++){var c=n[o];if(c.uri&&c.uri===Ut);else if(c.isVar&&void 0===r[c])t.nvars++;else{if(u=void 0,c=void 0===(u=r[s=n[o]])?s:u,e.redirections[c.hashString()]&&(c=e.redirections[c.hashString()]),!(i=a[o][c.hashString()]))return t.index=[],!1;(null===t.index||t.index.length>i.length)&&(t.index=i)}}return null===t.index&&(t.index=e.statements),!0}function f(e,t){return e.nvars!==t.nvars?e.nvars-t.nvars:e.index.length-t.index.length}l.prototype.reportMatch=function(e){this.results.push(e)},l.prototype.reportDone=function(){jt.a.debug("Optional branch finished - results.length = "+this.results.length),0===this.results.length&&(this.results.push({}),jt.a.debug("Optional branch FAILED - that's OK.")),this.done=!0,this.junction.checkAllDone()};var d=function e(r,n,o,a,s,c,h){jt.a.debug("Match begins, Branch count now: "+h.count+" for "+h.pattern_debug);var f,d,p=r.fetcher?r.fetcher:null,y=n.statements;if(0===y.length){if(jt.a.debug("FOUND MATCH WITH BINDINGS:"+i(o)),0===n.optional.length)h.reportMatch(o);else{jt.a.debug("OPTIONAL: "+n.optional);var v,m=new u(t,o),b=[];for(v=0;v<n.optional.length;v++)b[v]=new l(m),b[v].pattern_debug=n.optional[v];for(v=0;v<n.optional.length;v++)b[v].count=b[v].count+1,e(r,n.optional[v],o,"",s,t,b[v])}return h.count--,void jt.a.debug("Match ends -- success , Branch count now: "+h.count+" for "+h.pattern_debug)}var w=y.length;if(p){0;var x=function(t,i){var u=t.uri.split("#")[0];p.nowOrWhenFetched(u,void 0,function(i,u,l){i||console.log("Error following link to <"+t.uri+"> in query: "+u),e(r,n,o,a,s,c,h)})};for(d=0;d<w;d++){if(f=y[d],void 0!==o[f.subject]&&o[f.subject].uri&&p&&"unrequested"===p.getState(Object(Et.docpart)(o[f.subject].uri)))return void x(o[f.subject]);if(void 0!==o[f.object]&&o[f.object].uri&&p&&"unrequested"===p.getState(Object(Et.docpart)(o[f.object].uri)))return void x(o[f.object])}}g(r,n,o,a,s,c,h)},p=function(e,t){var r,n,i=!0;for(r in e)e.hasOwnProperty(r)&&t[r]&&(n=t[r].test)&&!n(e[r])&&(i=!1);return i},g=function(e,t,r,n,s,u,c){var l,g,y,v,m,b,w,x=t.statements,_=x.length;for(l=0;l<_;l++)h(e,w=x[l],r);x.sort(f),w=x[0];var T,k=e.formula();k.optional=t.optional,k.constraints=t.constraints,k.statements=x.slice(1),jt.a.debug(n+"match2 searching "+w.index.length+" for "+w+"; bindings so far="+i(r));var S,I,N=w.index.length,j=0;for(T=0;T<N;T++)for(I=w.index[T],S=a([w.subject,w.predicate,w.object,w.why],[I.subject,I.predicate,I.object,I.why],r,e),jt.a.info(n+" From first: "+S.length+": "+o(S)),y=S.length,g=0;g<y;g++)if(m=[],b=S[g][0],p(b,t.constraints)){for(v in b)b.hasOwnProperty(v)&&(m[v]=b[v]);for(v in r)r.hasOwnProperty(v)&&(m[v]=r[v]);c.count++,j++,d(e,k,m,n+"  ",s,u,c)}else jt.a.debug("Branch count CS: "+c.count);c.count--,0===j&&jt.a.debug("Match2 fails completely on "+w),jt.a.debug("Match2 ends, Branch count: "+c.count+" for "+c.pattern_debug),0===c.count&&(jt.a.debug("Branch finished."),c.reportDone())},y=this;jt.a.debug("Query on "+this.statements.length);var v=new c(t,n);v.count++,e.sync?d(y,e.pat,e.pat.initBindings,"",r,t,v):setTimeout(function(){d(y,e.pat,e.pat.initBindings,"",r,t,v)},0)}var Ut="chrome:theSession";function Pt(e,t,r,n){var i=e.any(t,r,void 0);return!!i&&(e.equate(i,n),!0)}function Bt(e,t,r,n){var i=e.any(void 0,r,n);return!!i&&(e.equate(i,t),!0)}function Ft(e,t,r,n,i){e.typeCallback&&e.typeCallback(e,n,i);var o=e.classActions[n.hashString()],a=!1;if(o)for(var s=0;s<o.length;s++)a=a||o[s](e,t,r,n,i);return a}var qt=function(e){function t(e){var r;return o()(this,t),(r=c()(this,h()(t).call(this))).propertyActions=[],r.classActions=[],r.redirections=[],r.aliases=[],r.HTTPRedirects=[],r.subjectIndex=[],r.predicateIndex=[],r.objectIndex=[],r.whyIndex=[],r.index=[r.subjectIndex,r.predicateIndex,r.objectIndex,r.whyIndex],r.namespaces={},r.features=e||["sameAs","InverseFunctionalProperty","FunctionalProperty"],r.initPropertyActions(r.features),r}return d()(t,e),s()(t,[{key:"substitute",value:function(e){var r=this.statements.map(function(t){return t.substitute(e)}),n=new t;return n.add(r),n}},{key:"applyPatch",value:function(e,t,r){var n,i=this,o=null;function a(a){if(e.delete){n=e.delete,o&&(n=n.substitute(o)),n=n.statements;var s=[],u=n.map(function(e){var r=i.statementsMatching(e.subject,e.predicate,e.object,t);return 0===r.length?(s.push(e),null):r[0]});if(s.length)return r("Could not find to delete: "+s.join("\n or "));u.map(function(e){i.remove(e)})}e.insert&&(n=e.insert,o&&(n=n.substitute(o)),(n=n.statements).map(function(e){e.why=t,i.add(e.subject,e.predicate,e.object,e.why)})),a()}if(e.where){var s=new Dt("patch");s.pat=e.where,s.pat.statements.map(function(e){e.why=t}),s.sync=!0;var u=[];i.query(s,function(e){u.push(e)},i.fetcher,function(){return 0===u.length?r("No match found to be patched:"+e.where):u.length>1?r("Patch ambiguous. No patch done."):(o=u[0],void a(r))})}else a(r)}},{key:"declareExistential",value:function(e){return this._existentialVariables||(this._existentialVariables=[]),this._existentialVariables.push(e),e}},{key:"initPropertyActions",value:function(e){this.propertyActions["<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>"]=[Ft],Object(Nt.ArrayIndexOf)(e,"sameAs")>=0&&(this.propertyActions["<http://www.w3.org/2002/07/owl#sameAs>"]=[function(e,t,r,n,i){return e.equate(t,n),!0}]),Object(Nt.ArrayIndexOf)(e,"InverseFunctionalProperty")>=0&&(this.classActions["<http://www.w3.org/2002/07/owl#InverseFunctionalProperty>"]=[function(e,t,r,n,i){return e.newPropertyAction(t,Bt)}]),Object(Nt.ArrayIndexOf)(e,"FunctionalProperty")>=0&&(this.classActions["<http://www.w3.org/2002/07/owl#FunctionalProperty>"]=[function(e,t,r,n,i){return e.newPropertyAction(t,Pt)}])}},{key:"add",value:function(e,r,n,i){var o,a,s;if(1===arguments.length){if(e instanceof Array)for(o=0;o<e.length;o++)this.add(e[o]);else e instanceof Rt?this.add(e.subject,e.predicate,e.object,e.why):e instanceof t&&this.add(e.statements);return this}i||(i=this.fetcher?this.fetcher.appNode:this.sym(Ut)),e=wt.fromValue(e),r=wt.fromValue(r),n=wt.fromValue(n),i=wt.fromValue(i),this.predicateCallback&&this.predicateCallback(this,r,i);var u=this.canon(r).hashString(),c=!1;if(a=this.propertyActions[u])for(o=0;o<a.length;o++)c=c||a[o](this,e,r,n,i);if(this.holds(e,r,n,i))return null;var l=[this.canon(e).hashString(),u,this.canon(n).hashString(),this.canon(i).hashString()];for(s=new Rt(e,r,n,i),o=0;o<4;o++){var h=this.index[o],f=l[o];h[f]||(h[f]=[]),h[f].push(s)}return this.statements.push(s),s}},{key:"canon",value:function(e){if(!e)return e;var t=this.redirections[e.hashString()];return t||e}},{key:"check",value:function(){this.checkStatementList(this.statements);for(var e=0;e<4;e++){var t=this.index[e];for(var r in t)t.hasOwnProperty(r)&&this.checkStatementList(t[r],e)}}},{key:"checkStatementList",value:function(e,t){for(var r,n=" found in "+["subject","predicate","object","why"][t]+" index.",i=0;i<e.length;i++){for(var o=[(r=e[i]).subject,r.predicate,r.object,r.why],a=function(e,t){for(var r=0;r<e.length;r++)if(e[r].subject.sameTerm(t.subject)&&e[r].predicate.sameTerm(t.predicate)&&e[r].object.sameTerm(t.object)&&e[r].why.sameTerm(t.why))return!0},s=0;s<4;s++){var u=this.canon(o[s]).hashString();this.index[s][u]&&a(this.index[s][u],r)}if(!a(this.statements,r))throw new Error("Statement list does not statement "+r+"@"+r.why+n)}}},{key:"close",value:function(){return this}},{key:"copyTo",value:function(e,t,r){r||(r=[]);var n=this.statementsMatching(e);-1!==Object(Nt.ArrayIndexOf)(r,"two-direction")&&n.concat(this.statementsMatching(void 0,void 0,e));for(var i=0;i<n.length;i++){var o=n[i];switch(o.object.termType){case"NamedNode":this.add(t,o.predicate,o.object);break;case"Literal":case"BlankNode":case"Collection":this.add(t,o.predicate,o.object.copy(this))}-1!==Object(Nt.ArrayIndexOf)(r,"delete")&&this.remove(o)}}},{key:"equate",value:function(e,t){e=this.canon(e),t=this.canon(t);var r=e.compareTerm(t);return!r||(r<0?this.replaceWith(t,e):this.replaceWith(e,t))}},{key:"formula",value:function(e){return new t(e)}},{key:"match",value:function(e,t,r,n){return this.statementsMatching(wt.fromValue(e),wt.fromValue(t),wt.fromValue(r),wt.fromValue(n))}},{key:"mentionsURI",value:function(e){var t="<"+e+">";return!!this.subjectIndex[t]||!!this.objectIndex[t]||!!this.predicateIndex[t]}},{key:"newExistential",value:function(e){if(!e)return this.bnode();var t=this.sym(e);return this.declareExistential(t)}},{key:"newPropertyAction",value:function(e,t){var r=e.hashString();this.propertyActions[r]||(this.propertyActions[r]=[]),this.propertyActions[r].push(t);for(var n=this.statementsMatching(void 0,e,void 0),i=!1,o=0;o<n.length;o++)i=i||t(this,n[o].subject,e,n[o].object);return i}},{key:"newUniversal",value:function(e){var t=this.sym(e);return this._universalVariables||(this._universalVariables=[]),this._universalVariables.push(t),t}},{key:"variable",value:function(e){return new At(e)}},{key:"nextSymbol",value:function(e){for(var t=0;;t++){var r=e.uri+"#n"+t;if(!this.mentionsURI(r))return this.sym(r)}}},{key:"query",value:function(e,t,r,n){return Mt.call(this,e,t,r,n)}},{key:"querySync",value:function(e){var t=[],r=!1;if(e.sync=!0,Mt.call(this,e,function(e){t.push(e)},null,function(){r=!0}),!r)throw new Error("Sync query should have called done function");return t}},{key:"remove",value:function(e){if(e instanceof Array){for(var r=0;r<e.length;r++)this.remove(e[r]);return this}if(e instanceof t)return this.remove(e.statements);var n=this.statementsMatching(e.subject,e.predicate,e.object,e.why);if(!n.length)throw new Error("Statement to be removed is not on store: "+e);return this.removeStatement(n[0]),this}},{key:"removeDocument",value:function(e){for(var t=this.statementsMatching(void 0,void 0,void 0,e).slice(),r=0;r<t.length;r++)this.removeStatement(t[r]);return this}},{key:"removeMany",value:function(e,t,r,n,i){for(var o=this.statementsMatching(e,t,r,n,!1),a=[],s=0;s<o.length;s++)a.push(o[s]);for(i&&(a=a.slice(0,i)),s=0;s<a.length;s++)this.remove(a[s])}},{key:"removeMatches",value:function(e,t,r,n){return this.removeStatements(this.statementsMatching(e,t,r,n)),this}},{key:"removeStatement",value:function(e){for(var t=[e.subject,e.predicate,e.object,e.why],r=0;r<4;r++){var n=this.canon(t[r]).hashString();this.index[r][n]&&Object(Nt.RDFArrayRemove)(this.index[r][n],e)}return Object(Nt.RDFArrayRemove)(this.statements,e),this}},{key:"removeStatements",value:function(e){for(var t=0;t<e.length;t++)this.remove(e[t]);return this}},{key:"replaceWith",value:function(e,t){for(var r=e.hashString(),n=t.hashString(),i=function(e){var t=e[r];if(t){var i=e[n];e[n]=i?t.concat(i):t,delete e[r]}},o=0;o<4;o++)i(this.index[o]);if(this.redirections[r]=t,e.uri){if(this.aliases[n]||(this.aliases[n]=[]),this.aliases[n].push(e),this.aliases[r])for(o=0;o<this.aliases[r].length;o++)this.redirections[this.aliases[r][o].hashString()]=t,this.aliases[n].push(this.aliases[r][o]);this.add(t,this.sym("http://www.w3.org/2007/ont/link#uri"),e.uri),this.fetcher&&this.fetcher.nowKnownAs(e,t)}return i(this.classActions),i(this.propertyActions),!0}},{key:"allAliases",value:function(e){var t=this.aliases[this.canon(e).hashString()]||[];return t.push(this.canon(e)),t}},{key:"sameThings",value:function(e,t){if(e.sameTerm(t))return!0;var r=this.canon(e);if(!r)return!1;var n=this.canon(t);return!!n&&r.uri===n.uri}},{key:"setPrefixForURI",value:function(e,t){"tab"===e&&this.namespaces.tab||"ns"!==e.slice(0,2)&&"default"!==e.slice(0,7)&&(this.namespaces[e]=t)}},{key:"statementsMatching",value:function(e,t,r,n,i){var o,a,s=[e,t,r,n],u=[],c=[],l=[],h=[];for(o=0;o<4;o++)u[o]=this.canon(wt.fromValue(s[o])),u[o]?(h.push(o),c[o]=u[o].hashString()):l.push(o);if(0===h.length)return this.statements;if(1===h.length)return o=h[0],(a=this.index[o][c[o]])&&i&&a.length>1&&(a=a.slice(0,1)),a=a||[];var f,d,p=1e10;for(d=0;d<h.length;d++){if(o=h[d],!(a=this.index[o][c[o]]))return[];a.length<p&&(p=a.length,f=d)}for(var g=h[f],y=this.index[g][c[g]],v=h.slice(0,f).concat(h.slice(f+1)),m=[],b=["subject","predicate","object","why"],w=0;w<y.length;w++){var x=y[w];for(d=0;d<v.length;d++)if(o=v[d],!this.canon(x[b[o]]).sameTerm(u[o])){x=null;break}if(null!=x&&(m.push(x),i))break}return m}},{key:"uris",value:function(e){var t=this.canon(e),r=this.aliases[t.hashString()];if(!t.uri)return[];var n=[t.uri];if(r)for(var i=0;i<r.length;i++)n.push(r[i].uri);return n}},{key:"length",get:function(){return this.statements.length}}],[{key:"defaultGraphURI",get:function(){return Ut}}]),t}(Lt);qt.handleRDFType=Ft;var zt=function(){var e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},t="http://www.w3.org/2000/10/swap/log#",r=function(e){return e},n=function(e){return e},i=function(e){if(e.length>0)throw"missing.js: oops nnonempty dict not imp";return[]},o=function(e){return e.length},a=function(e,t,r){if(void 0===e.slice)throw"@@ mising.js: No .slice function for "+e+" of type "+gt()(e);return void 0===r||null==r?e.slice(t):e.slice(t,r)},s=Error("dummy error stop iteration"),u=function(e){return this.last=0,this.li=e,this.next=function(){if(this.last==this.li.length)throw s;return this.li[this.last++]},this},c=function(e,t){return e.indexOf(t)},l=function(e,t){if(!e){if(t)throw"python Assertion failed: "+t;throw"(python) Assertion failed."}};String.prototype.encode=function(t){if("utf-8"!=t)throw"UTF8_converter: can only do utf-8";return e(this)},String.prototype.decode=function(e){if("utf-8"!=e)throw"UTF8_converter: can only do utf-8";return this};var h=function(e,t){return Et.join(t,e)},f=0;var d="\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~:",p=(new RegExp("^[ \\t]*(#[^\\n]*)?\\r?\\n","g"),new RegExp("^[ \\t]*(#[^\\n]*)?$","g"),new RegExp("^[ \\t]*","g"),new RegExp("^[-+]?[0-9]+","g"),new RegExp("^([-+]?[0-9]+)(\\.[0-9]+)?(e[-+]?[0-9]+)?","g")),g=new RegExp("^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9](T[0-9][0-9]:[0-9][0-9](:[0-9][0-9](\\.[0-9]*)?)?)?Z?"),y=(new RegExp("^[0-9]+","g"),new RegExp('[\\\\\\r\\n\\"]',"g")),v=new RegExp("^[a-zA-Z0-9]+(-[a-zA-Z0-9]+)*","g");function m(e,t,r,o,a,s,u,c){void 0===t&&(t=null),void 0===r&&(r=""),void 0===o&&(o=null),void 0===a&&(a=""),void 0===s&&(s=null),void 0===u&&(u=""),void 0===c&&(c=null),this._bindings=new i([]),this._flags=u,""!=r&&(l(r.indexOf(":")>=0,"Document URI not absolute: "+r),this._bindings[""]=r+"#"),this._store=e,a&&e.setGenPrefix(a),this._thisDoc=r,this.source=e.sym(r),this.lines=0,this.statementCount=0,this.startOfLine=0,this.previousLine=0,this._genPrefix=a,this.keywords=new n(["a","this","bind","has","is","of","true","false"]),this.keywordsSet=0,this._anonymousNodes=new i([]),this._variables=new i([]),this._parentVariables=new i([]),this._reason=c,this._reason2=null,f&&(this._reason2=why_BecauseOfData(e.sym(r),this._reason)),this._baseURI=o||(r||null),l(!this._baseURI||this._baseURI.indexOf(":")>=0),this._genPrefix||(this._thisDoc?this._genPrefix=this._thisDoc+"#_g":this._genPrefix=RDFSink_uniqueURI()),null==t?this._thisDoc?this._formula=e.formula(r+"#_formula"):this._formula=e.formula():this._formula=t,this._context=this._formula,this._parentContext=null}function b(e,t,r,n,i){this._str=r.encode("utf-8"),this._str=r,this._i=n,this._why=i,this.lines=t,this._uri=e}function w(e,t,r,n,i){var o=t+1,a="Line "+o+" of <"+e+">: Bad syntax: "+i+'\nat: "'+r.slice(n,n+30)+'"',s=new SyntaxError(a,e,o);return s.lineNo=o,s.characterInFile=n,s.syntaxProblem=i,s}return m.prototype.here=function(e){return this._genPrefix+"_L"+this.lines+"C"+(e-this.startOfLine+1)},m.prototype.formula=function(){return this._formula},m.prototype.loadStream=function(e){return this.loadBuf(e.read())},m.prototype.loadBuf=function(e){return this.startDoc(),this.feed(e),this.endDoc()},m.prototype.feed=function(e){for(var t=e.decode("utf-8"),r=0;r>=0;){var n=this.skipSpace(t,r);if(n<0)return;if((r=this.directiveOrStatement(t,n))<0)throw w(this._thisDoc,this.lines,t,n,"expected directive or statement")}},m.prototype.directiveOrStatement=function(e,t){var r,n=this.skipSpace(e,t);return n<0?n:(r=this.directive(e,n))>=0?this.checkDot(e,r):(r=this.statement(e,n))>=0?this.checkDot(e,r):r},m.prototype.tok=function(e,t,r){if("@"==t.slice(r,r+1))r=r+1;else if(Object(Nt.ArrayIndexOf)(this.keywords,e)<0)return-1;var n=r+o(e);return t.slice(r,n)==e&&"\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~".indexOf(t.charAt(n))>=0?n:-1},m.prototype.directive=function(e,t){if((c=this.skipSpace(e,t))<0)return c;var r=new n([]);if((c=this.tok("bind",e,t))>0)throw w(this._thisDoc,this.lines,e,t,"keyword bind is obsolete: use @prefix");if((c=this.tok("keywords",e,t))>0){if((t=this.commaSeparatedList(e,c,r,!1))<0)throw w(this._thisDoc,this.lines,e,t,"'@keywords' needs comma separated list of words");return this.setKeywords(a(r,null,null)),t}if((c=this.tok("forAll",e,t))>0){if((t=this.commaSeparatedList(e,c,r,!0))<0)throw w(this._thisDoc,this.lines,e,t,"Bad variable list after @forAll");var i=new u(r);try{for(;;){var o=i.next();(Object(Nt.ArrayIndexOf)(this._variables,o)<0||Object(Nt.ArrayIndexOf)(this._parentVariables,o)>=0)&&(this._variables[o]=this._context.newUniversal(o))}}catch(e){if(e!=s)throw e}return t}if((c=this.tok("forSome",e,t))>0){if((t=this.commaSeparatedList(e,c,r,this.uri_ref2))<0)throw w(this._thisDoc,this.lines,e,t,"Bad variable list after @forSome");i=new u(r);try{for(;;){o=i.next();this._context.declareExistential(o)}}catch(e){if(e!=s)throw e}return t}if((c=this.tok("prefix",e,t))>=0){var c,f=new n([]);if((t=this.qname(e,c,f))<0)throw w(this._thisDoc,this.lines,e,c,"expected qname after @prefix");if((c=this.uri_ref2(e,t,f))<0)throw w(this._thisDoc,this.lines,e,t,"expected <uriref> after @prefix _qname_");var d=f[1].uri;if(this._baseURI)d=h(this._baseURI,d);else l(d.indexOf(":")>=0,"With no base URI, cannot handle relative URI for NS");return l(d.indexOf(":")>=0),this._bindings[f[0][0]]=d,this.bind(f[0][0],function(e){return encodeURI(e)}(d)),c}if((c=this.tok("base",e,t))>=0){f=new n([]);if((t=this.uri_ref2(e,c,f))<0)throw w(this._thisDoc,this.lines,e,c,"expected <uri> after @base ");d=f[0].uri;if(!this._baseURI)throw w(this._thisDoc,this.lines,e,c,"With no previous base URI, cannot use relative URI in @base  <"+d+">");d=h(this._baseURI,d);return l(d.indexOf(":")>=0),this._baseURI=d,t}return-1},m.prototype.bind=function(e,t){""==e||this._store.setPrefixForURI(e,t)},m.prototype.setKeywords=function(e){null==e?this.keywordsSet=0:(this.keywords=e,this.keywordsSet=1)},m.prototype.startDoc=function(){},m.prototype.endDoc=function(){return this._formula},m.prototype.makeStatement=function(e){e[0].add(e[2],e[1],e[3],this.source),this.statementCount+=1},m.prototype.statement=function(e,t){var r=new n([]);if((t=this.object(e,t,r))<0)return t;var i=this.property_list(e,t,r[0]);if(i<0)throw w(this._thisDoc,this.lines,e,t,"expected propertylist");return i},m.prototype.subject=function(e,t,r){return this.item(e,t,r)},m.prototype.verb=function(e,i,o){if((s=this.skipSpace(e,i))<0)return s;var a=new n([]);if((s=this.tok("has",e,i))>=0){if((i=this.prop(e,s,a))<0)throw w(this._thisDoc,this.lines,e,s,"expected property after 'has'");return o.push(new r(["->",a[0]])),i}if((s=this.tok("is",e,i))>=0){if((i=this.prop(e,s,a))<0)throw w(this._thisDoc,this.lines,e,s,"expected <property> after 'is'");if((s=this.skipSpace(e,i))<0)throw w(this._thisDoc,this.lines,e,i,"End of file found, expected property after 'is'");var s;i=s;if((s=this.tok("of",e,i))<0)throw w(this._thisDoc,this.lines,e,i,"expected 'of' after 'is' <prop>");return o.push(new r(["<-",a[0]])),s}if((s=this.tok("a",e,i))>=0)return o.push(new r(["->",this._store.sym("http://www.w3.org/1999/02/22-rdf-syntax-ns#type")])),s;if("<="==e.slice(i,i+2))return o.push(new r(["<-",this._store.sym(t+"implies")])),i+2;if("="==e.slice(i,i+1))return">"==e.slice(i+1,i+2)?(o.push(new r(["->",this._store.sym(t+"implies")])),i+2):(o.push(new r(["->",this._store.sym("http://www.w3.org/2002/07/owl#sameAs")])),i+1);if(":="==e.slice(i,i+2))return o.push(new r(["->",t+"becomes"])),i+2;if((s=this.prop(e,i,a))>=0)return o.push(new r(["->",a[0]])),s;if(">-"==e.slice(i,i+2)||"<-"==e.slice(i,i+2))throw w(this._thisDoc,this.lines,e,s,">- ... -> syntax is obsolete.");return-1},m.prototype.prop=function(e,t,r){return this.item(e,t,r)},m.prototype.item=function(e,t,r){return this.path(e,t,r)},m.prototype.blankNode=function(e){return this._context.bnode(e,this._reason2)},m.prototype.path=function(e,t,n){if((a=this.nodeOrLiteral(e,t,n))<0)return a;for(;"!^.".indexOf(e.slice(a,a+1))>=0;){var i=e.slice(a,a+1);if("."==i){var o=e.slice(a+1,a+2);if(!o||d.indexOf(o)>=0&&":?<[{(".indexOf(o)<0)break}var a,s=n.pop(),u=this.blankNode(this.here(a));if((a=this.node(e,a+1,n))<0)throw w(this._thisDoc,this.lines,e,a,"EOF found in middle of path syntax");var c=n.pop();"^"==i?this.makeStatement(new r([this._context,c,u,s])):this.makeStatement(new r([this._context,c,s,u])),n.push(u)}return a},m.prototype.anonymousNode=function(e){if(t=this._anonymousNodes[e])return t;var t=this._store.bnode(e);return this._anonymousNodes[e]=t,t},m.prototype.node=function(e,t,a,c){void 0===c&&(c=null);var l=c;if((y=this.skipSpace(e,t))<0)return y;t=y;var h=e.slice(t,t+1);if("["==h){var f=this.here(t);if((y=this.skipSpace(e,t+1))<0)throw w(this._thisDoc,this.lines,e,t,"EOF after '['");if("="==e.slice(y,y+1)){var t=y+1,d=new n([]);if(!((y=this.objectList(e,t,d))>=0))throw w(this._thisDoc,this.lines,e,t,"objectList expected after [= ");l=d[0];if(o(d)>1){var p=new u(d);try{for(;;){var g=p.next();this.makeStatement(new r([this._context,this._store.sym("http://www.w3.org/2002/07/owl#sameAs"),l,g]))}}catch(e){if(e!=s)throw e}}if((y=this.skipSpace(e,y))<0)throw w(this._thisDoc,this.lines,e,t,"EOF when objectList expected after [ = ");if(";"==e.slice(y,y+1))var y=y+1}if(null==l)l=this.blankNode(f);if((t=this.property_list(e,y,l))<0)throw w(this._thisDoc,this.lines,e,y,"property_list expected");if((y=this.skipSpace(e,t))<0)throw w(this._thisDoc,this.lines,e,t,"EOF when ']' expected after [ <propertyList>");if("]"!=e.slice(y,y+1))throw w(this._thisDoc,this.lines,e,y,"']' expected");return a.push(l),y+1}if("{"==h){if("$"==e.slice(t+1,t+2)){for(var y=(t+=1)+1,v=new n([]),m=!0;;){if((t=this.skipSpace(e,y))<0)throw w(this._thisDoc,this.lines,e,t,"needed '$}', found end.");if("$}"==e.slice(t,t+2)){var y=t+2;break}if(m)m=!1;else{if(","!=e.slice(t,t+1))throw w(this._thisDoc,this.lines,e,t,"expected: ','");t+=1}var b=new n([]);if((y=this.item(e,t,b))<0)throw w(this._thisDoc,this.lines,e,t,"expected item in set or '$}'");v.push(b[0])}return a.push(this._store.newSet(v,this._context)),y}var y=t+1,x=this._parentContext;this._parentContext=this._context;var _=this._anonymousNodes,T=this._parentVariables;this._parentVariables=this._variables,this._anonymousNodes=new i([]),this._variables=this._variables.slice();var k=this._reason2;if(this._reason2=null,null==l)l=this._store.formula();for(this._context=l;;){if((t=this.skipSpace(e,y))<0)throw w(this._thisDoc,this.lines,e,t,"needed '}', found end.");if("}"==e.slice(t,t+1)){var y=t+1;break}if((y=this.directiveOrStatement(e,t))<0)throw w(this._thisDoc,this.lines,e,t,"expected statement or '}'")}return this._anonymousNodes=_,this._variables=this._parentVariables,this._parentVariables=T,this._context=this._parentContext,this._reason2=k,this._parentContext=x,a.push(l.close()),y}if("("==h){var S=this._store.list;if("$"==e.slice(t+1,t+2)){S=this._store.newSet;t+=1}for(y=t+1,v=new n([]);;){if((t=this.skipSpace(e,y))<0)throw w(this._thisDoc,this.lines,e,t,"needed ')', found end.");if(")"==e.slice(t,t+1)){y=t+1;break}b=new n([]);if((y=this.item(e,t,b))<0)throw w(this._thisDoc,this.lines,e,t,"expected item in list or ')'");v.push(b[0])}return a.push(S(v,this._context)),y}if((y=this.tok("this",e,t))>=0)throw w(this._thisDoc,this.lines,e,t,"Keyword 'this' was ancient N3. Now use @forSome and @forAll keywords.");if((y=this.tok("true",e,t))>=0)return a.push(!0),y;if((y=this.tok("false",e,t))>=0)return a.push(!1),y;if(null==l&&(y=this.uri_ref2(e,t,a))>=0)return y;return-1},m.prototype.property_list=function(e,t,i){for(;;){if((p=this.skipSpace(e,t))<0)throw w(this._thisDoc,this.lines,e,t,"EOF found when expected verb in property list");if(":-"!=e.slice(p,p+2)){t=p;var o=new n([]);if((p=this.verb(e,t,o))<=0)return t;var a=new n([]);if((t=this.objectList(e,p,a))<0)throw w(this._thisDoc,this.lines,e,p,"objectList expected");var c=new u(a);try{for(;;){var l=c.next(),h=o[0],f=h[0],d=h[1];"->"==f?this.makeStatement(new r([this._context,d,i,l])):this.makeStatement(new r([this._context,d,l,i]))}}catch(e){if(e!=s)throw e}if((p=this.skipSpace(e,t))<0)throw w(this._thisDoc,this.lines,e,p,"EOF found in list of objects");if(";"!=e.slice(t,t+1))return t;t=t+1}else{var p,t=p+2,g=new n([]);if((p=this.node(e,t,g,i))<0)throw w(this._thisDoc,this.lines,e,t,"bad {} or () or [] node after :- ");var t=p}}},m.prototype.commaSeparatedList=function(e,t,r,n){if((i=this.skipSpace(e,t))<0)throw w(this._thisDoc,this.lines,e,i,"EOF found expecting comma sep list");if("."==e.charAt(i))return t;if(n)var i=this.uri_ref2(e,i,r);else i=this.bareWord(e,i,r);if(i<0)return-1;for(;;){if((t=this.skipSpace(e,i))<0)return t;var o=e.slice(t,t+1);if(","!=o)return"."!=o?-1:t;if(n)i=this.uri_ref2(e,t+1,r);else i=this.bareWord(e,t+1,r);if(i<0)throw w(this._thisDoc,this.lines,e,i,"bad list content")}},m.prototype.objectList=function(e,t,r){if((t=this.object(e,t,r))<0)return-1;for(;;){var n=this.skipSpace(e,t);if(n<0)throw w(this._thisDoc,this.lines,e,n,"EOF found after object");if(","!=e.slice(n,n+1))return n;if((t=this.object(e,n+1,r))<0)return t}},m.prototype.checkDot=function(e,t){var r=this.skipSpace(e,t);if(r<0)return r;if("."==e.slice(r,r+1))return r+1;if("}"==e.slice(r,r+1))return r;if("]"==e.slice(r,r+1))return r;throw w(this._thisDoc,this.lines,e,r,"expected '.' or '}' or ']' at end of statement")},m.prototype.uri_ref2=function(e,t,r){var i=new n([]);if((v=this.qname(e,t,i))>=0){var s=i[0],u=s[0],c=s[1];if(null==u){l(0,"not used?");var f=this._baseURI+"#"}else{if(!(f=this._bindings[u])){if("_"==u)return r.push(this.anonymousNode(c)),v;throw w(this._thisDoc,this.lines,e,t,"Prefix "+u+" not bound.")}}var d=this._store.sym(f+c);return Object(Nt.ArrayIndexOf)(this._variables,d)>=0?r.push(this._variables[d]):r.push(d),v}if((t=this.skipSpace(e,t))<0)return-1;if("?"==e.charAt(t)){var p=new n([]);return(v=this.variable(e,t,p))>0?(r.push(p[0]),v):-1}if("<"==e.charAt(t)){for(var g=t=t+1;t<o(e);){if(">"==e.charAt(t)){var y=e.slice(g,t);if(this._baseURI)y=h(this._baseURI,y);else l(y.indexOf(":")>=0,"With no base URI, cannot deal with relative URIs");if("#"==e.slice(t-1,t)&&"#"!=a(y,-1,null))y=y+"#";d=this._store.sym(y);return Object(Nt.ArrayIndexOf)(this._variables,d)>=0?r.push(this._variables[d]):r.push(d),t+1}t=t+1}throw w(this._thisDoc,this.lines,e,v,"unterminated URI reference")}if(this.keywordsSet){var v;p=new n([]);if((v=this.bareWord(e,t,p))<0)return-1;if(Object(Nt.ArrayIndexOf)(this.keywords,p[0])>=0)throw w(this._thisDoc,this.lines,e,t,'Keyword "'+p[0]+'" not allowed here.');return r.push(this._store.sym(this._bindings[""]+p[0])),v}return-1},m.prototype.skipSpace=function(e,t){for(var r=t||0;r<e.length;r++){var n=e.charAt(r);if(" \n\r\t\f\v            ​\u2028\u2029　".indexOf(n)<0){if("#"!==e.charAt(r))return r;for(;;r++){if(r===e.length)return-1;if("\n"===e.charAt(r)){this.lines=this.lines+1;break}}}else"\n"===e.charAt(r)&&(this.lines=this.lines+1)}return-1},m.prototype.variable=function(e,t,r){if((n=this.skipSpace(e,t))<0)return-1;if("?"!=e.slice(n,n+1))return-1;var n;t=n+=1;if("0123456789-".indexOf(e.charAt(n))>=0)throw w(this._thisDoc,this.lines,e,n,"Varible name can't start with '"+e.charAt(n)+"s'");for(;t<o(e)&&d.indexOf(e.charAt(t))<0;)t=t+1;if(null==this._parentContext)throw w(this._thisDoc,this.lines,e,n,"Can't use ?xxx syntax for variable in outermost level: "+e.slice(n-1,t));return r.push(this._store.variable(e.slice(n,t))),t},m.prototype.bareWord=function(e,t,r){var n=this.skipSpace(e,t);if(n<0)return-1;var i=e.charAt(n);if("0123456789-".indexOf(i)>=0)return-1;if(d.indexOf(i)>=0)return-1;for(t=n;t<o(e)&&d.indexOf(e.charAt(t))<0;)t=t+1;return r.push(e.slice(n,t)),t},m.prototype.qname=function(e,t,n){if((t=this.skipSpace(e,t))<0)return-1;var i=e.charAt(t);if("0123456789-+".indexOf(i)>=0)return-1;if(d.indexOf(i)<0){var a=i;for(t=t+1;t<o(e);){i=e.charAt(t);if(!(d.indexOf(i)<0))break;a=a+i,t=t+1}}else a="";if(t<o(e)&&":"==e.charAt(t)){var s=a;for(t=t+1,a="";t<o(e);){i=e.charAt(t);if(!(d.indexOf(i)<0))break;a=a+i,t=t+1}return n.push(new r([s,a])),t}return a&&this.keywordsSet&&Object(Nt.ArrayIndexOf)(this.keywords,a)<0?(n.push(new r(["",a])),t):-1},m.prototype.object=function(e,t,r){if((s=this.subject(e,t,r))>=0)return s;if((s=this.skipSpace(e,t))<0)return-1;t=s;var n=null,i=e.charAt(t);if('"'==i||"'"==i){n=e.slice(t,t+3==i+i)?i+i+i:i;t=t+o(n);var a=this.strconst(e,t,n),s=a[0],u=a[1];return r.push(this._store.literal(u)),s}return-1},m.prototype.nodeOrLiteral=function(e,t,r){if((l=this.node(e,t,r))>=0)return l;if((l=this.skipSpace(e,t))<0)return-1;t=l;var i=e.charAt(t);if("-+0987654321".indexOf(i)>=0){if(g.lastIndex=0,null!=(d=g.exec(e.slice(t)))){l=t+(a=d[0]).length,a.indexOf("T")>=0?r.push(this._store.literal(a,void 0,this._store.sym("http://www.w3.org/2001/XMLSchema#dateTime"))):r.push(this._store.literal(a,void 0,this._store.sym("http://www.w3.org/2001/XMLSchema#date")))}else{var a;if(p.lastIndex=0,null==(d=p.exec(e.slice(t))))throw w(this._thisDoc,this.lines,e,t,"Bad number or date syntax");l=t+p.lastIndex,(a=e.slice(t,l)).indexOf("e")>=0?r.push(this._store.literal(parseFloat(a),void 0,this._store.sym("http://www.w3.org/2001/XMLSchema#double"))):e.slice(t,l).indexOf(".")>=0?r.push(this._store.literal(parseFloat(a),void 0,this._store.sym("http://www.w3.org/2001/XMLSchema#decimal"))):r.push(this._store.literal(parseInt(a),void 0,this._store.sym("http://www.w3.org/2001/XMLSchema#integer")))}return l}if('"'==e.charAt(t)){if('"""'==e.slice(t,t+3))var s='"""';else s='"';t=t+o(s);var u=null,c=this.strconst(e,t,s),l=c[0],h=c[1],f=null;if("@"==e.slice(l,l+1)){var d;if(v.lastIndex=0,null==(d=v.exec(e.slice(l+1))))throw w(this._thisDoc,startline,e,t,"Bad language code syntax on string literal, after @");t=v.lastIndex+l+1,f=e.slice(l+1,t),l=t}if("^^"==e.slice(l,l+2)){var y=new n([]);l=this.uri_ref2(e,l+2,y),u=y[0]}return r.push(this._store.literal(h,f,u)),l}return-1},m.prototype.strconst=function(e,t,n){for(var i=t,a="",s=this.lines;i<o(e);){t=i+o(n);if(e.slice(i,t)==n)return new r([t,a]);if('"'!=e.charAt(i)){if(y.lastIndex=0,!y.exec(e.slice(i)))throw w(this._thisDoc,s,e,i,"Closing quote missing in string at ^ in "+e.slice(i-20,i)+"^"+e.slice(i,i+20));t=i+y.lastIndex-1,a=a+e.slice(i,t);if('"'!=(h=e.charAt(t)))if("\r"!=h){if("\n"==h){if('"'==n)throw w(this._thisDoc,s,e,t,"newline found in string literal");this.lines=this.lines+1;a=a+h,i=t+1;this.previousLine=this.startOfLine,this.startOfLine=i}else if("\\"==h){i=t+1;if(!(h=e.slice(i,i+1)))throw w(this._thisDoc,s,e,t,"unterminated string literal (2)");var u=c('abfrtvn\\"',h);if(u>=0)a=a+'a\b\f\r\t\v\n\\"'.charAt(u),i=i+1;else if("u"==h)i=(l=this.uEscape(e,i+1,s))[0],a=a+(h=l[1]);else{if("U"!=h)throw w(this._thisDoc,this.lines,e,t,"bad escape");var l,h;i=(l=this.UEscape(e,i+1,s))[0],a=a+(h=l[1])}}}else var i=t+1;else var i=t}else var a=a+'"',i=i+1}throw w(this._thisDoc,this.lines,e,t,"unterminated string literal")},m.prototype.uEscape=function(e,t,n){for(var i=t,o=0,a=0;o<4;){var s=e.slice(i,i+1).toLowerCase();i=i+1;if(""==s)throw w(this._thisDoc,n,e,t,"unterminated string literal(3)");var u=c("0123456789abcdef",s);if(u<0)throw w(this._thisDoc,n,e,t,"bad string literal hex escape");a=16*a+u,o=o+1}var l=String.fromCharCode(a);return new r([i,l])},m.prototype.UEscape=function(e,t,n){for(var i=t,o=0,s="\\U";o<8;){var u=e.slice(i,i+1).toLowerCase();i=i+1;if(""==u)throw w(this._thisDoc,n,e,t,"unterminated string literal(3)");if(c("0123456789abcdef",u)<0)throw w(this._thisDoc,n,e,t,"bad string literal hex escape");s=s+u,o=o+1}var l,h=(l="0x"+a(s,2,10)-0,String.fromCharCode(l));return new r([i,h])},b.prototype.toString=function(){var e=this._str,t=this._i,n=0;if(t>60){var i="...";n=t-60}else i="";if(o(e)-t>60)var a="...";else a="";return'Line %i of <%s>: Bad syntax (%s) at ^ in:\n"%s%s^%s%s"'%new r([this.lines+1,this._uri,this._why,i,e.slice(n,t),e.slice(t,t+60),a])},function(e,t,r,n,i,o,a,s){return new m(e,t,r,n,i,o,a,s)}}();if(void 0===Ht)var Ht={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12};var Vt=function(){function e(t,r){o()(this,e),this.options=r||{},this.kb=t,this.target=r.target||{graph:{subjects:{},prefixes:{},terms:{}}},this.blankNodes=[],this.htmlOptions={selfClosing:"br img input area base basefont col colgroup source wbr isindex link meta param hr"},this.theOne="_:"+(new Date).getTime(),this.language=null,this.vocabulary=null,this.blankCounter=0,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"}],this.inXHTMLMode=!1,this.absURIRE=/[\w\_\-]+:\S+/,this.finishedHandlers=[],this.init()}return s()(e,[{key:"addTriple",value:function(e,t,r,n){var i,o,a,s;i=void 0===t?lr.namedNode(this.options.base):this.toRDFNodeObject(t),a=this.toRDFNodeObject(r),o=this.toRDFNodeObject(n),s=lr.namedNode(this.options.base),this.kb.add(i,a,o,s)}},{key:"ancestorPath",value:function(e){for(var t="";e&&e.nodeType!==Ht.DOCUMENT_NODE;)t="/"+e.localName+t,e=e.parentNode;return t}},{key:"copyMappings",value:function(e){var t={};for(var r in e)t[r]=e[r];return t}},{key:"copyProperties",value:function(){}},{key:"deriveDateTimeType",value:function(t){for(var r=0;r<e.dateTimeTypes.length;r++){var n=e.dateTimeTypes[r].pattern.exec(t);if(n&&n[0].length===t.length)return e.dateTimeTypes[r].type}return null}},{key:"init",value:function(){}},{key:"newBlankNode",value:function(){return this.blankCounter++,"_:"+this.blankCounter}},{key:"newSubjectOrigin",value:function(e,t){}},{key:"parseCURIE",value:function(t,r,n){var i,o=t.indexOf(":");if(o>=0){var a=t.substring(0,o);if(""===a)return(i=r[""])?i+t.substring(o+1):null;if("_"===a)return"_:"+t.substring(o+1);if(e.NCNAME.test(a)&&(i=r[a]))return i+t.substring(o+1)}return null}},{key:"parseCURIEOrURI",value:function(e,t,r){var n=this.parseCURIE(e,t,r);return n||this.resolveAndNormalize(r,e)}},{key:"parsePredicate",value:function(e,t,r,n,i,o){if(""===e)return null;var a=this.parseTermOrCURIEOrAbsURI(e,t,o?null:r,n,i);return a&&0===a.indexOf("_:")?null:a}},{key:"parsePrefixMappings",value:function(e,t){for(var r=this.tokenize(e),n=null,i=0;i<r.length;i++)":"===r[i][r[i].length-1]?n=r[i].substring(0,r[i].length-1):n&&(t[n]=this.options.base?Et.join(r[i],this.options.base):r[i],n=null)}},{key:"parseSafeCURIEOrCURIEOrURI",value:function(e,t,r){return"["===(e=this.trim(e)).charAt(0)&&"]"===e.charAt(e.length-1)?0===(e=(e=e.substring(1,e.length-1)).trim(e)).length?null:"_:"===e?this.theOne:this.parseCURIE(e,t,r):this.parseCURIEOrURI(e,t,r)}},{key:"parseTermOrCURIEOrAbsURI",value:function(e,t,r,n,i){e=this.trim(e);var o=this.parseCURIE(e,n,i);if(o)return o;if(r){if(t&&!this.absURIRE.exec(e))return t+e;var a=r[e];if(a)return a;if(a=r[e.toLowerCase()])return a}return this.absURIRE.exec(e)?this.resolveAndNormalize(i,e):null}},{key:"parseTermOrCURIEOrURI",value:function(e,t,r,n,i){e=this.trim(e);var o=this.parseCURIE(e,n,i);if(o)return o;var a=r[e];return a||((a=r[e.toLowerCase()])?a:t&&!this.absURIRE.exec(e)?t+e:this.resolveAndNormalize(i,e))}},{key:"parseURI",value:function(e){return e}},{key:"process",value:function(t,r){var n;r=r||{},t.nodeType===Ht.DOCUMENT_NODE?(t.baseURI&&!r.baseURI&&(r.baseURI=t.baseURI),n=t.baseURI,(t=t.documentElement).baseURI||(t.baseURI=n),this.setContext(t)):t.parentNode.nodeType===Ht.DOCUMENT_NODE&&this.setContext(t);var i=[],o=function(e){if(!e&&r&&r.baseURI)return r.baseURI;var t=e.indexOf("#");return t>=0&&(e=e.substring(0,t)),r&&r.baseURIMap&&(e=r.baseURIMap(e)),e};for(i.push({current:t,context:this.push(null,o(t.baseURI))});i.length>0;){var a=i.shift();if(a.parent){if(a.context.parent&&a.context.parent.listMapping===a.listMapping)continue;for(var s in a.listMapping){var u=a.listMapping[s];if(0!==u.length){for(var c=[],l=0;l<u.length;l++)c.push(this.newBlankNode());for(var h=0;h<c.length;h++)this.addTriple(a.parent,c[h],"http://www.w3.org/1999/02/22-rdf-syntax-ns#first",u[h]),this.addTriple(a.parent,c[h],"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest",{type:e.objectURI,value:h+1<c.length?c[h+1]:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"});this.addTriple(a.parent,a.subject,s,{type:e.objectURI,value:c[0]})}else this.addTriple(a.parent,a.subject,s,{type:e.objectURI,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"})}}else{var f=a.current,d=a.context,p=!1,g=null,y=null,v=null,m=d.prefixes,b=!1,w=[],x=d.listMapping,_=!d.parent,T=d.language,k=d.vocabulary;n=this.parseURI(o(f.baseURI)),f.item=null;var S=f.getAttributeNode("vocab");if(S){var I=this.trim(S.value);if(I.length>0){k=I;var N=n.spec;this.addTriple(f,N,"http://www.w3.org/ns/rdfa#usesVocabulary",{type:e.objectURI,value:k})}else k=this.vocabulary}for(var j=0;j<f.attributes.length;j++){var E=f.attributes[j];if("x"===E.nodeName.charAt(0)&&0===E.nodeName.indexOf("xmlns:")){b||(m=this.copyMappings(m),b=!0);var O=E.nodeName.substring(6),C=e.trim(E.value);m[O]=this.options.base?Et.join(C,this.options.base):C}}var R=f.getAttributeNode("prefix");R&&(b||(m=this.copyMappings(m),b=!0),this.parsePrefixMappings(R.value,m));for(var A=null,L=0;!A&&L<this.langAttributes.length;L++)A=f.getAttributeNodeNS(this.langAttributes[L].namespaceURI,this.langAttributes[L].localName);if(A){var D=e.trim(A.value);T=D.length>0?D:null}var M,U,P=f.getAttributeNode("rel"),B=f.getAttributeNode("rev"),F=f.getAttributeNode("typeof"),q=f.getAttributeNode("property"),z=f.getAttributeNode("datatype"),H=this.inHTMLMode?f.getAttributeNode("datetime"):null,V=f.getAttributeNode("content"),X=f.getAttributeNode("about"),W=f.getAttributeNode("src"),G=f.getAttributeNode("resource"),J=f.getAttributeNode("href"),Q=f.getAttributeNode("inlist"),Y=[];if(P){U=this.tokenize(P.value);for(var $=0;$<U.length;$++)(M=this.parsePredicate(U[$],k,d.terms,m,n,this.inHTMLMode&&null!==q))&&Y.push(M)}var Z=[];if(B){U=this.tokenize(B.value);for(var K=0;K<U.length;K++)(M=this.parsePredicate(U[K],k,d.terms,m,n,this.inHTMLMode&&q))&&Z.push(M)}if(this.inHTMLMode&&(P||B)&&q&&(0===Y.length&&(P=null),0===Z.length&&(B=null)),P||B?(X&&(g=this.parseSafeCURIEOrCURIEOrURI(X.value,m,n)),F&&(v=g),g||(f.parentNode.nodeType===Ht.DOCUMENT_NODE?g=o(f.baseURI):d.parentObject&&(g=o(f.parentNode.baseURI)===d.parentObject?o(f.baseURI):d.parentObject)),G&&(y=this.parseSafeCURIEOrCURIEOrURI(G.value,m,n)),y||(J?y=this.resolveAndNormalize(n,encodeURI(J.value)):W?y=this.resolveAndNormalize(n,encodeURI(W.value)):!F||X||this.inXHTMLMode&&("head"===f.localName||"body"===f.localName)||(y=this.newBlankNode())),!F||X||!this.inXHTMLMode||"head"!==f.localName&&"body"!==f.localName?F&&!X&&(v=y):v=g):!q||V||z?(X&&(g=this.parseSafeCURIEOrCURIEOrURI(X.value,m,n)),!g&&G&&(g=this.parseSafeCURIEOrCURIEOrURI(G.value,m,n)),!g&&J&&(g=this.resolveAndNormalize(n,encodeURI(J.value))),!g&&W&&(g=this.resolveAndNormalize(n,encodeURI(W.value))),g||(f.parentNode.nodeType===Ht.DOCUMENT_NODE?g=o(f.baseURI):!this.inXHTMLMode&&!this.inHTMLMode||"head"!==f.localName&&"body"!==f.localName?F?g=this.newBlankNode():d.parentObject&&(g=o(f.parentNode.baseURI)===d.parentObject?o(f.baseURI):d.parentObject,q||(p=!0)):g=o(f.parentNode.baseURI)===d.parentObject?o(f.baseURI):d.parentObject),F&&(v=g)):(X&&(g=this.parseSafeCURIEOrCURIEOrURI(X.value,m,n),F&&(v=g)),g||f.parentNode.nodeType!==Ht.DOCUMENT_NODE?!g&&d.parentObject&&(g=o(f.parentNode.baseURI)===d.parentObject?o(f.baseURI):d.parentObject):(g=o(f.baseURI),F&&(v=g)),F&&!v&&(G&&(v=this.parseSafeCURIEOrCURIEOrURI(G.value,m,n)),!v&&J&&(v=this.resolveAndNormalize(n,encodeURI(J.value))),!v&&W&&(v=this.resolveAndNormalize(n,encodeURI(W.value))),v||!this.inXHTMLMode&&!this.inHTMLMode||"head"!==f.localName&&"body"!==f.localName||(v=g),v||(v=this.newBlankNode()),y=v)),g&&(X||G||v)){var ee=g;F&&!X&&!G&&y&&(ee=y),this.newSubjectOrigin(f,ee)}if(v){U=this.tokenize(F.value);for(var te=0;te<U.length;te++){var re=this.parseTermOrCURIEOrAbsURI(U[te],k,d.terms,m,n);re&&this.addTriple(f,v,e.typeURI,{type:e.objectURI,value:re})}}if(g&&g!==d.parentObject&&(x={},_=!0),y){if(P&&Q)for(var ne=0;ne<Y.length;ne++){var ie=x[Y[ne]];ie||(ie=[],x[Y[ne]]=ie),ie.push({type:e.objectURI,value:y})}else if(P)for(var oe=0;oe<Y.length;oe++)this.addTriple(f,g,Y[oe],{type:e.objectURI,value:y});if(B)for(var ae=0;ae<Z.length;ae++)this.addTriple(f,y,Z[ae],{type:e.objectURI,value:g})}else{if(g&&!y&&(P||B)&&(y=this.newBlankNode()),P&&Q)for(var se=0;se<Y.length;se++){var ue=x[Y[se]];ue||(ue=[],x[M]=ue),w.push({predicate:Y[se],list:ue})}else if(P)for(var ce=0;ce<Y.length;ce++)w.push({predicate:Y[ce],forward:!0});if(B)for(var le=0;le<Z.length;le++)w.push({predicate:Z[le],forward:!1})}if(q){var he=null,fe=null;z?(he=""===z.value?e.PlainLiteralURI:this.parseTermOrCURIEOrAbsURI(z.value,k,d.terms,m,n),fe=H&&!V?H.value:he===e.XMLLiteralURI||he===e.HTMLLiteralURI?null:V?V.value:f.textContent):V?(he=e.PlainLiteralURI,fe=V.value):H?(fe=H.value,(he=e.deriveDateTimeType(fe))||(he=e.PlainLiteralURI)):P||B||(G&&(fe=this.parseSafeCURIEOrCURIEOrURI(G.value,m,n)),!fe&&J?fe=this.resolveAndNormalize(n,encodeURI(J.value)):!fe&&W&&(fe=this.resolveAndNormalize(n,encodeURI(W.value))),fe&&(he=e.objectURI)),he||(F&&!X?(he=e.objectURI,fe=v):(fe=f.textContent,this.inHTMLMode&&"time"===f.localName&&(he=e.deriveDateTimeType(fe)),he||(he=e.PlainLiteralURI))),U=this.tokenize(q.value);for(var de=0;de<U.length;de++){var pe=this.parsePredicate(U[de],k,d.terms,m,n);if(pe)if(Q){var ge=x[pe];ge||(ge=[],x[pe]=ge),ge.push(he===e.XMLLiteralURI||he===e.HTMLLiteralURI?{type:he,value:f.childNodes}:{type:he||e.PlainLiteralURI,value:fe,language:T})}else he===e.XMLLiteralURI||he===e.HTMLLiteralURI?this.addTriple(f,g,pe,{type:he,value:f.childNodes}):this.addTriple(f,g,pe,{type:he||e.PlainLiteralURI,value:fe,language:T})}}if(g&&!p)for(var ye=0;ye<d.incomplete.length;ye++)d.incomplete[ye].list?d.incomplete[ye].list.push({type:e.objectURI,value:g}):d.incomplete[ye].forward?this.addTriple(f,d.subject,d.incomplete[ye].predicate,{type:e.objectURI,value:g}):this.addTriple(f,g,d.incomplete[ye].predicate,{type:e.objectURI,value:d.subject});var ve=null,me=g;p?((ve=this.push(d,d.subject)).parentObject=o(f.parentNode.baseURI)===d.parentObject?o(f.baseURI):d.parentObject,ve.incomplete=d.incomplete,ve.language=T,ve.prefixes=m,ve.vocabulary=k):((ve=this.push(d,g)).parentObject=y||g||d.subject,ve.prefixes=m,ve.incomplete=w,y&&(me=y,x={},_=!0),ve.listMapping=x,ve.language=T,ve.vocabulary=k),_&&i.unshift({parent:f,context:d,subject:me,listMapping:x});for(var be=f.lastChild;be;be=be.previousSibling)be.nodeType===Ht.ELEMENT_NODE&&i.unshift({current:be,context:ve})}}this.inHTMLMode&&this.copyProperties();for(var we=0;we<this.finishedHandlers.length;we++)this.finishedHandlers[we](t)}},{key:"push",value:function(e,t){return{parent:e,subject:t||(e?e.subject:null),parentObject:null,incomplete:[],listMapping:e?e.listMapping:{},language:e?e.language:this.language,prefixes:e?e.prefixes:this.target.graph.prefixes,terms:e?e.terms:this.target.graph.terms,vocabulary:e?e.vocabulary:this.vocabulary}}},{key:"resolveAndNormalize",value:function(e,t){return Et.join(t,e)}},{key:"setContext",value:function(e){"html"===e.localName&&"XHTML+RDFa 1.1"===e.getAttribute("version")?this.setXHTMLContext():"html"===e.localName||"http://www.w3.org/1999/xhtml"===e.namespaceURI?"undefined"!=typeof document&&document.doctype?"-//W3C//DTD XHTML+RDFa 1.0//EN"===document.doctype.publicId&&"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd"===document.doctype.systemId?(console.log("WARNING: RDF 1.0 is not supported.  Defaulting to HTML5 mode."),this.setHTMLContext()):"-//W3C//DTD XHTML+RDFa 1.1//EN"===document.doctype.publicId&&"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-2.dtd"===document.doctype.systemId?this.setXHTMLContext():this.setHTMLContext():this.setHTMLContext():this.setXMLContext()}},{key:"setHTMLContext",value:function(){this.setInitialContext(),this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"},{namespaceURI:null,localName:"lang"}],this.inXHTMLMode=!1,this.inHTMLMode=!0}},{key:"setInitialContext",value:function(){this.vocabulary=null,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"}]}},{key:"setXHTMLContext",value:function(){this.setInitialContext(),this.inXHTMLMode=!0,this.inHTMLMode=!1,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"},{namespaceURI:null,localName:"lang"}],this.target.graph.terms.alternate="http://www.w3.org/1999/xhtml/vocab#alternate",this.target.graph.terms.appendix="http://www.w3.org/1999/xhtml/vocab#appendix",this.target.graph.terms.bookmark="http://www.w3.org/1999/xhtml/vocab#bookmark",this.target.graph.terms.cite="http://www.w3.org/1999/xhtml/vocab#cite",this.target.graph.terms.chapter="http://www.w3.org/1999/xhtml/vocab#chapter",this.target.graph.terms.contents="http://www.w3.org/1999/xhtml/vocab#contents",this.target.graph.terms.copyright="http://www.w3.org/1999/xhtml/vocab#copyright",this.target.graph.terms.first="http://www.w3.org/1999/xhtml/vocab#first",this.target.graph.terms.glossary="http://www.w3.org/1999/xhtml/vocab#glossary",this.target.graph.terms.help="http://www.w3.org/1999/xhtml/vocab#help",this.target.graph.terms.icon="http://www.w3.org/1999/xhtml/vocab#icon",this.target.graph.terms.index="http://www.w3.org/1999/xhtml/vocab#index",this.target.graph.terms.last="http://www.w3.org/1999/xhtml/vocab#last",this.target.graph.terms.license="http://www.w3.org/1999/xhtml/vocab#license",this.target.graph.terms.meta="http://www.w3.org/1999/xhtml/vocab#meta",this.target.graph.terms.next="http://www.w3.org/1999/xhtml/vocab#next",this.target.graph.terms.prev="http://www.w3.org/1999/xhtml/vocab#prev",this.target.graph.terms.previous="http://www.w3.org/1999/xhtml/vocab#previous",this.target.graph.terms.section="http://www.w3.org/1999/xhtml/vocab#section",this.target.graph.terms.stylesheet="http://www.w3.org/1999/xhtml/vocab#stylesheet",this.target.graph.terms.subsection="http://www.w3.org/1999/xhtml/vocab#subsection",this.target.graph.terms.start="http://www.w3.org/1999/xhtml/vocab#start",this.target.graph.terms.top="http://www.w3.org/1999/xhtml/vocab#top",this.target.graph.terms.up="http://www.w3.org/1999/xhtml/vocab#up",this.target.graph.terms.p3pv1="http://www.w3.org/1999/xhtml/vocab#p3pv1",this.target.graph.terms.related="http://www.w3.org/1999/xhtml/vocab#related",this.target.graph.terms.role="http://www.w3.org/1999/xhtml/vocab#role",this.target.graph.terms.transformation="http://www.w3.org/1999/xhtml/vocab#transformation"}},{key:"setXMLContext",value:function(){this.setInitialContext(),this.inXHTMLMode=!1,this.inHTMLMode=!1}},{key:"tokenize",value:function(e){return this.trim(e).split(/\s+/)}},{key:"toRDFNodeObject",value:function(t){if(void 0!==t){if("string"==typeof t)return"_:"===t.substring(0,2)?(void 0===this.blankNodes[t.substring(2)]&&(this.blankNodes[t.substring(2)]=new y(t.substring(2))),this.blankNodes[t.substring(2)]):lr.namedNode(t);switch(t.type){case e.objectURI:return"_:"===t.value.substring(0,2)?(void 0===this.blankNodes[t.value.substring(2)]&&(this.blankNodes[t.value.substring(2)]=new y(t.value.substring(2))),this.blankNodes[t.value.substring(2)]):lr.namedNode(t.value);case e.PlainLiteralURI:return new mt(t.value,t.language||"");case e.XMLLiteralURI:case e.HTMLLiteralURI:var r="";return Object.keys(t.value).forEach(function(e){r+=Nt.domToString(t.value[e],this.htmlOptions)}),new mt(r,"",new yt.a(t.type));default:return new mt(t.value,"",new yt.a(t.type))}}}},{key:"trim",value:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}],[{key:"parseRDFaDOM",value:function(t,r,n){var i=new e(r,{base:n});t.baseURI||(t.baseURI=n),i.process(t,{baseURI:n})}},{key:"tokenize",value:function(e){return this.trim(e).split(/\s+/)}},{key:"trim",value:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}]),e}();Vt.XMLLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral",Vt.HTMLLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#HTML",Vt.PlainLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#PlainLiteral",Vt.objectURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#object",Vt.typeURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",Vt.nameChar="[-A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�က0-F.0-9·̀-ͯ‿-⁀]",Vt.nameStartChar="[A-Za-zÀ-ÖØ-öø-ÿĀ-ıĴ-ľŁ-ňŊ-žƀ-ǃǍ-ǰǴ-ǵǺ-ȗɐ-ʨʻ-ˁΆΈ-ΊΌΎ-ΡΣ-ώϐ-ϖϚϜϞϠϢ-ϳЁ-ЌЎ-яё-ќў-ҁҐ-ӄӇ-ӈӋ-ӌӐ-ӫӮ-ӵӸ-ӹԱ-Ֆՙա-ֆא-תװ-ײء-غف-يٱ-ڷں-ھۀ-ێې-ۓەۥ-ۦअ-हऽक़-ॡঅ-ঌএ-ঐও-নপ-রলশ-হড়-ঢ়য়-ৡৰ-ৱਅ-ਊਏ-ਐਓ-ਨਪ-ਰਲ-ਲ਼ਵ-ਸ਼ਸ-ਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઋઍએ-ઑઓ-નપ-રલ-ળવ-હઽૠଅ-ଌଏ-ଐଓ-ନପ-ରଲ-ଳଶ-ହଽଡ଼-ଢ଼ୟ-ୡஅ-ஊஎ-ஐஒ-கங-சஜஞ-டண-தந-பம-வஷ-ஹఅ-ఌఎ-ఐఒ-నప-ళవ-హౠ-ౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹೞೠ-ೡഅ-ഌഎ-ഐഒ-നപ-ഹൠ-ൡก-ฮะา-ำเ-ๅກ-ຂຄງ-ຈຊຍດ-ທນ-ຟມ-ຣລວສ-ຫອ-ຮະາ-ຳຽເ-ໄཀ-ཇཉ-ཀྵႠ-Ⴥა-ჶᄀᄂ-ᄃᄅ-ᄇᄉᄋ-ᄌᄎ-ᄒᄼᄾᅀᅌᅎᅐᅔ-ᅕᅙᅟ-ᅡᅣᅥᅧᅩᅭ-ᅮᅲ-ᅳᅵᆞᆨᆫᆮ-ᆯᆷ-ᆸᆺᆼ-ᇂᇫᇰᇹḀ-ẛẠ-ỹἀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼΩK-Å℮ↀ-ↂぁ-ゔァ-ヺㄅ-ㄬ가-힣一-龥〇〡-〩_]",Vt.NCNAME=new RegExp("^"+Vt.nameStartChar+Vt.nameChar+"*$"),Vt.dateTimeTypes=[{pattern:/-?P(?:[0-9]+Y)?(?:[0-9]+M)?(?:[0-9]+D)?(?:T(?:[0-9]+H)?(?:[0-9]+M)?(?:[0-9]+(?:\.[0-9]+)?S)?)?/,type:"http://www.w3.org/2001/XMLSchema#duration"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]-[0-9][0-9]T(?:[0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9](?:\.[0-9]+)?(?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#dateTime"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]-[0-9][0-9](?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#date"},{pattern:/(?:[0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9](?:\.[0-9]+)?(?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#time"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]/,type:"http://www.w3.org/2001/XMLSchema#gYearMonth"},{pattern:/-?[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9]/,type:"http://www.w3.org/2001/XMLSchema#gYear"}];var Xt=Vt.parseRDFaDOM;function Wt(e){var t={ns:{RDF:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDFS:"http://www.w3.org/2000/01/rdf-schema#"},nodeType:{ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12}};this.frameFactory=function(e,r,n){return{NODE:1,ARC:2,parent:r,parser:e,store:e.store,element:n,lastChild:0,base:null,lang:null,node:null,nodeType:null,listIndex:1,rdfid:null,datatype:null,collection:!1,terminateFrame:function(){this.collection&&this.node.close()},addSymbol:function(e,t){t=Et.join(t,this.base),this.node=this.store.sym(t),this.nodeType=e},loadTriple:function(){if(this.parent.parent.collection?this.parent.parent.node.append(this.node):this.store.add(this.parent.parent.node,this.parent.node,this.node,this.parser.why),null!=this.parent.rdfid){var e=this.store.sym(Et.join("#"+this.parent.rdfid,this.base));this.store.add(e,this.store.sym(t.ns.RDF+"type"),this.store.sym(t.ns.RDF+"Statement"),this.parser.why),this.store.add(e,this.store.sym(t.ns.RDF+"subject"),this.parent.parent.node,this.parser.why),this.store.add(e,this.store.sym(t.ns.RDF+"predicate"),this.parent.node,this.parser.why),this.store.add(e,this.store.sym(t.ns.RDF+"object"),this.node,this.parser.why)}},isTripleToLoad:function(){return null!=this.parent&&null!=this.parent.parent&&this.nodeType===this.NODE&&this.parent.nodeType===this.ARC&&this.parent.parent.nodeType===this.NODE},addNode:function(e){this.addSymbol(this.NODE,e),this.isTripleToLoad()&&this.loadTriple()},addCollection:function(){this.nodeType=this.NODE,this.node=this.store.collection(),this.collection=!0,this.isTripleToLoad()&&this.loadTriple()},addCollectionArc:function(){this.nodeType=this.ARC},addBNode:function(e){null!=e?null!=this.parser.bnodes[e]?this.node=this.parser.bnodes[e]:this.node=this.parser.bnodes[e]=this.store.bnode():this.node=this.store.bnode(),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()},addArc:function(e){e===t.ns.RDF+"li"&&(e=t.ns.RDF+"_"+this.parent.listIndex,this.parent.listIndex++),this.addSymbol(this.ARC,e)},addLiteral:function(e){this.parent.datatype?this.node=this.store.literal(e,"",this.store.sym(this.parent.datatype)):this.node=this.store.literal(e,this.lang),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()}}},this.getAttributeNodeNS=function(e,t,r){var n=null;if(e.getAttributeNodeNS)n=e.getAttributeNodeNS(t,r);else for(var i,o=e.attributes,a=0;a<o.length;++a)if((i=o[a]).namespaceURI===t&&(i.prefix?i.prefix+":"+r:r)===i.nodeName){n=i;break}return n},this.store=e,this.bnodes={},this.why=null,this.reify=!1,this.parse=function(e,r,n){var i,o=e.childNodes;if(this.cleanParser(),e.nodeType===t.nodeType.DOCUMENT){for(var a=0;a<o.length;a++)if(o[a].nodeType===t.nodeType.ELEMENT){i=o[a];break}}else{if(e.nodeType!==t.nodeType.ELEMENT)throw new Error("RDFParser: can't find root in "+r+". Halting. ");i=e}this.why=n;var s=this.frameFactory(this);return this.base=r,s.base=r,s.lang=null,this.parseDOM(this.buildFrame(s,i)),!0},this.parseDOM=function(e){for(var r,n=function(e){var t="";if(null==e.namespaceURI)throw new Error("RDF/XML syntax error: No namespace for "+e.localName+" in "+this.base);return e.namespaceURI&&(t+=e.namespaceURI),e.localName?t+=e.localName:e.nodeName&&(e.nodeName.indexOf(":")>=0?t+=e.nodeName.split(":")[1]:t+=e.nodeName),t}.bind(this),i=!0;e.parent;){var o=e.element,a=o.attributes;if(o.nodeType===t.nodeType.TEXT||o.nodeType===t.nodeType.CDATA_SECTION)e.parent.nodeType===e.NODE&&(e.addArc(t.ns.RDF+"value"),e=this.buildFrame(e)),e.addLiteral(o.nodeValue);else if(n(o)!==t.ns.RDF+"RDF")if(e.parent&&e.parent.collection&&(e.addCollectionArc(),(e=this.buildFrame(e,e.element)).parent.element=null),e.parent&&e.parent.nodeType&&e.parent.nodeType!==e.ARC){e.addArc(n(o)),this.reify&&(r=this.getAttributeNodeNS(o,t.ns.RDF,"ID"))&&(e.rdfid=r.nodeValue,o.removeAttributeNode(r));var s=this.getAttributeNodeNS(o,t.ns.RDF,"parseType"),u=this.getAttributeNodeNS(o,t.ns.RDF,"datatype");if(u&&(e.datatype=u.nodeValue,o.removeAttributeNode(u)),s){var c=s.nodeValue;"Literal"===c?(e.datatype=t.ns.RDF+"XMLLiteral",(e=this.buildFrame(e)).addLiteral(o.childNodes),i=!1):"Resource"===c?((e=this.buildFrame(e,e.element)).parent.element=null,e.addBNode()):"Collection"===c&&((e=this.buildFrame(e,e.element)).parent.element=null,e.addCollection()),o.removeAttributeNode(s)}if(0!==a.length){var l=this.getAttributeNodeNS(o,t.ns.RDF,"resource"),h=this.getAttributeNodeNS(o,t.ns.RDF,"nodeID");e=this.buildFrame(e),l?(e.addNode(l.nodeValue),o.removeAttributeNode(l)):h?(e.addBNode(h.nodeValue),o.removeAttributeNode(h)):e.addBNode();for(var f=a.length-1;f>=0;f--){var d=this.buildFrame(e);d.addArc(n(a[f])),n(a[f])===t.ns.RDF+"type"?this.buildFrame(d).addNode(a[f].nodeValue):this.buildFrame(d).addLiteral(a[f].nodeValue)}}else 0===o.childNodes.length&&this.buildFrame(e).addLiteral("")}else{var p=this.getAttributeNodeNS(o,t.ns.RDF,"about");if(r=this.getAttributeNodeNS(o,t.ns.RDF,"ID"),p&&r)throw new Error("RDFParser: "+o.nodeName+" has both rdf:id and rdf:about. Halting. Only one of these properties may be specified on a node.");if(!p&&r)e.addNode("#"+r.nodeValue),o.removeAttributeNode(r);else if(null==p&&null==r){var g=this.getAttributeNodeNS(o,t.ns.RDF,"nodeID");g?(e.addBNode(g.nodeValue),o.removeAttributeNode(g)):e.addBNode()}else e.addNode(p.nodeValue),o.removeAttributeNode(p);var y=this.getAttributeNodeNS(o,t.ns.RDF,"type");t.ns.RDF+"Description"!==n(o)&&(y={nodeValue:n(o)}),null!=y&&(this.store.add(e.node,this.store.sym(t.ns.RDF+"type"),this.store.sym(Et.join(y.nodeValue,e.base)),this.why),y.nodeName&&o.removeAttributeNode(y));for(var v=a.length-1;v>=0;v--)this.store.add(e.node,this.store.sym(n(a[v])),this.store.literal(a[v].nodeValue,e.lang),this.why)}for(o=e.element;e.parent;){for(var m=e;null==o;)o=(e=e.parent).element;var b=o.childNodes&&o.childNodes[e.lastChild];if(b&&i){if((b.nodeType===t.nodeType.ELEMENT||b.nodeType===t.nodeType.TEXT||b.nodeType===t.nodeType.CDATA_SECTION)&&(b.nodeType!==t.nodeType.TEXT&&b.nodeType!==t.nodeType.CDATA_SECTION||1===o.childNodes.length)){e.lastChild++,e=this.buildFrame(m,o.childNodes[e.lastChild-1]);break}e.lastChild++}else{if(e.terminateFrame(),!(e=e.parent))break;o=e.element,i=!0}}}},this.cleanParser=function(){this.bnodes={},this.why=null},this.buildFrame=function(e,r){var n=this.frameFactory(this,e,r);if(e&&(n.base=e.base,n.lang=e.lang),!r||r.nodeType===t.nodeType.TEXT||r.nodeType===t.nodeType.CDATA_SECTION)return n;var i=r.attributes,o=r.getAttributeNode("xml:base");null!=o&&(n.base=o.nodeValue,r.removeAttribute("xml:base"));var a=r.getAttributeNode("xml:lang");null!=a&&(n.lang=a.nodeValue,r.removeAttribute("xml:lang"));for(var s=i.length-1;s>=0;s--)if("xml"===i[s].nodeName.substr(0,3)){if("xmlns:"===i[s].name.slice(0,6)){var u=i[s].nodeValue;this.base&&(u=Et.join(u,this.base)),this.store.setPrefixForURI(i[s].name.slice(6),u)}r.removeAttributeNode(i[s])}return n}}function Gt(e,t,r){var n,i,o,a=["INSERT","DELETE","WHERE"],s=bt("http://www.w3.org/ns/pim/patch#"),u=zt(t,t,r,r,null,null,"",null),c={},l=function(e,t,r,n,i){return"Line "+(t+1)+" of <"+e+">: Bad syntax:\n   "+i+'\n   at: "'+r.slice(n,n+30)+'"'};n=0;var h=t.sym(r+"#query");for(c.query=h;;){if((i=u.skipSpace(e,n))<0)return c;if(";"===e[i]){if((n=u.skipSpace(e,i+1))<0)return c;i=n}var f=!1;for(o=0;o<a.length;o++){var d=a[o];if(e.slice(i,i+d.length)===d){if((n=u.skipSpace(e,i+d.length))<0)throw l(u._thisDoc,u.lines,e,i+d.length,"found EOF, needed {...} after "+d);if(("INSERT"===d||"DELETE"===d)&&"DATA"===e.slice(n,n+4)){if((i=u.skipSpace(e,n+4))<0)throw l(u._thisDoc,u.lines,e,n+4,"needed {...} after INSERT DATA "+d);n=i}var p=[];if((i=u.node(e,n,p))<0)throw l(u._thisDoc,u.lines,e,n,"bad syntax or EOF in {...} after "+d);c[d.toLowerCase()]=p[0],t.add(h,s(d.toLowerCase()),p[0]),f=!0,n=i}}if(!f&&"@prefix"===e.slice(i,i+7)){if((n=u.directive(e,i))<0)throw l(u._thisDoc,u.lines,e,n,"bad syntax or EOF after @prefix ");n=u.checkDot(e,n),f=!0}if(!f)throw l(u._thisDoc,u.lines,e,i,"Unknown syntax at start of statememt: '"+e.slice(i).slice(0,20)+"'")}}function Jt(e,t,r,n,i){n=(n=n||"text/turtle").split(";")[0];var o=t.sym(r);try{if("text/n3"===n||"text/turtle"===n)zt(t,t,r,r,null,null,"",null).loadBuf(e),c();else if("application/rdf+xml"===n){new Wt(t).parse(Nt.parseXML(e),r,t.sym(r)),c()}else if("application/xhtml+xml"===n)Xt(Nt.parseXML(e,{contentType:"application/xhtml+xml"}),t,r),c();else if("text/html"===n)Xt(Nt.parseXML(e,{contentType:"text/html"}),t,r),c();else if("application/sparql-update"===n)Gt(e,t,r),c();else{if("application/ld+json"!==n&&"application/nquads"!==n&&"application/n-quads"!==n)throw new Error("Don't know how to parse "+n+" yet");var a=ht.a.Parser(),s=[];if("application/ld+json"===n){var u;try{u=JSON.parse(e)}catch(e){return i(e,null)}ct.a.toRDF(u,{format:"application/nquads",base:r},l)}else l(null,e)}}catch(e){!function(e){if("application/ld+json"!==n||"application/nquads"!==n||"application/n-quads"!==n){if(!i){var o=new Error(e+" while trying to parse <"+r+"> as "+n);throw o.cause=e,o}i(e,t)}}(e)}function c(){i&&i(null,t)}function l(e,r){e&&i(e,t);try{a.parse(r,h)}catch(e){i(e,t)}}function h(e,r,n){if(e&&i(e,t),r)s.push(r);else{for(var o=0;o<s.length;o++)f(t,s[o]);i(null,t)}}function f(e,t){var r=d(t.subject),n=d(t.predicate),i=d(t.object),a=o;t.graph&&(a=d(t.graph)),e.add(r,n,i,a)}function d(e){var t;if(ht.a.Util.isLiteral(e)){t=ht.a.Util.getLiteralValue(e);var r=ht.a.Util.getLiteralLanguage(e),n=new yt.a(ht.a.Util.getLiteralType(e));return new mt(t,r,n)}return ht.a.Util.isIRI(e)?new yt.a(e):ht.a.Util.isBlank(e)?(t=e.substring(2,e.length),new y(t)):null}Jt.handled={"text/n3":!0,"text/turtle":!0,"application/rdf+xml":!0,"application/xhtml+xml":!0,"text/html":!0,"application/sparql-update":!0,"application/ld+json":!0,"application/nquads":!0,"application/n-quads":!0}}var Qt=r(64),Yt=r(65),$t="undefined"==typeof window?Qt.fetch:Yt.fetch,Zt={"text/n3":!0,"text/turtle":!0,"application/rdf+xml":!0,"application/xhtml+xml":!0,"text/html":!0,"application/ld+json":!0},Kt={rdf:"application/rdf+xml",owl:"application/rdf+xml",n3:"text/n3",ttl:"text/turtle",nt:"text/n3",acl:"text/n3",html:"text/html",xml:"text/xml"},er={link:bt("http://www.w3.org/2007/ont/link#"),http:bt("http://www.w3.org/2007/ont/http#"),httph:bt("http://www.w3.org/2007/ont/httph#"),rdf:bt("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),rdfs:bt("http://www.w3.org/2000/01/rdf-schema#"),dc:bt("http://purl.org/dc/elements/1.1/"),ldp:bt("http://www.w3.org/ns/ldp#")},tr=function e(t,r){o()(this,e),this.response=t,this.dom=r},rr=function(e){function t(){return o()(this,t),c()(this,h()(t).apply(this,arguments))}return d()(t,e),s()(t,[{key:"parse",value:function(e,t,r,n){var i=e.store;if(this.dom||(this.dom=Nt.parseXML(t)),"parsererror"===this.dom.documentElement.nodeName)return e.failFetch(r,"Badly formed XML in "+r.resource.uri,"parse_error");var o=new Wt(i);try{o.parse(this.dom,r.original.uri,r.original,n)}catch(t){return e.failFetch(r,"Syntax error parsing RDF/XML! "+t,"parse_error")}return r.noMeta||i.add(r.original,er.rdf("type"),er.link("RDFDocument"),e.appNode),e.doneFetch(r,this.response)}}],[{key:"toString",value:function(){return"RDFXMLHandler"}},{key:"register",value:function(e){e.mediatypes["application/rdf+xml"]={q:.9}}}]),t}(tr);rr.pattern=new RegExp("application/rdf\\+xml");var nr=function(e){function t(){return o()(this,t),c()(this,h()(t).apply(this,arguments))}return d()(t,e),s()(t,[{key:"parse",value:function(e,t,r,n){var i,o;this.dom||(this.dom=Nt.parseXML(t));var a=e.store,s=this.dom.getElementsByTagName("title");s.length>0&&a.add(r.resource,er.dc("title"),a.literal(s[0].textContent),r.resource);for(var u=this.dom.getElementsByTagName("link"),c=u.length-1;c>=0;c--)o=!1,(i=u[c].getAttribute("rel"))||(i=u[c].getAttribute("rev"),o=!0),i&&e.linkData(r.original,i,u[c].getAttribute("href"),r.resource,o);for(var l=this.dom.getElementsByTagName("script"),h=0;h<l.length;h++){var f=l[h].getAttribute("type");Zt[f]&&(Jt(l[h].textContent,a,r.original.uri,f),Jt(l[h].textContent,a,r.original.uri,f))}if(r.noMeta||a.add(r.resource,er.rdf("type"),er.link("WebPage"),e.appNode),!r.noRDFa&&Xt)try{Xt(this.dom,a,r.original.uri)}catch(t){var d="Error trying to parse "+r.resource+" as RDFa:\n"+t+":\n"+t.stack;return e.failFetch(r,d,"parse_error")}return e.doneFetch(r,this.response)}}],[{key:"toString",value:function(){return"XHTMLHandler"}},{key:"register",value:function(e){e.mediatypes["application/xhtml+xml"]={}}}]),t}(tr);nr.pattern=new RegExp("application/xhtml");var ir=function(e){function t(){return o()(this,t),c()(this,h()(t).apply(this,arguments))}return d()(t,e),s()(t,[{key:"parse",value:function(e,t,r,n){for(var i=Nt.parseXML(t),o=0;o<i.childNodes.length;o++)if(1===i.childNodes[o].nodeType){var a=i.childNodes[o].namespaceURI;if(a&&a===a.rdf)return e.addStatus(r.req,"Has XML root element in the RDF namespace, so assume RDF/XML."),new rr(this.response,i).parse(e,t,r,n);break}if(i.doctype&&("html"===i.doctype.name&&i.doctype.publicId.match(/^-\/\/W3C\/\/DTD XHTML/)&&i.doctype.systemId.match(/http:\/\/www.w3.org\/TR\/xhtml/)))return e.addStatus(r.req,"Has XHTML DOCTYPE. Switching to XHTML Handler.\n"),new nr(this.response,i).parse(e,t,r,n);var s=i.getElementsByTagName("html")[0];if(s){var u=s.getAttribute("xmlns");if(u&&u.match(/^http:\/\/www.w3.org\/1999\/xhtml/))return e.addStatus(r.req,"Has a default namespace for XHTML. Switching to XHTMLHandler.\n"),new nr(this.response,i).parse(e,t,r,n)}return e.failFetch(r,"Unsupported dialect of XML: not RDF or XHTML namespace, etc.\n"+t.slice(0,80),901)}}],[{key:"toString",value:function(){return"XMLHandler"}},{key:"register",value:function(e){e.mediatypes["text/xml"]={q:.5},e.mediatypes["application/xml"]={q:.5}}}]),t}(tr);ir.pattern=new RegExp("(text|application)/(.*)xml");var or=function(e){function t(){return o()(this,t),c()(this,h()(t).apply(this,arguments))}return d()(t,e),s()(t,[{key:"parse",value:function(e,t,r,n){var i=e.store;if(t.match(/\s*<\?xml\s+version\s*=[^<>]+\?>/))return e.addStatus(r.req,"Has an XML declaration. We'll assume it's XHTML as the content-type was text/html.\n"),new nr(this.response).parse(e,t,r,n);if(t.match(/.*<!DOCTYPE\s+html[^<]+-\/\/W3C\/\/DTD XHTML[^<]+http:\/\/www.w3.org\/TR\/xhtml[^<]+>/))return e.addStatus(r.req,"Has XHTML DOCTYPE. Switching to XHTMLHandler.\n"),new nr(this.response).parse(e,t,r,n);if(t.match(/[^(<html)]*<html\s+[^<]*xmlns=['"]http:\/\/www.w3.org\/1999\/xhtml["'][^<]*>/))return e.addStatus(r.req,"Has default namespace for XHTML, so switching to XHTMLHandler.\n"),new nr(this.response).parse(e,t,r,n);var o=new RegExp("<title>([\\s\\S]+?)</title>","im").exec(t);return o&&i.add(r.resource,er.dc("title"),i.literal(o[1]),r.resource),i.add(r.resource,er.rdf("type"),er.link("WebPage"),e.appNode),e.addStatus(r.req,"non-XML HTML document, not parsed for data."),e.doneFetch(r,this.response)}}],[{key:"toString",value:function(){return"HTMLHandler"}},{key:"register",value:function(e){e.mediatypes["text/html"]={q:.9}}}]),t}(tr);or.pattern=new RegExp("text/html");var ar=function(e){function t(){return o()(this,t),c()(this,h()(t).apply(this,arguments))}return d()(t,e),s()(t,[{key:"parse",value:function(e,t,r,n){return t.match(/\s*<\?xml\s+version\s*=[^<>]+\?>/)?(e.addStatus(r.req,"Warning: "+r.resource+" has an XML declaration. We'll assume it's XML but its content-type wasn't XML.\n"),new ir(this.response).parse(e,t,r,n)):t.slice(0,500).match(/xmlns:/)?(e.addStatus(r.req,"May have an XML namespace. We'll assume it's XML but its content-type wasn't XML.\n"),new ir(this.response).parse(e,t,r,n)):(e.addStatus(r.req,"Plain text document, no known RDF semantics."),e.doneFetch(r,this.response))}}],[{key:"toString",value:function(){return"TextHandler"}},{key:"register",value:function(e){e.mediatypes["text/plain"]={q:.5}}}]),t}(tr);ar.pattern=new RegExp("text/plain");var sr=function(e){function t(){return o()(this,t),c()(this,h()(t).apply(this,arguments))}return d()(t,e),s()(t,[{key:"parse",value:function(e,t,r,n){var i=e.store,o=zt(i,i,r.original.uri,r.original.uri,null,null,"",null);try{o.loadBuf(t)}catch(t){var a="Error trying to parse "+r.resource+" as Notation3:\n"+t;return e.failFetch(r,a,"parse_error",n)}return e.addStatus(r.req,"N3 parsed: "+o.statementCount+" triples in "+o.lines+" lines."),e.store.add(r.original,er.rdf("type"),er.link("RDFDocument"),e.appNode),e.doneFetch(r,this.response)}}],[{key:"toString",value:function(){return"N3Handler"}},{key:"register",value:function(e){e.mediatypes["text/n3"]={q:"1.0"},e.mediatypes["text/turtle"]={q:1}}}]),t}(tr);sr.pattern=new RegExp("(application|text)/(x-)?(rdf\\+)?(n3|turtle)");var ur={RDFXMLHandler:rr,XHTMLHandler:nr,XMLHandler:ir,HTMLHandler:or,TextHandler:ar,N3Handler:sr},cr=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o()(this,e),this.store=t||new qt,this.timeout=n.timeout||3e4,this._fetch=n.fetch||$t,!this._fetch)throw new Error("No _fetch function availble for Fetcher");this.appNode=this.store.bnode(),this.store.fetcher=this,this.requested={},this.timeouts={},this.redirectedTo={},this.fetchQueue={},this.fetchCallbacks={},this.nonexistent={},this.lookedUp={},this.handlers=[],this.mediatypes={"image/*":{q:.9},"*/*":{q:.1}},Nt.callbackify(this,["request","fail","refresh","retract","done"]),Object.keys(ur).map(function(e){return r.addHandler(ur[e])})}var t;return s()(e,[{key:"load",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r=Object.assign({},r),e instanceof Array)return Promise.all(e.map(function(e){return t.load(e,Object.assign({},r))}));var n=e.uri||e;return n=n.split("#")[0],r=this.initFetchOptions(n,r),this.pendingFetchPromise(n,r.baseURI,r)}},{key:"pendingFetchPromise",value:function(e,t,r){var n,i=this;return!r.force&&this.fetchQueue[t]?n=this.fetchQueue[t]:(n=Promise.race([this.setRequestTimeout(e,r),this.fetchUri(e,r)]),this.fetchQueue[t]=n,this.cleanupFetchRequest(t,r,this.timeout)),n.then(function(t){return e in i.timeouts&&(i.timeouts[e].forEach(clearTimeout),delete i.timeouts[e]),t})}},{key:"cleanupFetchRequest",value:function(e,t,r){var n=this;this.timeouts[e]=(this.timeouts[e]||[]).concat(setTimeout(function(){n.isPending(e)||delete n.fetchQueue[e]},r))}},{key:"initFetchOptions",value:function(t,r){var n=this.store;!r.method||"GET"===r.method.toUpperCase()||(r.force=!0),r.resource=n.sym(t),r.baseURI=r.baseURI||t,r.original=n.sym(r.baseURI),r.req=n.bnode(),r.headers=r.headers||{},r.contentType&&(r.headers["content-type"]=r.contentType),r.force&&(r.cache="no-cache");var i=this.acceptString();r.headers.accept=i;var o=e.offlineOverride(t);r.requestedURI=o,e.setCredentials(o,r);var a=e.proxyIfNecessary(o);return o!==a&&(r.proxyUsed=!0),r.actualProxyURI=a,r}},{key:"fetchUri",value:function(t,r){var n=this;if(!t)return Promise.reject(new Error("Cannot fetch an empty uri"));if(e.unsupportedProtocol(t))return this.failFetch(r,"fetcher: Unsupported protocol","unsupported_protocol");var i=this.getState(t);if(r.force)delete this.nonexistent[t];else{if("fetched"===i)return Promise.resolve(this.doneFetch(r,{status:200,ok:!0,statusText:"Already loaded into quadstore."}));if("failed"===i&&404===this.requested[t]){var o="Previously failed: "+this.requested[t],a={url:t,status:this.requested[t],statusText:o,responseText:o,headers:{},ok:!1,body:null,bodyUsed:!1,size:0,timeout:0};return this.failFetch(r,o,this.requested[t],a)}}this.fireCallbacks("request",[t]),this.requested[t]=!0,r.noMeta||this.saveRequestMetadata(t,r);var s=r.actualProxyURI;return this._fetch(s,r).then(function(e){return n.handleResponse(e,t,r)},function(e){var i={url:s,status:999,statusText:(e.name||"network failure")+": "+(e.errno||e.code||e.type),responseText:e.message,headers:{},ok:!1,body:null,bodyUsed:!1,size:0,timeout:0};return console.log("Fetcher: <"+s+"> Non-HTTP fetch exception: "+e),n.handleError(i,t,r)})}},{key:"nowOrWhenFetched",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=e.uri||e,"function"==typeof t?r=t:void 0===t||(t instanceof yt.a?n.referringTerm=t:n=t),this.load(e,n).then(function(t){if(r)if(t)if(t.ok)r(!0,"OK",t);else{var n="HTTP error: Status "+t.status+" ("+t.statusText+")";t.responseText&&(n+=" "+t.responseText),console.log(n+" fetching "+e),r(!1,n,t)}else{var i="@@ nowOrWhenFetched:  no response object!";console.log(i),r(!1,i)}},function(t){var n=t.message||t.statusText;n="Failed to load  <"+e+"> "+n,console.log(n),t.response&&t.response.status&&(n+=" status: "+t.response.status),r(!1,n,t.response)})}},{key:"addStatus",value:function(e,t){var r=new Date;t="["+r.getHours()+":"+r.getMinutes()+":"+r.getSeconds()+"."+r.getMilliseconds()+"] "+t;var n=this.store,i=n.the(e,er.link("status"));i&&i.append?i.append(n.literal(t)):jt.a.warn("web.js: No list to add to: "+i+","+t)}},{key:"failFetch",value:function(e,t,r,n){this.addStatus(e.req,t),e.noMeta||this.store.add(e.original,er.link("error"),t);var i=(e.method||"GET").toUpperCase();("GET"===i||"HEAD"===i)&&(e.resource.sameTerm(e.original),this.requested[Et.docpart(e.original.uri)]=r,this.fireCallbacks("fail",[e.original.uri,t]));var o=new Error("Fetcher: "+t);return o.status=r,o.statusText=t,o.response=n,Promise.reject(o)}},{key:"linkData",value:function(e,t,r,n,i){if(r){var o,a=this.store,s=a.sym(Et.join(r,e.uri));if("alternate"===t||"seeAlso"===t||"meta"===t||"describedby"===t){if(s.uri===e.uri)return;o=er.rdfs("seeAlso")}else o="type"===t?a.sym("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):a.sym(Et.join(encodeURIComponent(t),"http://www.iana.org/assignments/link-relations/"));i?a.add(s,o,e,n):a.add(e,o,s,n)}}},{key:"parseLinkHeader",value:function(e,t,r){if(e)for(var n=/[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*"))/g,i=e.match(/<[^>]*>\s*(\s*;\s*[^()<>@,;:"\/[\]?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*")))*(,|$)/g),o=0;o<i.length;o++)for(var a=i[o].split(">"),s=a[0].substring(1),u=a[1].match(n),c=0;c<u.length;c++){var l=u[c].split("=")[1].replace(/["']/g,"");this.linkData(t,l,s,r)}}},{key:"doneFetch",value:function(e,t){return this.addStatus(e.req,"Done."),this.requested[e.original.uri]="done",this.fireCallbacks("done",[e.original.uri]),t.req=e.req,t}},{key:"nowKnownAs",value:function(e,t){this.lookedUp[e.uri]?this.lookedUp[t.uri]||this.lookUpThing(t,e):this.lookedUp[t.uri]&&(this.lookedUp[e.uri]||this.lookUpThing(e,t))}},{key:"putBack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=e.uri||e;var r=new yt.a(e).doc();return t.contentType=t.contentType||"text/turtle",t.data=Ct(r,this.store,r.uri,t.contentType),this.webOperation("PUT",e,t)}},{key:"webCopy",value:function(e,t,r){var n=this;return this.webOperation("GET",e).then(function(e){return n.webOperation("PUT",t,{data:e.responseText,contentType:r})})}},{key:"delete",value:function(e,t){var r=this;return this.webOperation("DELETE",e,t).then(function(t){return r.requested[e]=404,r.nonexistent[e]=!0,r.unload(r.store.sym(e)),t})}},{key:"createIfNotExists",value:(t=It()(kt.a.mark(function e(t){var r,n,i,o,a=arguments;return kt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:"text/turtle",n=a.length>2&&void 0!==a[2]?a[2]:"",i=this,e.prev=3,e.next=6,i.load(t);case 6:o=e.sent,e.next=29;break;case 9:if(e.prev=9,e.t0=e.catch(3),404!==e.t0.response.status){e.next=27;break}return console.log("createIfNotExists: doc does NOT exist, will create... "+t),e.prev=13,e.next=16,i.webOperation("PUT",t.uri,{data:n,contentType:r});case 16:o=e.sent,e.next=23;break;case 19:throw e.prev=19,e.t1=e.catch(13),console.log("createIfNotExists doc FAILED: "+t+": "+e.t1),e.t1;case 23:return delete i.requested[t.uri],e.abrupt("return",o);case 27:throw console.log("createIfNotExists doc load error NOT 404:  "+t+": "+e.t0),e.t0;case 29:return e.abrupt("return",o);case 30:case"end":return e.stop()}},e,this,[[3,9],[13,19]])})),function(e){return t.apply(this,arguments)})},{key:"createContainer",value:function(e,t,r){var n={"content-type":"text/turtle",link:er.ldp("BasicContainer")+'; rel="type"'};t&&(n.slug=t);var i={headers:n};return r&&(i.body=r),this.webOperation("POST",e,i)}},{key:"invalidateCache",value:function(e){e=e.uri||e;this.fetchQueue&&this.fetchQueue[e]&&(console.log("Internal error - fetchQueue exists "+e),"resolved"===this.fetchQueue[e].PromiseStatus?delete this.fetchQueue[e]:(delete this.fetchQueue[e],console.log("*** Fetcher: pending fetchQueue deleted "+e)));if(this.requested[e]&&"done"!==this.requested[e]&&"failed"!==this.requested[e]&&404!==this.requested[e]){var t="Rdflib: fetcher: Destructive operation on <".concat(this.requested[e],"> file being fetched! ")+e;console.error(t)}else delete this.requested[e],delete this.nonexistent[e]}},{key:"webOperation",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r=r.uri||r,n.method=t,n.body=n.data||n.body,n.force=!0;var i=this;if(n.body&&!n.contentType)throw new Error("Web operation sending data must have a defined contentType.");return n.contentType&&(n.headers=n.headers||{},n.headers["content-type"]=n.contentType),e.setCredentials(r,n),new Promise(function(e,o){i._fetch(r,n).then(function(n){if(n.ok)"PUT"!==t&&"PATCH"!==t&&"POST"!==t&&"DELETE"!==t||i.invalidateCache(r),n.body?n.text().then(function(t){n.responseText=t,e(n)}):e(n);else{var a="Web error: "+n.status;n.statusText&&(a+=" ("+n.statusText+")"),a+=" on "+t+" of <"+r+">",n.responseText&&(a+=": "+n.responseText);var s=new Error(a);s.response=n,o(s)}},function(e){o(new Error("Fetch error for "+t+" of <"+r+">:"+e))})})}},{key:"lookUpThing",value:function(e,t){var r=this,n=this.store.uris(e);return(n=n.map(function(e){return Et.docpart(e)})).forEach(function(e){r.lookedUp[e]=!0}),this.load(n,{referringTerm:t})}},{key:"getHeader",value:function(e,t){for(var r=this.store,n=r.each(void 0,er.link("requestedURI"),e.uri),i=0;i<n.length;i++){var o=n[i];if(void 0!==o){var a=r.any(o,er.link("response"));if(void 0!==a&&r.anyValue(a,er.http("status"))&&r.anyValue(a,er.http("status")).startsWith("2")){var s=r.each(a,er.httph(t.toLowerCase()));return s.length?s.map(function(e){return e.value}):[]}}}}},{key:"saveRequestMetadata",value:function(e,t){var r=t.req,n=this.store,i=t.referringTerm;this.addStatus(t.req,"Accept: "+t.headers.accept),i&&i.uri&&n.add(e,er.link("requestedBy"),i.uri,this.appNode),t.original&&t.original.uri!==e&&n.add(r,er.link("orginalURI"),n.literal(t.original.uri),this.appNode);var o=new Date,a="["+o.getHours()+":"+o.getMinutes()+":"+o.getSeconds()+"] ";n.add(r,er.rdfs("label"),n.literal(a+" Request for "+e),this.appNode),n.add(r,er.link("requestedURI"),n.literal(e),this.appNode),n.add(r,er.link("status"),n.collection(),this.appNode)}},{key:"saveResponseMetadata",value:function(e,t){var r=this.store,n=r.bnode();return r.add(t.req,er.link("response"),n,n),r.add(n,er.http("status"),r.literal(e.status),n),r.add(n,er.http("statusText"),r.literal(e.statusText),n),t.resource.uri.startsWith("http")?(e.headers.forEach(function(e,i){r.add(n,er.httph(i),e,n),"content-type"===i&&r.add(t.resource,er.rdf("type"),Nt.mediaTypeClass(e),n)}),n):n}},{key:"objectRefresh",value:function(e){var t=this.store.uris(e);if(void 0!==t)for(var r=0;r<t.length;r++)this.refresh(this.store.sym(Et.docpart(t[r])))}},{key:"refresh",value:function(e,t){this.fireCallbacks("refresh",arguments),this.nowOrWhenFetched(e,{force:!0,clearPreviousData:!0},t)}},{key:"refreshIfExpired",value:function(e,t){var r=this.getHeader(e,"Expires");!r||new Date(r).getTime()<=(new Date).getTime()?this.refresh(e,t):t(!0,"Not expired",{})}},{key:"retract",value:function(e){this.store.removeMany(void 0,void 0,void 0,e),e.uri&&delete this.requested[Et.docpart(e.uri)],this.fireCallbacks("retract",arguments)}},{key:"getState",value:function(e){return void 0===this.requested[e]?"unrequested":!0===this.requested[e]?"requested":"done"===this.requested[e]?"fetched":"redirected"===this.requested[e]?this.getState(this.redirectedTo[e]):"failed"}},{key:"isPending",value:function(e){return!0===this.requested[e]}},{key:"unload",value:function(e){this.store.removeDocument(e),delete this.requested[e.uri]}},{key:"addHandler",value:function(e){this.handlers.push(e),e.register(this)}},{key:"retryNoCredentials",value:function(e,t){console.log("Fetcher: CORS: RETRYING with NO CREDENTIALS for "+t.resource),t.retriedWithNoCredentials=!0,delete this.requested[e],delete this.fetchQueue[e];var r=Object.assign({},t,{credentials:"omit"});return this.addStatus(t.req,"Abort: Will retry with credentials SUPPRESSED to see if that helps"),this.load(e,r)}},{key:"isCrossSite",value:function(e){if("undefined"==typeof document||!document.location)return!1;var t=Et.hostpart,r=""+document.location;return t(r)&&t(e)&&t(r)!==t(e)}},{key:"handleError",value:function(t,r,n){if(this.isCrossSite(r)){if(n.credentials&&"include"===n.credentials&&!n.retriedWithNoCredentials)return this.retryNoCredentials(r,n);var i=e.crossSiteProxy(r);if(i&&!n.proxyUsed)return console.log("web: Direct failed so trying proxy "+i),this.redirectToProxy(i,n)}var o;return t.message?o="Fetch error: "+t.message:(o=t.statusText,t.responseText&&(o+=" ".concat(t.responseText))),this.failFetch(n,o,t.status||998,t)}},{key:"addType",value:function(e,t,r,n){var i=t;if(n){var o=r.any(i,er.link("requestedURI"));o&&o!==n&&r.add(r.sym(n),er.rdf("type"),e,this.appNode)}for(;;){var a=r.any(i,er.link("requestedURI"));if(a&&a.value&&r.add(r.sym(a.value),er.rdf("type"),e,this.appNode),!(i=r.any(void 0,r.sym("http://www.w3.org/2007/ont/link#redirectedRequest"),i)))break;var s=r.any(i,r.sym("http://www.w3.org/2007/ont/link#response"));if(!s)break;var u=r.any(s,r.sym("http://www.w3.org/2007/ont/http#status"));if(!u)break;if("301"!==u&&"302"!==u)break}}},{key:"handleResponse",value:function(e,t,r){var n=this,i=this.store,o=e.headers,a=r.req,s=this.saveResponseMetadata(e,r),u=this.normalizedContentType(r,o)||"",c=o.get("content-location");if(0===e.status)return console.log("Masked error - status 0 for "+t),this.handleError(e,t,r);if(e.status>=400)return 404===e.status&&(this.nonexistent[r.original.uri]=!0,this.nonexistent[t]=!0),this.saveErrorResponse(e,s).then(function(){var t=r.resource+" "+e.statusText;return n.failFetch(r,t,e.status,e)});var l=null,h=null;if(c&&(h=Et.join(c,t))!==t&&(l=h),200===e.status){this.addType(er.link("Document"),a,i,t),l&&this.addType(er.link("Document"),a,i,l),r.clearPreviousData&&i.removeDocument(r.resource);var f=u.includes("image/")||u.includes("application/pdf");u&&f&&(this.addType(i.sym("http://purl.org/dc/terms/Image"),a,i,t),l&&this.addType(i.sym("http://purl.org/dc/terms/Image"),a,i,l))}if(c){if(!r.force&&l&&"done"===this.requested[h])return this.doneFetch(r,e);this.requested[h]=!0}this.parseLinkHeader(o.get("link"),r.original,a);var d=this.handlerForContentType(u,e);return d?e.text().then(function(t){return e.responseText=t,d.parse(n,t,r,e)}):(this.addStatus(a,"Fetch over. No data handled."),this.doneFetch(r,e))}},{key:"saveErrorResponse",value:function(e,t){var r=this.store;return e.text().then(function(e){e.length>10&&r.add(t,er.http("content"),r.literal(e),t)})}},{key:"handlerForContentType",value:function(e,t){if(!e)return null;var r=this.handlers.find(function(t){return e.match(t.pattern)});return r?new r(t):null}},{key:"guessContentType",value:function(e){return Kt[e.split(".").pop()]}},{key:"normalizedContentType",value:function(e,t){if(e.forceContentType)return e.forceContentType;var r=t.get("content-type");if(!r||r.includes("application/octet-stream")){var n=this.guessContentType(e.resource.uri);if(n)return n}var i=Et.protocol(e.resource.uri);return!r&&["file","chrome"].includes(i)?"text/xml":r}},{key:"redirectToProxy",value:function(e,t){var r=this;this.addStatus(t.req,"BLOCKED -> Cross-site Proxy to <"+e+">"),t.proxyUsed=!0;var n=this.store,i=t.req;t.noMeta||(n.add(i,er.link("redirectedTo"),n.sym(e),i),this.addStatus(i,"redirected to new request")),this.requested[t.resource.uri]="redirected",this.redirectedTo[t.resource.uri]=e;var o=Object.assign({},t);return o.baseURI=t.resource.uri,this.fetchUri(e,o).then(function(e){return o.noMeta||n.add(i,er.link("redirectedRequest"),o.req,r.appNode),e})}},{key:"setRequestTimeout",value:function(e,t){var r=this;return new Promise(function(n){r.timeouts[e]=(r.timeouts[e]||[]).concat(setTimeout(function(){!r.isPending(e)||t.retriedWithNoCredentials||t.proxyUsed||n(r.failFetch(t,"Request to ".concat(e," timed out"),"timeout"))},r.timeout))})}},{key:"addFetchCallback",value:function(e,t){this.fetchCallbacks[e]?this.fetchCallbacks[e].push(t):this.fetchCallbacks[e]=[t]}},{key:"acceptString",value:function(){var e="";for(var t in this.mediatypes)for(var r in""!==e&&(e+=", "),e+=t,this.mediatypes[t])e+=";"+r+"="+this.mediatypes[t][r];return e}}],[{key:"crossSiteProxy",value:function(t){return e.crossSiteProxyTemplate?e.crossSiteProxyTemplate.replace("{uri}",encodeURIComponent(t)):void 0}},{key:"offlineOverride",value:function(e){var t,r=e;return"undefined"!=typeof window&&window.panes&&(t=window.panes.UI)&&t.preferences&&t.preferences.get("offlineModeUsingLocalhost")&&"http://"===r.slice(0,7)&&"localhost/"!==r.slice(7,17)&&(r="http://localhost/"+r.slice(7),jt.a.warn("Localhost kludge for offline use: actually getting <"+r+">")),r}},{key:"proxyIfNecessary",value:function(t){var r;if("undefined"!=typeof window&&window.panes&&(r=window.panes.UI)&&r.isExtension)return t;if("undefined"!=typeof $SolidTestEnvironment&&$SolidTestEnvironment.localSiteMap){var n=function e(t,r){var n=r[t.shift()];return n?"string"==typeof n?n+t.join("/"):t?e(t,n):null:null}(t.split("/").slice(2),$SolidTestEnvironment.localSiteMap);if(n)return n}return e.crossSiteProxyTemplate&&"undefined"!=typeof document&&document.location&&"https:"===(""+document.location).slice(0,6)&&"http:"===t.slice(0,5)?e.crossSiteProxyTemplate.replace("{uri}",encodeURIComponent(t)):t}},{key:"unsupportedProtocol",value:function(e){var t=Et.protocol(e);return"tel"===t||"mailto"===t||"urn"===t}},{key:"setCredentials",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log(" setCredentials: "+e+" starts as: "+t.credentials),void 0===t.credentials&&(void 0!==t.withCredentials?t.credentials=t.withCredentials?"include":"omit":t.credentials="include"),console.log("   setCredentials: "+e+" ends as: "+t.credentials)}}]),e}();cr.HANDLERS=ur,cr.CONTENT_TYPE_BY_EXT=Kt;var lr={blankNode:function(e){return new y(e)},defaultGraph:function(){return new _t},fetcher:function(e,t){return new cr(e,t)},graph:function(){return new qt},lit:function(e,t,r){return new mt(""+e,t,r)},literal:function(e,t){return"string"==typeof t?-1===t.indexOf(":")?new mt(e,t):new mt(e,null,hr(t)):new mt(e,null,t)},namedNode:hr,quad:fr,st:function(e,t,r,n){return new Rt(e,t,r,n)},triple:function(e,t,r){return fr(e,t,r)},variable:function(e){return new At(e)}};function hr(e){return new yt.a(e)}function fr(e,t,r,n){return n=n||new _t,new Rt(e,t,r,n)}var dr=function(e){function t(){var e;return o()(this,t),(e=c()(this,h()(t).call(this))).termType=t.termType,e}return d()(t,e),s()(t,[{key:"toString",value:function(){return"()"}}]),t}(wt);dr.termType="empty";var pr={parseJSON:function(e,t,r){var n,i,o,a={},s=r.sym(t);for(var u in e){0===u.indexOf("_:")?a[u]?n=a[u]:(n=r.bnode(u),a[u]=n):n=r.sym(u);var c=e[u];for(var l in c){var h=c[l];for(var f in i=r.sym(l),h){var d=h[f];if("uri"===d.type)o=r.sym(d.value),r.add(n,i,o,s);else if("BlankNode"===d.type)a[d.value]?o=a[d.value]:(o=r.bnode(d.value),a[d.value]=o),r.add(n,i,o,s);else{if("Literal"!==d.type)throw new Error("error: unexpected termtype: "+f.type);o=d.datatype?r.literal(d.value,void 0,r.sym(d.datatype)):d.lang?r.literal(d.value,d.lang):r.literal(d.value),r.add(n,i,o,s)}}}}}};function gr(e){var t=0;function r(e){var t="",r=e.statements;for(var n in r)jt.a.debug("Found statement: "+r),t+=o()+r[n]+"\n";return t}function n(e){var t="";for(var r in e.constraints){var n=e.constraints[r];t+=o()+"FILTER ( "+n.describe(r)+" ) \n"}return t}function i(e){var i=o()+"WHERE \n{ \n";return t++,i+=r(e),i+=n(e),i+=function e(i){for(var a="",s=0;s<i.optional.length;s++)jt.a.debug("Found optional query"),a+=o()+"OPTIONAL { \n",t++,a+=r(i.optional[s]),a+=n(i.optional[s]),a+=e(i.optional[s]),t--,a+=o()+"}\n";return a}(e),t--,i+="}"}function o(){for(var e="",r=0;r<t;r++)e+="    ";return e}return function(e){return function(e){for(var t=o()+"SELECT ",r=0;r<e.vars.length;r++)t+=e.vars[r]+" ";return t+="\n"}(e)+i(e.pat)}(e)}function yr(e,t,r){var n=[];function i(e){if(n[e])return n[e];var t=r.variable(e);return n[e]=t,t}function o(e){return"string"==typeof e&&e.match(/^[\?\$]/)}function a(e){return"string"==typeof e&&e.match(/^<[^>]*>$/)}function s(e){return"string"==typeof e&&(e.match(/^_:/)||e.match(/^$/))}function u(e){return"string"==typeof e&&e.match(/^:|^[^_][^:]*:/)}function c(e){return e.split(":")[0]}function l(e){return e.split(":")[1]}function h(e){return a(e)?e.slice(1,e.length-1):e}function f(e){e=e.replace(/\(/g," ( ").replace(/\)/g," ) ").replace(/</g," <").replace(/>/g,"> ").replace(/{/g," { ").replace(/}/g," } ").replace(/[\t\n\r]/g," ").replace(/; /g," ; ").replace(/\. /g," . ").replace(/, /g," , "),jt.a.info("New str into spaceDelimit: \n"+e);var t,r=[],n=e.split(" ");for(var i in n)"string"==typeof(t=n[i])&&t.match(/[^ \n\t]/)&&(r=r.concat(n[i]));return r}function d(e,t){for(var r=0;r<t.length;r++)if("string"==typeof t[r]&&t[r].toLowerCase()===e.toLowerCase())return r;return null}function p(e,t){for(var r=[],n=0;n<t.length;n++)"string"==typeof t[n]&&t[n].toLowerCase()===e.toLowerCase()&&r.push(n);return r}function g(e,t,r){jt.a.info("Looking for a close bracket of type "+r+" in "+e);for(var n=0,i=0;i<e.length;i++)if(e[i]===t&&n++,e[i]===r&&n--,n<0)return i;return jt.a.error("Statement had no close parenthesis in SPARQL query"),0}function y(e){return this.describe=function(t){return t+" = "+e.toNT()},this.test=function(t){return e.sameTerm(t)},this}function v(e){this.describe=function(t){return"REGEXP( '"+e+"' , "+t+" )"},this.test=function(t){var r=new RegExp(e);return!!t.value&&r.test(t.value)}}function m(e,t){3!==e.length||"Variable"!==e[0].termType||"NamedNode"!==e[2].termType&&"Literal"!==e[2].termType?6===e.length&&"string"==typeof e[0]&&"regexp"===e[0].toLowerCase()&&"("===e[1]&&")"===e[5]&&","===e[3]&&"Variable"===e[4].termType&&"Literal"===e[2].termType&&(jt.a.debug("Constraint added: "+e),t.constraints[e[4]]=new v(e[2].value)):"="===e[1]?(jt.a.debug("Constraint added: "+e),t.constraints[e[0]]=new y(e[2])):">"===e[1]?(jt.a.debug("Constraint added: "+e),t.constraints[e[0]]=new y(e[2])):"<"===e[1]?(jt.a.debug("Constraint added: "+e),t.constraints[e[0]]=new y(e[2])):jt.a.warn("I don't know how to handle the constraint: "+e)}function b(e,t){jt.a.debug("Optional query: "+e+" not yet implemented.");var n=r.formula();w(e,n),t.optional.push(n)}function w(e,t){var n,f,y=function(e){for(var t,n=[],f=0;f<e.length;f++)"string"==typeof e[f]?(e[f]="string"==typeof(t=e[f])?t.replace(/^&lt;/,"<").replace(/&gt;$/,">"):t,o(e[f])?n[f]=i(e[f].slice(1)):s(e[f])?(jt.a.info(e[f]+" was identified as a bnode."),n[f]=r.bnode()):a(e[f])?(jt.a.info(e[f]+" was identified as a symbol."),n[f]=r.sym(h(e[f]))):u(e[f])?(jt.a.info(e[f]+" was identified as a prefixed symbol"),T[c(e[f])]?n[f]=r.sym(e[f]=T[c(e[f])]+l(e[f])):(jt.a.error("SPARQL error: "+e[f]+" with prefix "+c(e[f])+" does not have a correct prefix entry."),n[f]=e[f])):n[f]=e[f]):n[f]=e[f];return n}(e);for(jt.a.debug("WHERE: "+y);d("OPTIONAL",y);)f=d("OPTIONAL",y),jt.a.debug("OPT: "+f+" "+y[f]+" in "+y),"{"!==y[f+1]&&jt.a.warn("Bad optional opening bracket in word "+f),-1===(n=g(y.slice(f+2),"{","}"))?jt.a.error("No matching bracket in word "+f):(b(y.slice(f+2,f+2+n),t),f=d("OPTIONAL",y),n=g(y.slice(f+2),"{","}"),y.splice(f,n+3));for(jt.a.debug("WHERE after optionals: "+y);d("FILTER",y);){var v=d("FILTER",y);"("!==y[v+1]&&jt.a.warn("Bad filter opening bracket in word "+v),-1===(n=g(y.slice(v+2),"(",")"))?jt.a.error("No matching bracket in word "+v):(m(y.slice(v+2,v+2+n),t),v=d("FILTER",y),n=g(y.slice(v+2),"(",")"),y.splice(v,n+3))}jt.a.debug("WHERE after filters and optionals: "+y),function(e,t){var r=new Array(1);r[0]=-1;for(var n=r.concat(p(".",e)),i=[],o=0;o<n.length-1;o++)i[o]=e.slice(n[o]+1,n[o+1]);for(o in i){jt.a.info("s+p+o "+o+" = "+i[o]);var a=i[o][0];i[o].splice(0,1);var s=r.concat(p(";",i[o]));s.push(i[o].length);for(var u=[],c=0;c<s.length-1;c++)u[c]=i[o].slice(s[c]+1,s[c+1]);for(o in u){jt.a.info("p+o "+o+" = "+i[o]);var l=u[o][0];u[o].splice(0,1);var h=r.concat(p(",",u[o]));h.push(u[o].length);var f=[];for(c=0;c<h.length-1;c++)f[c]=u[o].slice(h[c]+1,h[c+1]);for(o in f){var d=f[o][0];jt.a.info("Subj="+a+" Pred="+l+" Obj="+d),t.add(a,l,d)}}}}(y,t)}jt.a.info("SPARQL input: \n"+e);var x=new Dt,_=function(e){var t=function e(t){var n=-1===t.indexOf("'")?null:t.indexOf("'"),i=-1===t.indexOf('"')?null:t.indexOf('"');if(!n&&!i){var o=new Array(1);return o[0]=t,o}var a,s,u=new Array(2);if(!n||i&&i<n)a='"',s=i;else{if(i&&!(n&&n<i))return jt.a.error("SQARQL QUERY OOPS!"),u;a="'",s=n}u[0]=t.slice(0,s);var c,l=t.slice(s+1).indexOf(a);return-1===l?(jt.a.error("SPARQL parsing error: no matching parentheses in literal "+t),t):(t.slice(l+s+2).match(/^\^\^/)?(c=t.slice(l+s+2).indexOf(" "),u[1]=r.literal(t.slice(s+1,s+1+l),"",r.sym(h(t.slice(s+4+l,s+2+l+c)))),u=u.concat(e(t.slice(l+s+3+c)))):t.slice(l+s+2).match(/^@/)?(c=t.slice(l+s+2).indexOf(" "),u[1]=r.literal(t.slice(s+1,s+1+l),t.slice(s+3+l,s+2+l+c),null),u=u.concat(e(t.slice(l+s+2+c)))):(u[1]=r.literal(t.slice(s+1,s+1+l),"",null),jt.a.info("Literal found: "+u[1]),u=u.concat(e(t.slice(l+s+2)))),u)}(e),n=[];for(var i in t)n="string"==typeof t[i]?n.concat(f(t[i])):n.concat(t[i]);return n=function(e){for(var t=e,r=0;r<t.length;r++)if("a"===t[r]&&(t[r]="<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>"),"is"===t[r]&&"of"===t[r+2]){t.splice(r,1),t.splice(r+1,1);var n=t[r-1];t[r-1]=t[r+1],t[r+1]=n}return t}(n),jt.a.info("SPARQL Tokens: "+n),n}(e),T=function(e){var t,r=p("PREFIX",e),n=[];for(var i in r){var o=e[r[i]+1],s=e[r[i]+2];if("string"==typeof(t=o)&&t.match(/:$/))if(a(s)){jt.a.info("Prefix found: "+o+" -> "+s);var u=c(o),l=h(s);n[u]=l}else jt.a.error("Invalid SPARQL symbol: "+s);else jt.a.error("Invalid SPARQL prefix: "+o)}return n}(_);T.rdf||(T.rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"),T.rdfs||(T.rdfs="http://www.w3.org/2000/01/rdf-schema#");var k=d("SELECT",_),S=d("WHERE",_);if(k<0||S<0||k>S)return jt.a.error("Invalid or nonexistent SELECT and WHERE tags in SPARQL query"),!1;if(function(e,t){for(var r in jt.a.info("SPARQL vars: "+e),e)if(o(e[r])){jt.a.info("Added "+e[r]+" to query variables from SPARQL");var n=i(e[r].slice(1));t.vars.push(n),n.label=e[r].slice(1)}else jt.a.warn("Incorrect SPARQL variable in SELECT: "+e[r])}(_.slice(k+1,S),x),w(_.slice(S+2,_.length-1),x.pat),t)return x;for(var I in x.pat.statements){var N=x.pat.statements[I];"NamedNode"===N.subject.termType&&r.fetcher&&r.fetcher.lookUpThing(N.subject,"sparql:"+N.subject),"NamedNode"===N.object.termType&&r.fetcher&&r.fetcher.lookUpThing(N.object,"sparql:"+N.object)}return x}var vr=function(){function e(t){if(o()(this,e),t=t||new qt,this.store=t,t.updater)throw new Error("You can't have two UpdateManagers for the same store");t.fetcher||(t.fetcher=new cr(t)),t.updater=this,this.ifps={},this.fps={},this.ns={},this.ns.link=bt("http://www.w3.org/2007/ont/link#"),this.ns.http=bt("http://www.w3.org/2007/ont/http#"),this.ns.httph=bt("http://www.w3.org/2007/ont/httph#"),this.ns.ldp=bt("http://www.w3.org/ns/ldp#"),this.ns.rdf=bt("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),this.ns.rdfs=bt("http://www.w3.org/2000/01/rdf-schema#"),this.ns.rdf=bt("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),this.ns.owl=bt("http://www.w3.org/2002/07/owl#"),this.patchControl=[]}return s()(e,[{key:"patchControlFor",value:function(e){return this.patchControl[e.uri]||(this.patchControl[e.uri]=[]),this.patchControl[e.uri]}},{key:"editable",value:function(e,t){if(!e)return!1;if(t||(t=this.store),"file:///"===(e=e.uri||e).slice(0,8)){if(t.holds(t.sym(e),(void 0)("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),(void 0)("http://www.w3.org/2007/ont/link#MachineEditableDocument")))return"LOCALFILE";var r=t.statementsMatching(t.sym(e));return console.log("UpdateManager.editable: Not MachineEditableDocument file "+e+"\n"),console.log(r.map(function(e){return e.toNT()}).join("\n")),!1}for(var n,i,o=!1,a=t.each(void 0,this.ns.link("requestedURI"),Object(Et.docpart)(e)),s=0;s<a.length;s++)if(void 0!==(n=a[s])){var u=t.any(n,this.ns.link("response"));if(void 0!==n){var c=t.anyValue(u,this.ns.httph("wac-allow"));if(c){var l=!0,h=!1,f=void 0;try{for(var d,p=c.split(",")[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var g=d.value.split("=");if(g[0].includes("user")&&!g[1].includes("write")&&!g[1].includes("append"))return console.log("    editable? excluded by WAC-Allow: ",c),!1}}catch(e){h=!0,f=e}finally{try{l||null==p.return||p.return()}finally{if(h)throw f}}}var y=t.each(u,this.ns.httph("accept-patch"));if(y.length)for(var v=0;v<y.length;v++)if((i=y[v].value.trim()).indexOf("application/sparql-update")>=0)return"SPARQL";var m=t.each(u,this.ns.httph("ms-author-via"));if(m.length)for(var b=0;b<m.length;b++){if((i=m[b].value.trim()).indexOf("SPARQL")>=0)return"SPARQL";if(i.indexOf("DAV")>=0)return"DAV"}var w=t.each(u,this.ns.http("status"));if(w.length)for(var x=0;x<w.length;x++)200!==w[x]&&404!==w[x]||(o=!0)}else console.log("UpdateManager.editable: No response for "+e+"\n")}if(0===a.length)console.log("UpdateManager.editable: No request for "+e+"\n");else if(o)return!1;console.log("UpdateManager.editable: inconclusive for "+e+"\n")}},{key:"anonymize",value:function(e){return"_:"===e.toNT().substr(0,2)&&this.mentioned(e)?"?"+e.toNT().substr(2):e.toNT()}},{key:"anonymizeNT",value:function(e){return this.anonymize(e.subject)+" "+this.anonymize(e.predicate)+" "+this.anonymize(e.object)+" ."}},{key:"statementBnodes",value:function(e){return[e.subject,e.predicate,e.object].filter(function(e){return e.isBlank})}},{key:"statementArrayBnodes",value:function(e){for(var t=[],r=0;r<e.length;r++)t=t.concat(this.statementBnodes(e[r]));t.sort();for(var n=[],i=0;i<t.length;i++)0!==i&&t[i].sameTerm(t[i-1])||n.push(t[i]);return n}},{key:"cacheIfps",value:function(){this.ifps={};for(var e=this.store.each(void 0,this.ns.rdf("type"),this.ns.owl("InverseFunctionalProperty")),t=0;t<e.length;t++)this.ifps[e[t].uri]=!0;this.fps={},e=this.store.each(void 0,this.ns.rdf("type"),this.ns.owl("FunctionalProperty"));for(var r=0;r<e.length;r++)this.fps[e[r].uri]=!0}},{key:"bnodeContext2",value:function(e,t,r){for(var n,i,o=this.store.statementsMatching(void 0,void 0,e,t),a=0;a<o.length;a++)if(this.fps[o[a].predicate.uri]){if(!(n=o[a].subject).isBlank)return[o[a]];if(r&&(i=this.bnodeContext2(n,t,r-1)))return i.concat([o[a]])}o=this.store.statementsMatching(e,void 0,void 0,t);for(var s=0;s<o.length;s++)if(this.ifps[o[s].predicate.uri]){if(!(n=o[s].object).isBlank)return[o[s]];if(r&&(i=this.bnodeContext2(n,t,r-1)))return i.concat([o[s]])}return null}},{key:"bnodeContext1",value:function(e,t){for(var r=0;r<3;r++){var n=this.bnodeContext2(e,t,r);if(null!==n)return n}return this.store.connectedStatements(e,t)}},{key:"mentioned",value:function(e){return 0!==this.store.statementsMatching(e).length||0!==this.store.statementsMatching(void 0,e).length||0!==this.store.statementsMatching(void 0,void 0,e).length}},{key:"bnodeContext",value:function(e,t){var r=[];if(e.length){this.cacheIfps();for(var n=0;n<e.length;n++){var i=e[n];this.mentioned(i)&&(r=r.concat(this.bnodeContext1(i,t)))}}return r}},{key:"statementContext",value:function(e){var t=this.statementBnodes(e);return this.bnodeContext(t,e.why)}},{key:"contextWhere",value:function(e){var t=this;return e&&0!==e.length?"WHERE { "+e.map(function(e){return t.anonymizeNT(e)}).join("\n")+" }\n":""}},{key:"fire",value:function(e,t,r){var n=this;return Promise.resolve().then(function(){if(!e)throw new Error("No URI given for remote editing operation: "+t);console.log("UpdateManager: sending update to <"+e+">");var r={noMeta:!0,contentType:"application/sparql-update",body:t};return n.store.fetcher.webOperation("PATCH",e,r)}).then(function(n){if(!n.ok){var i="UpdateManager: update failed for <"+e+"> status="+n.status+", "+n.statusText+"\n   for query: "+t;throw console.log(i),new Error(i)}console.log("UpdateManager: update Ok for <"+e+">"),r(e,n.ok,n.responseText,n)}).catch(function(t){r(e,!1,t.message,t)})}},{key:"update_statement",value:function(e){if(!e||e.why){var t=this,r=this.statementContext(e);return{statement:e?[e.subject,e.predicate,e.object,e.why]:void 0,statementNT:e?this.anonymizeNT(e):void 0,where:t.contextWhere(r),set_object:function(e,r){var n=this.where;n+="DELETE DATA { "+this.statementNT+" } ;\n",n+="INSERT DATA { "+this.anonymize(this.statement[0])+" "+this.anonymize(this.statement[1])+" "+this.anonymize(e)+"  . }\n",t.fire(this.statement[3].uri,n,r)}}}}},{key:"insert_statement",value:function(e,t){var r=e instanceof Array?e[0]:e,n=this.contextWhere(this.statementContext(r));if(e instanceof Array){for(var i="",o=0;o<e.length;o++)i+=e[o]+"\n";n+="INSERT DATA { "+i+" }\n"}else n+="INSERT DATA { "+this.anonymize(e.subject)+" "+this.anonymize(e.predicate)+" "+this.anonymize(e.object)+"  . }\n";this.fire(r.why.uri,n,t)}},{key:"delete_statement",value:function(e,t){var r=e instanceof Array?e[0]:e,n=this.contextWhere(this.statementContext(r));if(e instanceof Array){for(var i="",o=0;o<e.length;o++)i+=e[o]+"\n";n+="DELETE DATA { "+i+" }\n"}else n+="DELETE DATA { "+this.anonymize(e.subject)+" "+this.anonymize(e.predicate)+" "+this.anonymize(e.object)+"  . }\n";this.fire(r.why.uri,n,t)}},{key:"requestDownstreamAction",value:function(e,t){var r=this.patchControlFor(e);if(r.pendingUpstream)if(r.downstreamAction){if(""+r.downstreamAction!=""+t)throw new Error("Can't wait for > 1 different downstream actions")}else r.downstreamAction=t;else t(e)}},{key:"clearUpstreamCount",value:function(e){this.patchControlFor(e).upstreamCount=0}},{key:"getUpdatesVia",value:function(e){var t=this.store.fetcher.getHeader(e,"updates-via");return t&&t.length?t[0].trim():null}},{key:"addDownstreamChangeListener",value:function(e,t){var r=this,n=this.patchControlFor(e);n.downstreamChangeListeners||(n.downstreamChangeListeners=[]),n.downstreamChangeListeners.push(t),this.setRefreshHandler(e,function(e){r.reloadAndSync(e)})}},{key:"reloadAndSync",value:function(e){var t=this.patchControlFor(e),r=this;if(t.reloading)return console.log("   Already reloading - note this load may be out of date"),void(t.outOfDate=!0);t.reloading=!0;var n=1e3;!function i(){console.log("try reload - timeout = "+n),r.reload(r.store,e,function(r,o,a){if(r){if(t.downstreamChangeListeners)for(var s=0;s<t.downstreamChangeListeners.length;s++)console.log("        Calling downstream listener "+s),t.downstreamChangeListeners[s]();t.reloading=!1,t.outOfDate&&(console.log("   Extra reload because of extra update."),t.outOfDate=!1,i())}else t.reloading=!1,0===a.status?(console.log("Network error refreshing the data. Retrying in "+n/1e3),t.reloading=!0,n*=2,setTimeout(i,n)):console.log("Error "+a.status+"refreshing the data:"+o+". Stopped"+e)})}()}},{key:"setRefreshHandler",value:function(e,t){var r=this.getUpdatesVia(e),n=t,i=this,o=this,a=1500,s=0;if(!r)return console.log("Server doies not support live updates thoughUpdates-Via :-("),!1;r=(r=Object(Et.join)(r,e.uri)).replace(/^http:/,"ws:").replace(/^https:/,"wss:"),console.log("Web socket URI "+r);return function t(){var u;if("undefined"!=typeof WebSocket)u=new WebSocket(r);else if("undefined"!=typeof Services)u=Services.wm.getMostRecentWindow("navigator:browser").WebSocket(r);else{if("undefined"==typeof window||!window.WebSocket)return void console.log("Live update disabled, as WebSocket not supported by platform :-(");u=window.WebSocket(r)}u.onopen=function(){console.log("    websocket open"),a=1500,this.send("sub "+e.uri),s&&(console.log("Web socket has been down, better check for any news."),o.requestDownstreamAction(e,n))};var c=i.patchControlFor(e);c.upstreamCount=0,u.onerror=function(e){console.log("Error on Websocket:",e)},u.onclose=function(e){console.log("*** Websocket closed with code "+e.code+", reason '"+e.reason+"' clean = "+e.clean),a*=2,s+=1,console.log("Retrying in "+a+"ms"),setTimeout(function(){console.log("Trying websocket again"),t()},a)},u.onmessage=function(t){if(t.data&&"pub"===t.data.slice(0,3)){if("upstreamCount"in c&&(c.upstreamCount-=1,c.upstreamCount>=0))return void console.log("just an echo: "+c.upstreamCount);console.log("Assume a real downstream change: "+c.upstreamCount+" -> 0"),c.upstreamCount=0,i.requestDownstreamAction(e,n)}}}(),!0}},{key:"update",value:function(e,t,r,n){var i=this;if(!r){var o=this;return new Promise(function(r,n){o.update(e,t,function(e,t,i){t?r():n(new Error(i))})})}try{var a=this.store,s=e?e instanceof qt?e.statements:e instanceof Array?e:[e]:[],u=t?t instanceof qt?t.statements:t instanceof Array?t:[t]:[];if(!(s instanceof Array))throw new Error("Type Error "+gt()(s)+": "+s);if(!(u instanceof Array))throw new Error("Type Error "+gt()(u)+": "+u);if(0===s.length&&0===u.length)return r(null,!0);var c=s.length?s[0].why:u[0].why;if(!c){var l="Error patching: statement does not specify which document to patch:"+s[0]+", "+u[0];throw console.log(l),new Error(l)}var h=this.patchControlFor(c),f=Date.now(),d=["subject","predicate","object","why"],p={delete:s,insert:u};["insert","delete"].map(function(e){p[e].map(function(e){if(!c.sameTerm(e.why))throw new Error("update: destination "+c+" inconsistent with delete quad "+e.why);d.map(function(t){if(void 0===e[t])throw new Error("update: undefined "+t+" of statement.")})})});var g=this.editable(c.uri,a);if(!1===g)throw new Error("Update: Can't make changes in uneditable "+c);if(void 0===g){if(n)throw new Error("Update: Loaded "+c+"but stil can't figure out what editing protcol it supports.");return console.log("Update: have not loaded ".concat(c," before: loading now...")),void this.store.fetcher.load(c).then(function(n){i.update(e,t,r,!0)},function(e){throw new Error("Update: Can't read ".concat(c," before patching: ").concat(e))})}if(g.indexOf("SPARQL")>=0){var y=[];s.length&&(y=this.statementArrayBnodes(s)),u.length&&(y=y.concat(this.statementArrayBnodes(u)));var v=this.bnodeContext(y,c),m=this.contextWhere(v),b="";if(m.length){if(s.length){b+="DELETE { ";for(var w=0;w<s.length;w++)b+=this.anonymizeNT(s[w])+"\n";b+=" }\n"}if(u.length){b+="INSERT { ";for(var x=0;x<u.length;x++)b+=this.anonymizeNT(u[x])+"\n";b+=" }\n"}b+=m}else{if(s.length){b+="DELETE DATA { ";for(var _=0;_<s.length;_++)b+=this.anonymizeNT(s[_])+"\n";b+=" } \n"}if(u.length){s.length&&(b+=" ; "),b+="INSERT DATA { ";for(var T=0;T<u.length;T++)b+=this.anonymizeNT(u[T])+"\n";b+=" }\n"}}h.pendingUpstream=h.pendingUpstream?h.pendingUpstream+1:1,"upstreamCount"in h&&(h.upstreamCount+=1,console.log("upstream count up to : "+h.upstreamCount)),this.fire(c.uri,b,function(e,t,n,i){if(i.elapsedTimeMs=Date.now()-f,console.log("    UpdateManager: Return "+(t?"success ":"FAILURE ")+i.status+" elapsed "+i.elapsedTimeMs+"ms"),t){try{a.remove(s)}catch(e){t=!1,n="Remote Ok BUT error deleting "+s.length+" from store!!! "+e}for(var o=0;o<u.length;o++)a.add(u[o].subject,u[o].predicate,u[o].object,c)}if(r(e,t,n,i),h.pendingUpstream-=1,0===h.pendingUpstream&&h.downstreamAction){var l=h.downstreamAction;delete h.downstreamAction,console.log("delayed downstream action:"),l(c)}})}else if(g.indexOf("DAV")>=0)this.updateDav(c,s,u,r);else{if(!(g.indexOf("LOCALFILE")>=0))throw new Error("Unhandled edit method: '"+g+"' for "+c);try{this.updateLocalFile(c,s,u,r)}catch(e){r(c.uri,!1,"Exception trying to write back file <"+c.uri+">\n")}}}catch(e){r(void 0,!1,"Exception in update: "+e+"\n"+Nt.stackString(e))}}},{key:"updateDav",value:function(e,t,r,n){var i=this.store,o=i.any(e,this.ns.link("request"));if(!o)throw new Error("No record of our HTTP GET request for document: "+e);var a=i.any(o,this.ns.link("response"));if(!a)return null;for(var s=i.the(a,this.ns.httph("content-type")).value,u=i.statementsMatching(void 0,void 0,void 0,e).slice(),c=0;c<t.length;c++)Nt.RDFArrayRemove(u,t[c]);for(var l=0;l<r.length;l++)u.push(r[l]);var h,f=this.serialize(e.uri,u,s),d=i.the(a,this.ns.httph("content-location"));d&&(h=Object(Et.join)(d.value,h));var p={contentType:s,noMeta:!0,body:f};return i.fetcher.webOperation("PUT",h,p).then(function(o){if(!o.ok)throw new Error(o.error);for(var a=0;a<t.length;a++)i.remove(t[a]);for(var s=0;s<r.length;s++)i.add(r[s].subject,r[s].predicate,r[s].object,e);n(e.uri,o.ok,o.responseText,o)}).catch(function(t){n(e.uri,!1,t.message,t)})}},{key:"updateLocalFile",value:function(e,t,r,n){var i=this.store;console.log("Writing back to local file\n");for(var o=i.statementsMatching(void 0,void 0,void 0,e).slice(),a=0;a<t.length;a++)Nt.RDFArrayRemove(o,t[a]);for(var s=0;s<r.length;s++)o.push(r[s]);var u=e.uri.lastIndexOf(".");if(u<1)throw new Error("Rewriting file: No filename extension: "+e.uri);var c=e.uri.slice(u+1),l=cr.CONTENT_TYPE_BY_EXT[c];if(!l)throw new Error("File extension ."+c+" not supported for data write");var h=this.serialize(e.uri,o,l);console.log("Writing back: <<<"+h+">>>");var f=e.uri.slice(7),d=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);if(d.initWithPath(f),!d.exists())throw new Error("Rewriting file <"+e.uri+"> but it does not exist!");var p=Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);p.init(d,42,parseInt("0666",8),0),p.write(h,h.length),p.close();for(var g=0;g<t.length;g++)i.remove(t[g]);for(var y=0;y<r.length;y++)i.add(r[y].subject,r[y].predicate,r[y].object,e);n(e.uri,!0,"")}},{key:"serialize",value:function(e,t,r){var n,i=this.store;if("string"==typeof t)return t;var o=Ot(i);switch(o.suggestNamespaces(i.namespaces),o.setBase(e),r){case"text/xml":case"application/rdf+xml":n=o.statementsToXML(t);break;case"text/n3":case"text/turtle":case"application/x-turtle":case"application/n3":n=o.statementsToN3(t);break;default:throw new Error("Content-type "+r+" not supported for data serialization")}return n}},{key:"put",value:function(e,t,r,n){var i,o=this,a=this.store;return Promise.resolve().then(function(){return i=o.serialize(e.uri,t,r),a.fetcher.webOperation("PUT",e.uri,{contentType:r,body:i})}).then(function(r){if(!r.ok)return n(e.uri,r.ok,r.error,r);delete a.fetcher.nonexistent[e.uri],delete a.fetcher.requested[e.uri],"string"!=typeof t&&t.map(function(e){a.addStatement(e)}),n(e.uri,r.ok,"",r)}).catch(function(t){n(e.uri,!1,t.message)})}},{key:"reload",value:function(e,t,r){var n=Date.now();e.fetcher.nowOrWhenFetched(t.uri,{force:!0,noMeta:!0,clearPreviousData:!0},function(e,i,o){if(e)if(o.onErrorWasCalled||200!==o.status)console.log("    Non-HTTP error reloading data! onErrorWasCalled="+o.onErrorWasCalled+" status: "+o.status),r(!1,"Non-HTTP error reloading data: "+i,o);else{var a=Date.now()-n;t.reloadTimeTotal||(t.reloadTimeTotal=0),t.reloadTimeCount||(t.reloadTimeCount=0),t.reloadTimeTotal+=a,t.reloadTimeCount+=1,console.log("    Fetch took "+a+"ms, av. of "+t.reloadTimeCount+" = "+t.reloadTimeTotal/t.reloadTimeCount+"ms."),r(!0)}else console.log("    ERROR reloading data: "+i),r(!1,"Error reloading data: "+i,o)})}}]),e}(),mr=function(){function e(t,r){o()(this,e),this.parent=t,this.via=r,this.connected=!1,this.pending={},this.subscribed={},this.socket={};try{this.socket=new WebSocket(r),this.socket.onopen=this.onOpen,this.socket.onclose=this.onClose,this.socket.onmessage=this.onMessage,this.socket.onerror=this.onError}catch(e){this.onError(e)}}return s()(e,[{key:"_decode",value:function(e){var t,r,n,i,o,a,s;for(r in i={},o=function(){var r,n,i,o;for(o=[],r=0,n=(i=e.split("&")).length;r<n;r++)t=i[r],o.push(t.split("="));return o}())t=o[r],s=(a=[decodeURIComponent(t[0]),decodeURIComponent(t[1])])[1],null==i[n=a[0]]&&(i[n]=[]),i[n].push(s);return i}},{key:"_send",value:function(e,t,r){var n,i;return i=[e,t,r].join(" "),"function"==typeof(n=this.socket).send?n.send(i):void 0}},{key:"_subscribe",value:function(e){return this._send("sub",e,""),this.subscribed[e]=!0,this.subscribed[e]}},{key:"onClose",value:function(e){var t;for(t in this.connected=!1,this.subscribed)this.pending[t]=!0;return this.subscribed={},this.subscribed}},{key:"onError",value:function(e){throw new Error("onError"+e)}},{key:"onMessage",value:function(e){var t,r;return"ping"===(r=e.data.split(" "))[0]?"function"==typeof(t=this.socket).send?t.send("pong "+r.slice(1).join(" ")):void 0:"pub"===r[0]?this.parent.onUpdate(r[1],this._decode(r[2])):void 0}},{key:"onOpen",value:function(e){var t,r;for(r in this.connected=!0,t=[],this.pending)delete this.pending[r],t.push(this._subscribe(r));return t}},{key:"subscribe",value:function(e){return this.connected?this._subscribe(e):(this.pending[e]=!0,this.pending[e])}}]),e}(),br=function(){function e(t){o()(this,e),this.fetcher=t,this.graph={},this.via={},this.fetcher.addCallback("headers",this.onHeaders)}return s()(e,[{key:"onHeaders",value:function(e){var t,r,n;return null==e.headers||("undefined"==typeof WebSocket||null===WebSocket||(t=e.headers.etag,n=e.headers["updates-via"],r=e.uri,t&&n&&(this.graph[r]={etag:t,via:n},this.register(n,r)),!0))}},{key:"onUpdate",value:function(e,t){return this.fetcher.refresh((void 0)(e))}},{key:"register",value:function(e,t){return null==this.via[e]&&(this.via[e]=new mr(this,e)),this.via[e].subscribe(t)}}]),e}();r.d(t,"term",function(){return Ar}),r.d(t,"NextId",function(){return wr}),r.d(t,"fromNT",function(){return xr}),r.d(t,"fetcher",function(){return _r}),r.d(t,"graph",function(){return Tr}),r.d(t,"lit",function(){return kr}),r.d(t,"st",function(){return Sr}),r.d(t,"sym",function(){return Ir}),r.d(t,"blankNode",function(){return jr}),r.d(t,"defaultGraph",function(){return Er}),r.d(t,"literal",function(){return Or}),r.d(t,"namedNode",function(){return Ir}),r.d(t,"quad",function(){return Cr}),r.d(t,"triple",function(){return Rr}),r.d(t,"variable",function(){return Nr}),r.d(t,"BlankNode",function(){return y}),r.d(t,"Collection",function(){return v}),r.d(t,"convert",function(){return n}),r.d(t,"DataFactory",function(){return lr}),r.d(t,"Empty",function(){return dr}),r.d(t,"Fetcher",function(){return cr}),r.d(t,"Formula",function(){return Lt}),r.d(t,"Store",function(){return qt}),r.d(t,"jsonParser",function(){return pr}),r.d(t,"Literal",function(){return mt}),r.d(t,"log",function(){return jt.a}),r.d(t,"N3Parser",function(){return zt}),r.d(t,"NamedNode",function(){return yt.a}),r.d(t,"Namespace",function(){return bt}),r.d(t,"Node",function(){return wt}),r.d(t,"parse",function(){return Jt}),r.d(t,"Query",function(){return Dt}),r.d(t,"queryToSPARQL",function(){return gr}),r.d(t,"RDFaProcessor",function(){return Vt}),r.d(t,"RDFParser",function(){return Wt}),r.d(t,"serialize",function(){return Ct}),r.d(t,"Serializer",function(){return Ot}),r.d(t,"SPARQLToQuery",function(){return yr}),r.d(t,"sparqlUpdateParser",function(){return Gt}),r.d(t,"Statement",function(){return Rt}),r.d(t,"UpdateManager",function(){return vr}),r.d(t,"UpdatesSocket",function(){return mr}),r.d(t,"UpdatesVia",function(){return br}),r.d(t,"uri",function(){return Et}),r.d(t,"Util",function(){return Nt}),r.d(t,"Variable",function(){return At}),r.d(t,"IndexedFormula",function(){return qt});var wr=y.nextId,xr=Lt.prototype.fromNT,_r=lr.fetcher,Tr=lr.graph,kr=lr.lit,Sr=lr.st,Ir=lr.namedNode,Nr=lr.variable,jr=lr.blankNode,Er=lr.defaultGraph,Or=lr.literal,Cr=lr.quad,Rr=lr.triple,Ar=wt.fromValue}])});
//# sourceMappingURL=rdflib.min.js.map