<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: serialize.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: serialize.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import * as convert from './convert'
import Serializer from './serializer'

/**
 * Serialize to the appropriate format
 * @@ Currently NQuads and JSON/LD are deal with extrelemently inefficiently
 * through mutiple conversions.
 */
export default function serialize (target, kb, base, contentType, callback, options) {
  base = base || target.uri
  options = options || {}
  contentType = contentType || 'text/turtle' // text/n3 if complex?
  var documentString = null
  try {
    var sz = Serializer(kb)
    if (options.flags) sz.setFlags(options.flags)
    var newSts = kb.statementsMatching(undefined, undefined, undefined, target)
    var n3String
    sz.suggestNamespaces(kb.namespaces)
    sz.setBase(base)
    switch (contentType) {
      case 'application/rdf+xml':
        documentString = sz.statementsToXML(newSts)
        return executeCallback(null, documentString)
      case 'text/n3':
      case 'application/n3': // Legacy
        documentString = sz.statementsToN3(newSts)
        return executeCallback(null, documentString)
      case 'text/turtle':
      case 'application/x-turtle': // Legacy
        sz.setFlags('si') // Suppress = for sameAs and => for implies
        documentString = sz.statementsToN3(newSts)
        return executeCallback(null, documentString)
      case 'application/n-triples':
        sz.setFlags('deinprstux') // Suppress nice parts of N3 to make ntriples
        documentString = sz.statementsToNTriples(newSts)
        return executeCallback(null, documentString)
      case 'application/ld+json':
        sz.setFlags('deinprstux') // Use adapters to connect to incmpatible parser
        n3String = sz.statementsToNTriples(newSts)
        // n3String = sz.statementsToN3(newSts)
        convert.convertToJson(n3String, callback)
        break
      case 'application/n-quads':
      case 'application/nquads': // @@@ just outpout the quads? Does not work for collections
        sz.setFlags('deinprstux q') // Suppress nice parts of N3 to make ntriples
        documentString = sz.statementsToNTriples(newSts) // q in flag means actually quads
        return executeCallback(null, documentString)
        // n3String = sz.statementsToN3(newSts)
        // documentString = convert.convertToNQuads(n3String, callback)
        break
      default:
        throw new Error('Serialize: Content-type ' + contentType + ' not supported for data write.')
    }
  } catch (err) {
    if (callback) {
      return callback(err)
    }
    throw err // Don't hide problems from caller in sync mode
  }

  function executeCallback (err, result) {
    if (callback) {
      callback(err, result)
      return
    } else {
      return result
    }
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-formula.html">formula</a></li><li><a href="module-log.html">log</a></li><li><a href="module-store.html">store</a></li><li><a href="module-util.html">util</a></li></ul><h3>Classes</h3><ul><li><a href="module.html#.exports">exports</a></li><li><a href="module.exports_module.exports.html">exports</a></li><li><a href="module-formula.html">formula</a></li><li><a href="module-store.html">store</a></li><li><a href="NamedNode.html">NamedNode</a></li><li><a href="Node.html">Node</a></li><li><a href="Query.html">Query</a></li><li><a href="Variable.html">Variable</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addArc">addArc</a></li><li><a href="global.html#addBNode">addBNode</a></li><li><a href="global.html#addCollection">addCollection</a></li><li><a href="global.html#addCollectionArc">addCollectionArc</a></li><li><a href="global.html#addLiteral">addLiteral</a></li><li><a href="global.html#addNode">addNode</a></li><li><a href="global.html#addStatus">addStatus</a></li><li><a href="global.html#addSymbol">addSymbol</a></li><li><a href="global.html#bnodes">bnodes</a></li><li><a href="global.html#clearUpstreamCount">clearUpstreamCount</a></li><li><a href="global.html#createContainer">createContainer</a></li><li><a href="global.html#createIfNotExists">createIfNotExists</a></li><li><a href="global.html#delete">delete</a></li><li><a href="global.html#dir">dir</a></li><li><a href="global.html#editable">editable</a></li><li><a href="global.html#failFetch">failFetch</a></li><li><a href="global.html#fetchUri">fetchUri</a></li><li><a href="global.html">fromBoolean</a></li><li><a href="global.html">fromDate</a></li><li><a href="global.html">fromNumber</a></li><li><a href="global.html#fromValue">fromValue</a></li><li><a href="global.html#getHeader">getHeader</a></li><li><a href="global.html#guessContentType">guessContentType</a></li><li><a href="global.html#handleError">handleError</a></li><li><a href="global.html#handleResponse">handleResponse</a></li><li><a href="global.html#handlerForContentType">handlerForContentType</a></li><li><a href="global.html#indexedFormulaQuery">indexedFormulaQuery</a></li><li><a href="global.html#initFetchOptions">initFetchOptions</a></li><li><a href="global.html#isCrossSite">isCrossSite</a></li><li><a href="global.html#isTripleToLoad">isTripleToLoad</a></li><li><a href="global.html#load">load</a></li><li><a href="global.html#loadTriple">loadTriple</a></li><li><a href="global.html#lookUpThing">lookUpThing</a></li><li><a href="global.html#normalizedContentType">normalizedContentType</a></li><li><a href="global.html#nowKnownAs">nowKnownAs</a></li><li><a href="global.html#nowOrWhenFetched">nowOrWhenFetched</a></li><li><a href="global.html#offlineOverride">offlineOverride</a></li><li><a href="global.html#parse">parse</a></li><li><a href="global.html#pendingFetchPromise">pendingFetchPromise</a></li><li><a href="global.html#put">put</a></li><li><a href="global.html#putBack">putBack</a></li><li><a href="global.html#RDFParser">RDFParser</a></li><li><a href="global.html#redirectToProxy">redirectToProxy</a></li><li><a href="global.html#reify">reify</a></li><li><a href="global.html#reload">reload</a></li><li><a href="global.html#requestDownstreamAction">requestDownstreamAction</a></li><li><a href="global.html#saveRequestMetadata">saveRequestMetadata</a></li><li><a href="global.html#serialize">serialize</a></li><li><a href="global.html#setCredentials">setCredentials</a></li><li><a href="global.html#setRefreshHandler">setRefreshHandler</a></li><li><a href="global.html#site">site</a></li><li><a href="global.html#store">store</a></li><li><a href="global.html#terminateFrame">terminateFrame</a></li><li><a href="global.html#unsupportedProtocol">unsupportedProtocol</a></li><li><a href="global.html#update">update</a></li><li><a href="global.html#update_statement">update_statement</a></li><li><a href="global.html#updateLocalFile">updateLocalFile</a></li><li><a href="global.html#uri">uri</a></li><li><a href="global.html#webOperation">webOperation</a></li><li><a href="global.html#why">why</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Tue Aug 27 2019 09:57:43 GMT+0000 (UTC)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
